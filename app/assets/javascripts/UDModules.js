var AcceptEventAction=function(a){a=a||{};AcceptEventAction.baseConstructor.call(this,a)};JSFun.extend(AcceptEventAction,Rectangular);AcceptEventAction.prototype.getLinkCentered=function(l,h){if(this._selectedFigure){return AcceptEventAction.base.getLinkCentered.call(this,l,h)}if(l instanceof Point){h=l.getY();l=l.getX()}var g=this.getCentralPoint();var d=g.getX();var c=g.getY();var a,n,f,e;a=this.getX();n=this.getY();f=g.getX();e=this.getY();if(l<d){if(h<c){var b;b=(this.getY()-c)/(this.getX()-d);if(((h-c)==0)||Math.abs((h-c)/(l-d))<Math.abs(b)){f=this.getX()+25;e=this.getY()+this.getHeight()/2}else{f=this.getX()+this.getWidth();e=this.getY()}}else{var b;b=(this.getY()+this.getHeight()-c)/(this.getX()-d);if(((h-c)==0)||Math.abs((h-c)/(l-d))<Math.abs(b)){a=this.getX()+25;n=this.getY()+this.getHeight()/2;f=this.getX();e=this.getY()+this.getHeight()}else{n=this.getY()+this.getHeight();f=this.getX()+this.getWidth();e=this.getY()+this.getHeight()}}}else{if(h<c){var b;b=(this.getY()-c)/(this.getX()+this.getWidth()-d);if(((h-c)==0)||((h-c)/(l-d))<b){f=this.getX()+this.getWidth();e=this.getY()}else{a=this.getX()+this.getWidth();f=this.getX()+this.getWidth();e=this.getY()+this.getHeight()}}else{var b;b=(this.getY()+this.getHeight()-c)/(this.getX()+this.getWidth()-d);if(((h-c)==0)||((h-c)/(l-d))<b){a=this.getX()+this.getWidth();f=this.getX()+this.getWidth();e=this.getY()+this.getHeight()}else{n=this.getY()+this.getHeight();f=this.getX()+this.getWidth();e=this.getY()+this.getHeight()}}}return JSGraphic.lineIntersection(a,n,f,e,l,h,g.getX(),g.getY())};AcceptEventAction.prototype.calculateSize=function(){if(this._selectedFigure){AcceptEventAction.base.calculateSize.call(this);return}if(this._components.length>0){var a;var d=0;var c=0;var b;for(b in this._components){a=this._components[b];if(a.getPosition()==Component.Float||a.getPosition()==Component.BottomLeft||a.getPosition()==Component.BottomRight){c+=a.getHeight();if(a.getWidth()>d){d=a.getWidth()}}}if(this._container){if(c>this._minHeight){this.setMinHeight(c)}if(d>this._minWidth){this.setMinWidth(d+25)}}else{if(c>0){this.setMinHeight(c)}if(d>0){this.setMinWidth(d+25)}}}};AcceptEventAction.prototype.updateComponents=function(){if(this._components.length>0){this.calculateSize();this.insertComponents(this._x+25,this._y,this._width-25,this._height);var a;for(a in this._relations){this._relations[a].notifyChange()}}};AcceptEventAction.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};AcceptEventAction.prototype.setName=function(a){this._components[1].setValue(a)};AcceptEventAction.prototype.getStereotypes=function(){var c=this._components[0]._childs;var a=[];for(var b=0;b<c.length;b++){a.push(c[b]._text)}return a};AcceptEventAction.prototype.getName=function(){return this._components[1].getValue()};AcceptEventAction.prototype.getStereotype=function(){return this._components[0]};var ActivityDiagram=function(a){ActivityDiagram.baseConstructor.call(this,a)};JSFun.extend(ActivityDiagram,Diagram);ActivityDiagram.prototype._instantiateElements=function(d,c,b){b=b||null;var e=this._instantiateObjectFromString(d.nodeName,b);if(e){c[d.getAttribute("id")]=e;var a;for(a=0;a<d.childNodes.length;a++){if(e instanceof SuperNode&&d.childNodes[a].nodeName=="Swimlane"){this._instantiateElements(d.childNodes[a],c,e)}else{this._instantiateElements(d.childNodes[a],c)}}}};ActivityDiagram.prototype._instantiateObjectFromString=function(elemName,parent){if(JSFun.isString(elemName)){parent=parent||null;var i;for(i in this._validElements){if(elemName==this._validElements[i]){if(elemName=="UMLHorizontalHierarchicalSwimlane"||elemName=="UMLVerticalHierarchicalSwimlane"||elemName=="UMLHorizontalSwimlane"||elemName=="UMLVerticalSwimlane"||elemName=="UMLFlow"){var setElementXml=true;return eval("new "+this._validElements[i]+"({ setElementXml: "+setElementXml+"})")}else{if(parent){return(new window[this._validElements[i]]({addComponent:false,parent:parent}))}else{return eval("new "+this._validElements[i]+"()")}}}}}else{return null}};ActivityDiagram.prototype.setXML=function(b,f){var f=f||[];var e=[];if(this._alone){var a=b.getElementsByTagName(this.getType())[0];if(!a){return false}}else{var a=b}this._name.setValue(a.getAttribute("name"));if(a.getAttribute("backgroundNodes")){this._backgroundNodes=a.getAttribute("backgroundNodes")}this._stereotypes=f;var d=a.childNodes;var c;for(c=0;c<d.length;c++){this._instantiateElements(d[c],e)}for(c=0;c<d.length;c++){this._addElementXML(d[c],e,null)}for(c=0;c<this._relations.length;c++){this._relations[c].notifyChange()}this._sortNodesByArea();return true};var ConnectorActivity=function(a){a=a||{};ConnectorActivity.baseConstructor.call(this,a)};JSFun.extend(ConnectorActivity,Elliptical);ConnectorActivity.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};ConnectorActivity.prototype.setName=function(a){this._components[1].setValue(a)};ConnectorActivity.prototype.getStereotypes=function(){return this._components[0]._childs};ConnectorActivity.prototype.getName=function(){return this._components[1].getValue()};ConnectorActivity.prototype.getStereotype=function(){return this._components[0]};var DataStore=function(a){a=a||{};DataStore.baseConstructor.call(this,a)};JSFun.extend(DataStore,Rectangular);DataStore.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};DataStore.prototype.setName=function(a){this._components[2].setValue(a)};DataStore.prototype.getStereotypes=function(){return this._components[0]._childs};DataStore.prototype.getName=function(){return this._components[2].getValue()};DataStore.prototype.getStereotype=function(){return this._components[0]};var Decision_MergeNode=function(a){a=a||{};Decision_MergeNode.baseConstructor.call(this,a)};JSFun.extend(Decision_MergeNode,Rhombus);Decision_MergeNode.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Decision_MergeNode.prototype.setName=function(a){this._components[1].setValue(a)};Decision_MergeNode.prototype.getStereotypes=function(){return this._components[0]._childs};Decision_MergeNode.prototype.getName=function(){return this._components[1].getValue()};Decision_MergeNode.prototype.getStereotype=function(){return this._components[0]};var ExceptionHandler=function(a){a=a||{};this._y=a.y||0;this._limitY=0;this._objA=null;this._objB=null;ExceptionHandler.baseConstructor.call(this,a)};JSFun.extend(ExceptionHandler,Relation);ExceptionHandler.prototype.select=function(a,c){this._deselectComponent();for(b=0;b<this._points.length;b++){if(Math.abs(a-this._points[b].getX())<=4&&Math.abs(c-this._points[b].getY())<=4){if(this._selected>-1){this._selectedBefore=true}this._selected=b;this._selectedPoint=true;return true}}if(this._selected>-1){if(this._isOverComponent(a,c)){this._selectedBefore=true;return true}}for(var b=0;b<this._points.length-1;b++){if(this._selectLine(this._points[b],this._points[b+1],a,c)){if(this._selected>-1){this._selectedBefore=true}this._selected=b;this._selectedLine=true;this._points.splice(this._selected+1,0,new Point(a,c));return true}}return false};ExceptionHandler.prototype.draw=function(b){ExceptionHandler.base.draw.call(this,b);b.save();b.strokeStyle="#000000";b.lineWidth=2;var h=this._points.length;var c=parseInt(h/2)-1;var a=this._points[c].getX();var o=this._points[c].getY();var n=this._points[c+1].getX();var l=this._points[c+1].getY();if(h%2!=0){var g=n;var e=l}else{var g=(a+n)/2;var e=(this._components.length)?this._components[0]._y-30:((o+l)/2-30)}var m=this._elemA.getCentralPoint();var f=m._x;var d=m._y;if(n<f){if(l<d){if(Math.abs(n-f)>Math.abs(l-d)){}else{var g=(this._components.length)?this._components[0]._x+30:((a+n)/2+30);var e=(o+l)/2}}else{if(Math.abs(n-f)>Math.abs(l-d)){}else{var g=(this._components.length)?this._components[0]._x+30:((a+n)/2+30);var e=(o+l)/2}}}else{if(l<d){if(Math.abs(n-f)<Math.abs(l-d)){var g=(this._components.length)?this._components[0]._x+30:((a+n)/2+30);var e=(o+l)/2}else{}}else{if(Math.abs(n-f)>Math.abs(l-d)){}else{var g=(this._components.length)?this._components[0]._x+30:((a+n)/2+30);var e=(o+l)/2}}}b.beginPath();b.moveTo(g-15,e);b.lineTo(g+15,e);b.lineTo(g-15,e+20);b.lineTo(g+15,e+20);b.stroke();b.restore()};ExceptionHandler.prototype.setName=function(a){this._components[1].setValue(a)};ExceptionHandler.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};ExceptionHandler.prototype.getName=function(){return this._components[1].getValue()};ExceptionHandler.prototype.getStereotypes=function(){return this._components[0]._childs};var Pin=function(a){a=a||{};Pin.baseConstructor.call(this,a);this.setAlone();this.setWidth(7);this.setHeight(14)};JSFun.extend(Pin,Rectangular);Pin.prototype.setAction=function(a){if(a instanceof Node){this._action=a}};Pin.prototype.drop=function(a,b){this.correctPosition();Pin.base.drop.call(this,a,b)};Pin.prototype.correctPosition=function(){if(!this._action){return}var c=this._action.getX();var l=this._action.getY();var d=this._action.getWidth();var e=this._action.getHeight();if(this.getHeight()>this.getWidth()){var f=this._action.getLinkCentered(this.getX()+this._width,this.getY()+this._height/2)}else{var f=this._action.getLinkCentered(this.getX()+this._width/2,this.getY()+this._height)}var b=f.getX();var g=f.getY();if(this.getHeight()>this.getWidth()){if((this._action.getY()==g)||((this._action.getY()+this._action.getHeight())==g)){var a=this.getHeight();this.setHeight(this.getWidth());this.setWidth(a)}}else{if(this.getWidth()>this.getHeight()){if((this._action.getX()==b)||((this._action.getX()+this._action.getWidth())==b)){var a=this.getHeight();this.setHeight(this.getWidth());this.setWidth(a)}}}if(this._action.getX()==b){this.setPosition(b-this._width,g-this._height/2)}else{if(this._action.getY()==g){this.setPosition(b-this._width/2,g-this._height)}else{if((this._action.getX()+this._action.getWidth())==b){this.setPosition(b,g-this._height/2)}else{if((this._action.getY()+this._action.getHeight())==g){this.setPosition(b-this._width/2,g)}}}}this.updatePositionComponents(b,g)};Pin.prototype.updatePositionComponents=function(b,d){var a=-1;if(b==this._action.getX()){a=Component.Left}else{if(b==this._action.getX()+this._action.getWidth()){a=Component.Right}else{if(d==this._action.getY()){a=Component.Top}else{if(d==this._action.getY()+this._action.getHeight()){a=Component.Bottom}}}}for(var c=0;c<this._components.length;c++){this._components[c]._setPosition(a)}this.updateComponents();this.resetMovement()};Pin.prototype.notifyChange=function(){this.updatePosition();this.correctPosition();if(this._container){this.updateContainer()}else{this.updateComponents()}};Pin.prototype.deleted=function(){Pin.base.deleted.call(this);if(this._parent){this._parent.notifyDeleted(this)}else{this._action.notifyDeleted(this)}};Pin.prototype.updatePosition=function(d,b,f){var c,a;f=f||false;if(d==undefined||b==undefined){var e=this.getMovement();var d=e.getX();var b=e.getY();for(c in this._relations){this._relations[c].updatePosition()}}else{this._x+=d;this._y+=b}this.resetMovement();for(c in this._components){this._components[c].updatePosition(d,b)}for(c in this._relations){if((this._relations[c].getParent()!==this._parent)||f){this._relations[c].notifyChange()}}if(this._container){for(c in this._nodeChilds){this._nodeChilds[c].updatePosition(d,b)}for(c in this._relationChilds){this._relationChilds[c].updatePosition(d,b)}}};Pin.prototype.calculateSize=function(){if(this._components.length>0){var a;var d=0;var c=0;var f;var e=false;var b;for(b in this._components){a=this._components[b];if(a._visible&&!(a instanceof RegionLine)&&(a.getPosition()==Component.Float||(a.getPosition()==Component.BottomLeft&&a._visible)||a.getPosition()==Component.BottomRight||a.getPosition()==Component.Xmovement)){if(a._orientation){d+=a.getWidth();if(a.getHeight()>c){c=a.getHeight()}}else{c+=a.getHeight();f=(a.getPosition()==Component.Xmovement)?(a.getWidth()+2*a._parent._Xmovement):a.getWidth();if(f>d){d=f}}}else{if(!a._visible){e=true}}}if(c==0&&e==true){c=7}if(d==0&&e==true){d=7}if(this._container&&!this._selectedFigure){if(c>this._minHeight){this.setMinHeight(c)}if(d>this._minWidth){this.setMinWidth(d)}}else{if(c>0){this.setMinHeight(c)}if(d>0){this.setMinWidth(d)}}}};Pin.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Pin.prototype.setName=function(a){this._components[1].setValue(a)};Pin.prototype.getStereotypes=function(){return this._components[0]._childs};Pin.prototype.getName=function(){return this._components[1].getValue()};Pin.prototype.getStereotype=function(){return this._components[0]};var ExpansionNode=function(a){a=a||{};ExpansionNode.baseConstructor.call(this,a);this.setWidth(7);this.setHeight(18)};JSFun.extend(ExpansionNode,Pin);ExpansionNode.prototype.correctPosition=function(){if(!this._action){return}var c=this._action.getX();var l=this._action.getY();var d=this._action.getWidth();var e=this._action.getHeight();if(this.getHeight()>this.getWidth()){var f=this._action.getLinkCentered(this.getX()+this._width,this.getY()+this._height/2)}else{var f=this._action.getLinkCentered(this.getX()+this._width/2,this.getY()+this._height)}var b=f.getX();var g=f.getY();if(this.getHeight()>this.getWidth()){if((this._action.getY()==g)||((this._action.getY()+this._action.getHeight())==g)){var a=this.getHeight();this.setHeight(this.getWidth());this.setWidth(a)}}else{if(this.getWidth()>this.getHeight()){if((this._action.getX()==b)||((this._action.getX()+this._action.getWidth())==b)){var a=this.getHeight();this.setHeight(this.getWidth());this.setWidth(a)}}}if(this._action.getX()==b){this.setPosition(b-this._width,g-this._height/2)}else{if(this._action.getY()==g){this.setPosition(b-this._width/2,g-this._height)}else{if((this._action.getX()+this._action.getWidth())==b){this.setPosition(b,g-this._height/2)}else{if((this._action.getY()+this._action.getHeight())==g){this.setPosition(b-this._width/2,g)}}}}this.updatePositionComponents(b,g)};ExpansionNode.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};ExpansionNode.prototype.setName=function(a){this._components[1].setValue(a)};ExpansionNode.prototype.getStereotypes=function(){return this._components[0]._childs};ExpansionNode.prototype.getName=function(){return this._components[1].getValue()};ExpansionNode.prototype.getStereotype=function(){return this._components[0]};var Flow=function(a){a=a||{};this._y=a.y||-1;this._x=a.x||-1;Flow.baseConstructor.call(this,a);if(a.setElementXml){}else{this._addComponents()}};JSFun.extend(Flow,Relation);Flow.prototype.setElementXML=function(g,e){var c=g.getAttribute("side_A");var a=g.getAttribute("side_B");this.setElements(e[c],e[a]);this._y=parseInt(g.getAttribute("y"));this._x=parseInt(g.getAttribute("x"));var d;var f=g.childNodes;var h=0;for(d=0;d<f.length;d++){if(f[d].nodeName=="point"){this._points[h]=new Point(parseInt(f[d].getAttribute("x")),parseInt(f[d].getAttribute("y")));h++}}this._addComponents();for(d=0;d<f.length;d++){if(f[d].nodeName=="item"){this.setValue(f[d].getAttribute("id"),f[d].getAttribute("value"))}else{if(f[d].nodeName=="superitem"){var b;for(b in this._components){if(this._components[b].getId()==f[d].getAttribute("id")){this._components[b].setComponentXML(f[d])}}}}}this._updateComponents()};Flow.prototype._addComponents=function(){this.addComponentStereotype();this.setComponentName("")};Flow.prototype.setComponentName=function(a){if(!this._name){if(this._elemA.getType()=="UMLDecision_MergeNode"){this._name=new GuardItem({id:"description",text:"[]"})}else{this._name=new TextArea({id:"name_node",text:""})}this._addComponent(this._name)}else{this._name.setText(a)}};Flow.prototype.updateName=function(){if(!this._name){return}if(this._elemA.getType()!="UMLDecision_MergeNode"&&this._name instanceof GuardItem){var a=this._name._text.join("\n");a=a.substring(1,a.length-1);this._delComponent(this._name);this._name=new TextArea({id:"name_node",text:a});this._addComponent(this._name)}else{if(this._elemA.getType()=="UMLDecision_MergeNode"&&!(this._name instanceof GuardItem)){var a="["+this._name._text.join("\n")+"]";this._delComponent(this._name);this._name=new GuardItem({id:"description",text:a});this._addComponent(this._name)}}};Flow.prototype._calculateLineEnds=function(){if(this._elemA.getType()=="UMLFork_JoinNode"||this._elemB.getType()=="UMLFork_JoinNode"){var b=this._elemA.getCentralPoint();var a=this._elemB.getCentralPoint();var d=this._points.length;var c=false;if(!this._selectedPoint&&this._elemA&&this._elemB){if(d>2){if(this._elemA.getType()=="UMLFork_JoinNode"){if(this._x!=-1){this._points[0].setPoint(this._elemA.getLink(this._points[1]._x,this._points[1]._y,this._elemA._x+this._x,b._y))}else{this._points[0].setPoint(this._elemA.getLink(this._points[1]._x,this._points[1]._y,b._x,this._elemA._y+this._y))}this._elemA.updateLimitSize()}else{this._points[0]=this._elemA.getLinkCentered(this._points[1])}if(this._elemB.getType()=="UMLFork_JoinNode"){if(this._x!=-1){this._points[d-1].setPoint(this._elemB.getLink(this._points[d-2]._x,this._points[d-2]._y,this._elemB._x+this._x,a._y))}else{this._points[d-1].setPoint(this._elemB.getLink(this._points[d-2]._x,this._points[d-2]._y,a._x,this._elemB._y+this._y))}this._elemB.updateLimitSize()}else{this._points[d-1]=this._elemB.getLinkCentered(this._points[d-2])}}else{if(this._elemA.getType()=="UMLFork_JoinNode"){if(this._x!=-1){this._points[0].setPoint(this._elemA.getLink(a._x,a._y,this._elemA._x+this._x,b._y))}else{this._points[0].setPoint(this._elemA.getLink(a._x,a._y,b._x,this._elemA._y+this._y))}this._elemA.updateLimitSize()}else{c=true}if(this._elemB.getType()=="UMLFork_JoinNode"){if(this._x!=-1){this._points[1].setPoint(this._elemB.getLink(b._x,b._y,this._elemB._x+this._x,a._y))}else{this._points[1].setPoint(this._elemB.getLink(b._x,b._y,a._x,this._elemB._y+this._y))}this._elemB.updateLimitSize()}else{this._points[1]=this._elemB.getLinkCentered(this._points[0].getX(),this._points[0].getY())}if(c){this._points[0]=this._elemA.getLinkCentered(this._points[1].getX(),this._points[1].getY())}}}}else{Flow.base._calculateLineEnds.call(this)}};Flow.prototype.drag=function(a,b){if(this._elemA.getType()=="UMLFork_JoinNode"||this._elemB.getType()=="UMLFork_JoinNode"){if(this._selectedLine){this._points[this._selected+1].setPoint(a,b);this._moved=true}else{if(this._selectedPoint){this._points[this._selected].setPoint(a,b);this._moved=true}}}else{Flow.base.drag.call(this,a,b)}};Flow.prototype.drop=function(a,d){if(this._moved){this._checkForNewNodes(a,d);var b;var c=this._points.length;if(this._elemA.getType()=="UMLFork_JoinNode"&&this._selected==0){b=this._elemA}else{if(this._elemB.getType()=="UMLFork_JoinNode"&&this._selected==c-1){b=this._elemB}}if(b){if(b._quadrant==1){this._x=a-b._x;this._x=(this._x>=0)?this._x:1}else{this._y=d-b._y;this._y=(this._y>=0)?this._y:1}}}else{if(this._selectedBefore){this._selectComponent(a,d)}}this._selectedLine=false;this._selectedPoint=false;this._moved=false;this._delUselessPoints();this.notifyChange()};Flow.prototype.exchangePosition=function(){var a;a=this._x;this._x=this._y;this._y=a;delete a};Flow.prototype._checkForNewNodes=function(a,e){if(this._selectedPoint&&(this._selected==0||this._selected==this._points.length-1)){var b=this._diagram.reassignRelationTo(this,a,e);if(b!=this){if(this._selected==0){if(b&&!(b.getType()=="UMLFork_JoinNode"&&this._elemB.getType()=="UMLFork_JoinNode")){var d=this._elemA;this.setElementA(b);if(d.getType()=="UMLFork_JoinNode"){d.updateLimitSize()}this.updateName()}}else{if(b&&!(b.getType()=="UMLFork_JoinNode"&&this._elemA.getType()=="UMLFork_JoinNode")){var c=this._elemB;this.setElementB(b);if(c.getType()=="UMLFork_JoinNode"){c.updateLimitSize()}}}}}};Flow.prototype.getElementXML=function(a){var b=Flow.base.getElementXML.call(this,a);b.setAttribute("y",this._y);b.setAttribute("x",this._x);return b};Flow.prototype.setName=function(a){this._components[1].setValue(a)};Flow.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Flow.prototype.getName=function(){return this._components[1].getValue()};Flow.prototype.getStereotypes=function(){return this._components[0]._childs};var FlowFinal=function(a){a=a||{};FlowFinal.baseConstructor.call(this,a)};JSFun.extend(FlowFinal,Elliptical);FlowFinal.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};FlowFinal.prototype.setName=function(a){this._components[1].setValue(a)};FlowFinal.prototype.getStereotypes=function(){return this._components[0]._childs};FlowFinal.prototype.getName=function(){return this._components[1].getValue()};FlowFinal.prototype.getStereotype=function(){return this._components[0]};var HierarchicalSwimlane=function(a){a=a||{};HierarchicalSwimlane.baseConstructor.call(this,a)};JSFun.extend(HierarchicalSwimlane,SuperNode);HierarchicalSwimlane.prototype.deleteRegion=function(d){var c;var b;if(this._orientation){var e=d.getWidth()}else{var e=d.getHeight()}for(c=0;c<this._nodeChilds.length;c++){if(this._nodeChilds[c]==d){break}}d.deleted();var a=c;if(a==(this._nodeChilds.length)){if(this._nodeChilds[a-1]._components[2]){this._nodeChilds[a-1]._components[2].notifyDelete()}}if(this._orientation){this._minWidth=this.getWidth()-e;this.setWidth(this.getWidth()-e)}else{this._minHeight=this.getHeight()-e;this.setHeight(this.getHeight()-e)}this.updateRegions();this.notifyChange(true);this.notifyDraw()};HierarchicalSwimlane.prototype.notifyChange=function(d,b,c){d=d||false;b=b||false;c=c||false;this.resetSizeComponentSwimlane();this.updateSizeComponentSwimlane();var a=this._nodeChilds;for(i=0;i<a.length;i++){if(a.length-1!=i){a[i].updateContainer(false)}else{a[i].updateContainer()}}HierarchicalSwimlane.base.notifyChange.call(this,d,b,c)};HierarchicalSwimlane.prototype.resetSizeComponentSwimlane=function(){var a=this._nodeChilds;for(var b=0;b<a.length;b++){a[b]._heightComp=(this._orientation)?(a[b]._components[0]._height+a[b]._components[1]._height):0;a[b]._widthComp=(this._orientation)?0:(a[b]._components[0]._width+a[b]._components[1]._width)}};HierarchicalSwimlane.prototype.updateSizeComponentSwimlane=function(){var b=this._nodeChilds;if(this._orientation){var a=0;for(var c=0;c<b.length;c++){if(b[c]._heightComp>a){a=b[c]._heightComp}}for(var c=0;c<b.length;c++){b[c]._heightComp=a}}else{var a=0;for(var c=0;c<b.length;c++){if(b[c]._widthComp>a){a=b[c]._widthComp}}for(var c=0;c<b.length;c++){b[c]._widthComp=a}}};HierarchicalSwimlane.prototype.updateRegions=function(b,h){b=b||false;h=h||false;var e=this._nodeChilds.length;if(this._orientation){var a=0;var g=this.getX();for(var c=0;c<e;c++){var n=this._nodeChilds[c];n.setMinHeight(this._minHeight-this._components[0].getHeight()-this._components[1].getHeight());n.setHeight(this.getHeight()-this._components[0].getHeight()-this._components[1].getHeight());if(n._components[2] instanceof RegionLine){n._components[2].setHeight(this.getHeight()-this._components[0].getHeight()-this._components[1].getHeight())}}for(c=0;c<e;c++){this._nodeChilds[c]._x=g;this._nodeChilds[c]._y=this.getY()+this._components[0].getHeight()+this._components[1].getHeight();if(c==e-1){if(b||(g+this._nodeChilds[c]._width)<(this.getWidth()+this.getX())){this._nodeChilds[c].setWidth(this.getWidth()+this.getX()-g)}else{this.setWidth(g+this._nodeChilds[c]._width-this.getX())}}g+=this._nodeChilds[c].getWidth()}for(c=0;c<e;c++){var m=this._nodeChilds[c]._x-this._nodeChilds[c]._prex;if(m>0||(m<0&&!h)){for(var d=0;d<this._nodeChilds[c]._nodeChilds.length;d++){this._nodeChilds[c]._nodeChilds[d].updatePosition(m,0,true)}}this._nodeChilds[c].resetMovement()}}else{var l=0;var f=this.getY();for(var c=0;c<e;c++){var n=this._nodeChilds[c];n.setMinWidth(this._minWidth-this._components[0].getWidth()-this._components[1].getWidth());n.setWidth(this.getWidth()-this._components[0].getWidth()-this._components[1].getWidth());if(n._components[2] instanceof RegionLine){n._components[2].setWidth(this.getWidth()-this._components[0].getWidth()-this._components[1].getWidth())}}for(c=0;c<e;c++){this._nodeChilds[c]._x=this.getX()+this._components[0].getWidth()+this._components[1].getWidth();this._nodeChilds[c]._y=f;if(c==e-1){if(b||(f+this._nodeChilds[c]._height)<(this.getHeight()+this.getY())){this._nodeChilds[c].setHeight(this.getHeight()+this.getY()-f)}else{this.setHeight(f+this._nodeChilds[c]._height-this.getY())}}f+=this._nodeChilds[c].getHeight()}var m;for(c=0;c<e;c++){m=this._nodeChilds[c]._y-this._nodeChilds[c]._prey;if(m>0||(m<0&&!h)){for(var d=0;d<this._nodeChilds[c]._nodeChilds.length;d++){this._nodeChilds[c]._nodeChilds[d].updatePosition(0,m,true)}}this._nodeChilds[c].resetMovement()}}this.updateComponents();for(c=0;c<this._nodeChilds.length;c++){this._nodeChilds[c].updateComponents()}};HierarchicalSwimlane.prototype.select=function(h,g){var b;var f=-1;this.deselectComponent();for(b=0;b<this._nodeChilds.length;b++){if(this._nodeChilds[b]._selected){f=b}this._nodeChilds[b].deselect()}if(this._diagram._activeMenu){this.removeContextualMenu()}if(this._diagram._pressMouse==true){if(this._selected){if(this._moveable&&Math.abs(h-(this._x+this._width+2.5))<=5&&Math.abs(g-(this._y+this._height+2.5))<=5){this._resizing=true;return true}var a=this._nodeChilds;for(b=0;b<a.length-1;b++){if(b==f){if(this._orientation){var m=a[b].getX()+a[b].getWidth()-7;var e=a[b].getY()+a[b]._heightComp+7;var l=a[b+1].getX()+a[b+1].getWidth()-7;var c=a[b+1].getY()+a[b+1]._heightComp+7}else{var m=a[b].getX()+a[b]._widthComp+7;var e=a[b].getY()+a[b].getHeight()-7;var l=a[b+1].getX()+a[b+1]._widthComp+7;var c=a[b+1].getY()+a[b+1].getHeight()-7}var d=this;var o=new Dialog({text:"Do you want to delete the region?",cancelable:true});if(Math.abs(h-(m))<=8&&Math.abs(g-(e))<=8){this._diagram._pressMouse=false;o.show(function(){d.deleteRegion(a[b])});return true}if(Math.abs(h-(l))<=8&&Math.abs(g-(c))<=8){this._diagram._pressMouse=false;o.show(function(){d.deleteRegion(a[b+1])});return true}}}for(b=0;b<this._nodeChilds.length;b++){var n=this._nodeChilds[b];if(n.isOverComponent(h,g)){if(n.isOverRegionLine(h,g)){n.selectComponent(h,g)}else{this._relx=h-this._x;this._rely=g-this._y;this._selectedBefore=true}return true}}if(this.isOverComponent(h,g)){this._relx=h-this._x;this._rely=g-this._y;this._selectedBefore=true;return true}}if(this.isOver(h,g)){this._relx=h-this._x;this._rely=g-this._y;this._selectedBefore=this._selected;this._selected=true;return true}else{return false}}else{if(this._diagram._pressMouseRight==true){if(this.isOver(h,g)){document.oncontextmenu=function(){return false};h=h+this._diagram._div.offsetLeft;g=g+this._diagram._div.offsetTop;this.showContextualMenu(h,g);return true}else{return false}}}};HierarchicalSwimlane.prototype.updateContainer=function(h){if(!(h==false||h==true)){h=true}if(this._container){var o;var c=(this._orientation)?(this._components[0]._height+this._components[1]._height):0;var f=(this._orientation)?0:(this._components[0]._width+this._components[1]._width);var l=this._x+f;var g=this._y+c;var d=this._x+f;var b=this._y+c;var n;var r,a,p,m;var q=this._nodeChilds.length;var e=false;for(o=0;o<q;o++){n=this._nodeChilds[o];if(n._visible){if(this._orientation){p=n._x;elemLeftY=n._y;if(o==(q-1)){r=n._x+n._minWidth}else{r=n._x+n._width}elemRigthY=n._y+n._minHeight}else{p=n._x;elemLeftY=n._y;r=n._x+n._minWidth;if(o==(q-1)){elemRigthY=n._y+n._minHeight}else{elemRigthY=n._y+n._height}r=n._x+n._minWidth}if(r>d){d=r}if(elemRigthY>b){b=elemRigthY}if(p<l){l=p}if(elemLeftY<g){g=elemLeftY}e=true}}if(e){if(l<(this._x+f)||g<(this._y+c)){this.setWidth(this._x+f-l+this._width);this.setHeight(this._y+c-g+this._height);this._x=l-f;this._y=g-c;this.setMinWidth(d-this._x);this.setMinHeight(b-this._y)}else{this.setMinWidth(d-this._x);this.setMinHeight(b-this._y)}}this._prex=this._x;this._prey=this._y;this.updateComponents();if(this._parent&&h){this._parent.updateContainer()}}};HierarchicalSwimlane.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};HierarchicalSwimlane.prototype.setName=function(a){this._components[1].setValue(a)};HierarchicalSwimlane.prototype.getStereotypes=function(){return this._components[0]._childs};HierarchicalSwimlane.prototype.getName=function(){return this._components[1].getValue()};HierarchicalSwimlane.prototype.getStereotype=function(){return this._components[0]};var UMLStereotypedElement=function(a){a=a||{};this._parent=a.parent||null;this._shownStereotype;this._appliedStereotypes=[]};UMLStereotypedElement.prototype.isDrawableStereotype=function(){var b=["UMLActor","UMLUseCase","UMLUseCaseExtended","UMLSystem","UMLSubSystem","UMLClass","UMLComponent","UMLInterfaceExtended","UMLPackage","UMLPackageContainer","UMLComComponent","UMLInterface","UMLOption","UMLAlternative","UMLLoop","UMLBreak","UMLAcceptEventAction","UMLTimeEvent","UMLSendSignalAction","UMLAction","UMLObject","UMLActivity","UMLDataStore","UMLConnectorActivity","UMLHorizontalHierarchicalSwimlane","UMLVerticalHierarchicalSwimlane","UMLSimpleState","UMLCompositeState","UMLVerticalRegion","UMLPin","UMLParameterNode","UMLExpansionNode","UMLHorizontalRegion","UMLPort","UMLTerminate","UMLEntryPoint","UMLExitPoint","UMLJunction","UMLFlowFinal"];for(var a=0;a<b.length;a++){if(this._parent.getType()==b[a]){return true}}return false};var setObjectsStereotype=function(b,a){a._stereotypes=b};UMLStereotypedElement.prototype.applyStereotype=function(b){if(!(b instanceof Stereotype)){return false}var d=this._parent;if(!d){return false}var c;var e=false;var a="\xAB"+b.getName()+"\xBB";for(c=0;c<d.getStereotype()._childs.length&&!e;c++){if(a==d.getStereotype()._childs[c]._text&&b._validMetaclass(d.getType())){e=true}}if(!e){d.addStereotype(b.getName());this._appliedStereotypes.push(b);d.setTagValues(b.getTagValues());d.notifyDraw();return true}return false};UMLStereotypedElement.prototype.showStereotype=function(a){if(!(a instanceof Stereotype)){return false}var c=this._parent;var d=false;if(!c){return false}for(var b=0;b<this._appliedStereotypes.length;b++){if(this._appliedStereotypes[b]==a){d=true;break}}if(d){if(!this.drawStereotype(a)){return false}c.notifyDraw();return true}return false};UMLStereotypedElement.prototype.drawStereotype=function(a){var c=this._parent;if(!c){return false}if(!a||!this.isDrawableStereotype()){c.setSelectedFigure(0);c.notifyDraw();c._stereotypeProperties._shownStereotype="";return false}var d=false;for(var b=0;b<c._figures.length&&!d;b++){if(c._figures[b].route&&c._figures[b].route==a.getPath()){if(!c._figures[b].foundInAssociatedStereotypes(a)){c._figures[b].addAssociatedStereotype(a)}c.setSelectedFigure(b);c._stereotypeProperties._shownStereotype="\xAB"+a.getName()+"\xBB";d=true}}if(!d&&a.getPath()){c.addFigure(new FromImageFigure({route:a.getPath(),parent:c}));c._figures[c._figures.length-1].addAssociatedStereotype(a);c.setSelectedFigure(c._figures.length-1);c.notifyDraw();c._stereotypeProperties._shownStereotype="\xAB"+a.getName()+"\xBB"}return true};UMLStereotypedElement.prototype.removeStereotype=function(a){if(!(a instanceof Stereotype)){return false}var c=false;for(var b=0;b<this._appliedStereotypes.length&&!c;b++){if(a==this._appliedStereotypes[b]){c=true}}if(c){this.removeTagValues(a);this.removeFigure(a);this.deleteStereotypeTag(a);this.removeAppliedStereotype(a)}return true};UMLStereotypedElement.prototype.removeTagValues=function(a){if(!(a instanceof Stereotype)){return false}var f=this._parent._tagValues;var e=a._components[3]._childs;var c,b;var d=false;c=0;while(f[c]){d=false;for(b=0;b<e.length&&!d;b++){if(f[c][0]==e[b].getNameTagValue()){d=true;f.splice(c,1)}}if(!d){c++}}return true};UMLStereotypedElement.prototype.removeFigure=function(a){if(!(a instanceof Stereotype)){return false}var b;for(b=0;b<this._parent._figures.length;b++){if(this._parent._figures[b] instanceof FromImageFigure&&this._parent._figures[b].foundInAssociatedStereotypes(a)){this._parent._figures[b].delAssociatedStereotype(a);if(this._parent._selectedFigure==b){this.drawStereotype(null)}if(!this._parent._figures[b]._associatedStereotypes.length){this._parent.delFigure(this._parent._figures[b]);if(this._parent._selectedFigure>b){this._parent.setSelectedFigure(this._parent._selectedFigure-1)}}return true}}return false};UMLStereotypedElement.prototype.deleteStereotypeTag=function(a){if(!(a instanceof Stereotype)){return false}var c=this._parent.getStereotype()._childs;var b;for(b in c){if(c[b]._text=="\xAB"+a.getName()+"\xBB"){c.splice(b,1);break}}this._parent.getStereotype().notifyChange()};UMLStereotypedElement.prototype.removeAppliedStereotype=function(a){for(var b=0;b<this._appliedStereotypes.length;b++){if(a==this._appliedStereotypes[b]){this._appliedStereotypes.splice(b,1)}break}};UMLStereotypedElement.prototype.changeNameStereotype=function(b,a){var e=false;for(var c=0;c<this._appliedStereotypes.length&&!e;c++){if(b==this._appliedStereotypes[c]){e=true}}if(e){var d=this._parent.getStereotype()._childs;for(c in d){if(d[c]._text=="\xAB"+b.getName()+"\xBB"){d[c].setText(a,true);if("\xAB"+b.getName()+"\xBB"==this._parent._stereotypeProperties._shownStereotype){this._parent._stereotypeProperties._shownStereotype=a}break}}this._parent.getStereotype().notifyChange()}};UMLStereotypedElement.prototype.updateElementStereotypes=function(){var a=this._parent.getStereotype()._childs;var d=[];var e=false;for(var c=0;c<this._appliedStereotypes.length;c++){e=false;if(this._appliedStereotypes[c]._validMetaclass(this._parent.getType())){for(var b=0;b<a.length&&!e;b++){if("\xAB"+this._appliedStereotypes[c].getName()+"\xBB"==a[b]._text){for(k=0;k<this._appliedStereotypes[c]._components[3]._childs.length;k++){d.push([this._appliedStereotypes[c]._components[3]._childs[k].getNameTagValue(),this._appliedStereotypes[c]._components[3]._childs[k].getDefaultValue()])}e=true}}}}var f=this._parent._tagValues;c=0;while(f[c]){e=false;for(b=0;b<d.length&&!e;b++){if(d[b][0]==f[c][0]){e=true;c++}}if(!e){f.splice(c,1)}}var f=this._parent._tagValues;for(c in d){e=false;for(b=0;b<f.length&&!e;b++){if(d[c][0]==f[b][0]){e=true}}if(!e){f.push(d[c])}}};UMLStereotypedElement.prototype.showTagValuesDialog=function(){var h=this._parent;var a=document.createElement("div");a.className="ud_popup";var b=document.createElement("form");var g=[];var e;for(e=0;e<h._tagValues.length;e++){g.push(document.createElement("input"))}var l=document.createElement("input");l.setAttribute("type","submit");l.setAttribute("value","ok");for(e=0;e<h._tagValues.length;e++){g[e].setAttribute("type","text");g[e].setAttribute("value",h._tagValues[e][1]||"")}var c=function(p){var o;for(o=0;o<h._tagValues.length;o++){h._tagValues[o][1]=g[o].value}document.body.removeChild(a)};var d=function(o){document.body.removeChild(a)};b.onsubmit=function(){return false};l.addEventListener("click",c,false);var m;var n;var f=[];for(e=0;e<g.length;e++){f.push(h._tagValues[e][0])}for(e=0;e<g.length;e++){n=document.createElement("div");m=document.createElement("label");m.appendChild(document.createTextNode(f[e]));n.appendChild(m);n.appendChild(g[e]);b.appendChild(n)}b.appendChild(l);a.appendChild(b);document.body.appendChild(a);a.style.top=(window.innerHeight-b.offsetHeight)/2+"px";a.style.left=(window.innerWidth-b.offsetWidth)/2+"px"};UMLStereotypedElement.prototype.showApplyStereotypesDialog=function(){var n=this._parent;var b=n._diagram._stereotypes;var a=document.createElement("div");a.className="ud_popup";var d=document.createElement("form");var m=[];var l,h,g;var s=[];var o=[];var q;for(l=0;l<n._components.length;l++){if(n._components[l] instanceof StereotypeFields){o=n._components[l]._childs;for(h=0;h<o.length;h++){if(!m[o[h].getValue()]){m[o[h].getValue()]=n}}}}if(n instanceof SuperNode){for(l=0;l<n._nodeChilds.length;l++){for(h=0;h<n._nodeChilds[l]._components.length;h++){if(n._nodeChilds[l]._components[h] instanceof StereotypeFields){o=n._nodeChilds[l]._components[h]._childs;for(g=0;g<o.length;g++){if(!m[o[g].getValue()]){m[o[g].getValue()]=n._nodeChilds[l]}}}}}}for(l=0;l<b.length;l++){s=b[l]._metaclass;for(h=0;h<s.length;h++){if(s[h].getName()==n.getType()){if(!m["\xAB"+b[l].getName()+"\xBB"]){m["\xAB"+b[l].getName()+"\xBB"]=n}}}}if(n instanceof SuperNode){for(g=0;g<n._nodeChilds.length;g++){q=n._nodeChilds[g];if(q._stereotypeProperties){for(l=0;l<n._diagram._stereotypes.length;l++){s=n._diagram._stereotypes[l]._metaclass;for(h=0;h<s.length;h++){if(s[h].getName()==q.getType()){if(!m["\xAB"+n._diagram._stereotypes[l].getName()+"\xBB"]){m["\xAB"+n._diagram._stereotypes[l].getName()+"\xBB"]=n._nodeChilds[g]}}}}}}}var r=false;for(l in m){r=true}if(!r){return}var e;textField=document.createElement("select");e=document.createElement("option");e.setAttribute("value","");e.appendChild(document.createTextNode("default"));textField.appendChild(e);for(l in m){e=document.createElement("option");e.setAttribute("value",l);e.appendChild(document.createTextNode(l));textField.appendChild(e)}var p=document.createElement("input");p.setAttribute("type","submit");p.setAttribute("value","ok");var c=function(x){var t=[];var y=false;var w;var v,u;for(v in m){if(textField.value==v){w=m[v];break}}for(v=0;v<b.length&&!y;v++){if(w&&b[v]._validMetaclass(w.getType())&&"\xAB"+b[v].getName()+"\xBB"==textField.value){if(w._stereotypeProperties){w._stereotypeProperties.applyStereotype(b[v])}y=true}}document.body.removeChild(a)};var f=function(t){document.body.removeChild(a)};d.onsubmit=function(){return false};p.addEventListener("click",c,false);d.appendChild(textField);d.appendChild(p);a.appendChild(d);document.body.appendChild(a);a.style.top=(window.innerHeight-d.offsetHeight)/2+"px";a.style.left=(window.innerWidth-d.offsetWidth)/2+"px"};UMLStereotypedElement.prototype.showStereotypesDialog=function(){var n=this._parent;var b=n._stereotypeProperties._appliedStereotypes;var a=document.createElement("div");a.className="ud_popup";var d=document.createElement("form");var m=[];var l,h,g;var s=[];var o=[];var q;for(l=0;l<b.length;l++){if(!m["\xAB"+b[l].getName()+"\xBB"]){m["\xAB"+b[l].getName()+"\xBB"]=n}}if(n instanceof SuperNode){for(g=0;g<n._nodeChilds.length;g++){q=n._nodeChilds[g];if(q._stereotypeProperties){for(l=0;l<b.length;l++){if(!m["\xAB"+b[l].getName()+"\xBB"]){m["\xAB"+b[l].getName()+"\xBB"]=n._nodeChilds[g]}}}}}var r=false;for(l in m){r=true}if(!r){return}var e;textField=document.createElement("select");e=document.createElement("option");e.setAttribute("value","");e.appendChild(document.createTextNode("default"));textField.appendChild(e);for(l in m){e=document.createElement("option");e.setAttribute("value",l);e.appendChild(document.createTextNode(l));if(n._stereotypeProperties._shownStereotype&&n._stereotypeProperties._shownStereotype==l){e.setAttribute("selected","selected")}textField.appendChild(e)}var p=document.createElement("input");p.setAttribute("type","submit");p.setAttribute("value","ok");var c=function(x){var t=[];var y=false;var w;var v,u;for(v in m){if(textField.value==v){w=m[v];break}}for(v=0;v<b.length&&!y;v++){if(w&&b[v]._validMetaclass(w.getType())&&"\xAB"+b[v].getName()+"\xBB"==textField.value){w._stereotypeProperties.showStereotype(b[v]);y=true}}if(!y){n._stereotypeProperties.drawStereotype(null)}document.body.removeChild(a)};var f=function(t){document.body.removeChild(a)};d.onsubmit=function(){return false};p.addEventListener("click",c,false);d.appendChild(textField);d.appendChild(p);a.appendChild(d);document.body.appendChild(a);a.style.top=(window.innerHeight-d.offsetHeight)/2+"px";a.style.left=(window.innerWidth-d.offsetWidth)/2+"px"};var setStereotypeProperties=function(a){a._stereotypeProperties=new UMLStereotypedElement({parent:a})};var setStereotypeObjects=function(b,a){if(a instanceof Diagram){a._stereotypes=b}};var StereotypeTag=function(a){a=a||{};StereotypeTag.baseConstructor.call(this,a)};JSFun.extend(StereotypeTag,StereotypeItem);StereotypeTag.prototype.setText=function(d,b){var b=b||false;var c;var a;if(JSFun.isString(d)){if(this._text!=d&&!b){if(this._parent&&this._parent instanceof SuperComponent&&this._parent._parent._stereotypeProperties){a=this._parent._parent._stereotypeProperties;for(c=0;c<a._appliedStereotypes.length;c++){if("\xAB"+a._appliedStereotypes[c].getName()+"\xBB"==this._text){this._parent._parent._stereotypeProperties.removeStereotype(a._appliedStereotypes[c]);break}}}else{if(this._parent&&this._parent._stereotypeProperties){a=this._parent._stereotypeProperties;for(c=0;c<a._appliedStereotypes.length;c++){if("\xAB"+a._appliedStereotypes[c].getName()+"\xBB"==this._text){a.removeStereotype(a._appliedStereotypes[c]);break}}}}}StereotypeTag.base.setText.call(this,d)}};StereotypeTag.prototype.setValue=function(a){this.setText(a)};StereotypeTag.prototype.getComponentXML=function(d){var b=d.createElement("item");if(this._id){b.setAttribute("id",this._id)}b.setAttribute("value",this.getValue());var a=this._parent._parent._diagram;var e=a._stereotypes;var c;for(c=0;c<e.length;c++){if("\xAB"+e[c].getName()+"\xBB"==this.getValue()){b.setAttribute("stereotypeObject",true);break}}return b};var StereotypeTagList=function(a){a=a||{};StereotypeTagList.baseConstructor.call(this,a)};JSFun.extend(StereotypeTagList,StereotypeFields);StereotypeTagList.prototype.notifyDelete=function(c){var b;var a=this._parent._stereotypeProperties;if(a){for(b=0;b<a._appliedStereotypes.length;b++){if("\xAB"+a._appliedStereotypes[b].getName()+"\xBB"==c._text){a.removeStereotype(a._appliedStereotypes[b]);break}}}this.delSubComponent(c);this.updateComponents()};StereotypeTagList.prototype.delSubComponent=function(b){var a;for(a in this._childs){if(this._childs[a]==b){this._childs.splice(a,1);break}}};StereotypeTagList.prototype.newItem=function(){return new StereotypeTag({text:"\xABstereotype\xBB",orientation:this._orientation||0})};StereotypeTagList.prototype.setComponentXML=function(d){var a;var c=d.childNodes;if(d.getAttribute("visibleSubComponents")=="true"){this._visibleSubComponents=true}else{this._visibleSubComponents=false}var b;var a;for(a=0;a<c.length;a++){if(c[a].getAttribute("stereotypeObject")=="true"){b=c[a].getAttribute("value");this.applyStereotype(b)}else{this.addField(c[a].getAttribute("value"))}}};StereotypeTagList.prototype.applyStereotype=function(e){var d=this._parent._diagram._stereotypes;var c;var e;var b,a;for(a=0;a<d.length;a++){c=d[a]._metaclass;for(b=0;b<c.length;b++){if(c[b].getName()==this._parent.getType()){if("\xAB"+d[a].getName()+"\xBB"==e){this._parent._stereotypeProperties.applyStereotype(d[a])}}}}};var Port=function(a){a=a||{};Port.baseConstructor.call(this,a);this.setAlone();this.setWidth(14);this.setHeight(14);setStereotypeProperties(this);this.addFigure(new RectangleFigure({color:"#eeeeee"}));this.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));this.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}))};JSFun.extend(Port,Rectangular);Port.prototype.drop=function(a,b){this.correctPosition();Port.base.drop.call(this,a,b)};Port.prototype.correctPosition=function(){if(!this._parent){return}var b=this._parent.getX();var g=this._parent.getY();var c=this._parent.getWidth();var d=this._parent.getHeight();var e=this._parent.getLinkCentered(this.getX()+7,this.getY()+7);var a=e.getX();var f=e.getY();this.setPosition(a-7,f-7);this.updatePositionComponents(a,f)};Port.prototype.updatePositionComponents=function(b,d){var a=-1;if(b==this._parent.getX()){a=Component.Left}else{if(b==this._parent.getX()+this._parent.getWidth()){a=Component.Right}else{if(d==this._parent.getY()){a=Component.Top}else{if(d==this._parent.getY()+this._parent.getHeight()){a=Component.Bottom}}}}for(var c=0;c<this._components.length;c++){this._components[c]._setPosition(a)}this.updateComponents()};Port.prototype.notifyChange=function(){var a;for(a in this._relations){this._relations[a].notifyChange()}this.correctPosition()};Port.prototype.deleted=function(){Port.base.deleted.call(this);this._parent.notifyDeleted(this)};Port.prototype.setName=function(a){this._components[1].setValue(a)};Port.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Port.prototype.getStereotype=function(){return this._components[0]};var NodeAction=function(a){a=a||{};NodeAction.baseConstructor.call(this,a);this._ports=[]};JSFun.extend(NodeAction,Node);NodeAction.prototype.addPort=function(a){if(a instanceof Pin){this._ports.push(a);this._diagram._addNode(a);if(this._container){a.setParent(this)}else{a.setAction(this)}a.correctPosition()}};NodeAction.prototype.setSelectedFigure=function(b){var a=NodePorts.base.setSelectedFigure.call(this,b);if(a){if(this._figures[b] instanceof FromImageFigure){for(i in this._ports){this._ports[i].setVisibility(false)}}else{for(i in this._ports){this._ports[i].setVisibility(true)}}}};NodeAction.prototype.setVisibility=function(a){NodePorts.base.setVisibility.call(this,a);var b=true;if(this._selectedFigure&&a){b=false}if(this._container&&b){for(i in this._ports){this._ports[i].setVisibility(a)}}};NodeAction.prototype.updatePosition=function(c,a,g){g=g||false;if(c==undefined&&a==undefined){var e=this.getMovement();var f=e.getX();var d=e.getY()}else{var f=c;var d=a}var b;for(b in this._ports){this._ports[b].updatePosition(f,d,g)}NodeAction.base.updatePosition.call(this,c,a,g)};NodeAction.prototype.notifyChange=function(){NodeAction.base.notifyChange.call(this);var a;for(a in this._ports){this._ports[a].correctPosition();this._ports[a].notifyChange()}};NodeAction.prototype.updateContainer=function(a){NodeAction.base.updateContainer.call(this,a);for(i in this._ports){this._ports[i].correctPosition();this._ports[i].notifyChange()}};NodeAction.prototype.deleted=function(){NodeAction.base.deleted.call(this);var a;for(a in this._ports){this._ports[a].deleted()}};NodeAction.prototype.getElementXML=function(b){var c=NodeAction.base.getElementXML.call(this,b);var a;for(a in this._ports){c.appendChild(this._ports[a].getElementXML(b))}return c};NodeAction.prototype.addChild=function(a){if(a instanceof Pin){this._ports.push(a);if(this._container){a.setParent(this)}else{a.setAction(this)}a.correctPosition();return}else{NodeAction.base.addChild.call(this,a)}};NodeAction.prototype.notifyDeleted=function(b){if(b instanceof Pin){var a;for(a in this._ports){if(this._ports[a]==b){this._ports.splice(a,1)}}}else{NodeAction.base.notifyDeleted.call(this,b)}};NodeAction.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};NodeAction.prototype.setName=function(a){this._components[1].setValue(a)};NodeAction.prototype.getStereotypes=function(){return this._components[0]._childs};NodeAction.prototype.getName=function(){return this._components[1].getValue()};NodeAction.prototype.getStereotype=function(){return this._components[0]};var NodeForkJoin=function(a){a=a||{};NodeForkJoin.baseConstructor.call(this,a);this._quadrant=1};JSFun.extend(NodeForkJoin,Rectangular);NodeForkJoin.prototype.getElementXML=function(b){var c=b.createElement(this.getType());c.setAttribute("id",this.getId());c.setAttribute("x",this.getX());c.setAttribute("y",this.getY());c.setAttribute("width",this.getWidth());c.setAttribute("height",this.getHeight());c.setAttribute("backgroundColor",this.getBackgroundColor());c.setAttribute("quadrant",this._quadrant);var a;for(a in this._components){if(this._components[a].getId()){c.appendChild(this._components[a].getComponentXML(b))}}for(a in this._nodeChilds){c.appendChild(this._nodeChilds[a].getElementXML(b))}for(a in this._relationChilds){c.appendChild(this._relationChilds[a].getElementXML(b))}return c};NodeForkJoin.prototype.setElementXML=function(d){this.setPosition(parseInt(d.getAttribute("x")),parseInt(d.getAttribute("y")));this.resetMovement();this._width=parseInt(d.getAttribute("width"));this._height=parseInt(d.getAttribute("height"));this.setBackgroundColor(d.getAttribute("backgroundColor"));if(parseInt(d.getAttribute("quadrant"))!=this._quadrant){this._minWidth=5;this._minHeight=50;this._quadrant=parseInt(d.getAttribute("quadrant"))}var b;var c=d.childNodes;for(b=0;b<c.length;b++){if(c[b].nodeName=="item"){this.setValue(c[b].getAttribute("id"),c[b].getAttribute("value"))}else{if(c[b].nodeName=="superitem"){var a;for(a in this._components){if(this._components[a].getId()==c[b].getAttribute("id")){this._components[a].setComponentXML(c[b])}}}}}};NodeForkJoin.prototype.setQuadrant=function(c){if(this._quadrant!=c){var f=this._height;var a=this._width;var d=this._minHeight;var b=this._minWidth;this.setMinHeight(b);this.setMinWidth(d);this.setHeight(a);this.setWidth(f);for(var e=this._relations.length;e--;){this._relations[e].exchangePosition()}this._quadrant=c}};NodeForkJoin.prototype.drag=function(a,f){if(this._resizing){var e=this._x;var c=this._y;if(a>e&&f>c){if(Math.abs(a-e)>Math.abs(f-c)){if(this._quadrant!=1){this.setQuadrant(1)}else{var d=a-this._x;d=Math.round(d);d=d-d%5;this.setWidth(d)}}else{if(this._quadrant!=2){this.setQuadrant(2)}else{var b=f-this._y;b=Math.round(b);b=b-b%5;this.setHeight(b)}}}else{if(this._quadrant==1){var d=a-this._x;d=Math.round(d);d=d-d%5;this.setWidth(d)}else{var b=f-this._y;b=Math.round(b);b=b-b%5;this.setHeight(b)}}}else{if(this._selected){var d=a-this._relx;var b=f-this._rely;d=Math.round(d);d=d-d%5;b=Math.round(b);b=b-b%5;this.setPosition(d,b);this._moved=true}}};NodeForkJoin.prototype.updateLimitSize=function(){var c;var b=this._relations;var a=40;if(this._quadrant==1){for(c=b.length;c--;){if(b[c]._x>a){a=b[c]._x}}this.setMinWidth(a+10)}else{for(c=b.length;c--;){if(b[c]._y>a){a=b[c]._y}}this.setMinHeight(a+10)}};NodeForkJoin.prototype.notifyDeleted=function(a){var b;for(b in this._relations){if(this._relations[b]==a){this._relations.splice(b,1)}}this.updateLimitSize()};var ObjectActivity=function(a){a=a||{};ObjectActivity.baseConstructor.call(this,a)};JSFun.extend(ObjectActivity,Rectangular);ObjectActivity.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};ObjectActivity.prototype.setName=function(a){this._components[1].setValue(a)};ObjectActivity.prototype.getStereotypes=function(){return this._components[0]._childs};ObjectActivity.prototype.getName=function(){return this._components[1].getValue()};ObjectActivity.prototype.getStereotype=function(){return this._components[0]};var ParameterNode=function(a){a=a||{};ParameterNode.baseConstructor.call(this,a);this.setWidth(60);this.setHeight(30)};JSFun.extend(ParameterNode,Pin);ParameterNode.prototype.correctPosition=function(){if(!this._parent){return}var b=this._parent.getX();var g=this._parent.getY();var c=this._parent.getWidth();var d=this._parent.getHeight();var e=this._parent.getLinkCentered(this.getX()+this._width/2,this.getY()+this._height/2);var a=e.getX();var f=e.getY();this.setPosition(a-this._width/2,f-this._height/2)};var SendSignalAction=function(a){a=a||{};SendSignalAction.baseConstructor.call(this,a)};JSFun.extend(SendSignalAction,Rectangular);SendSignalAction.prototype.getLinkCentered=function(l,h){if(this._selectedFigure){return SendSignalAction.base.getLinkCentered.call(this,l,h)}if(l instanceof Point){h=l.getY();l=l.getX()}var g=this.getCentralPoint();var d=g.getX();var c=g.getY();var a,n,f,e;var b;a=this.getX();n=this.getY();f=g.getX();e=this.getY();if(l<d){if(h<c){b=(this.getY()-c)/(this.getX()-d);if(((h-c)==0)||Math.abs((h-c)/(l-d))<Math.abs(b)){f=this.getX();e=this.getY()+this.getHeight()}else{f=this.getX()+this.getWidth();e=this.getY()}}else{b=(this.getY()+this.getHeight()-c)/(this.getX()-d);if(((h-c)==0)||Math.abs((h-c)/(l-d))<Math.abs(b)){f=this.getX();e=this.getY()+this.getHeight()}else{n=this.getY()+this.getHeight();f=this.getX()+this.getWidth();e=this.getY()+this.getHeight()}}}else{if(h<c){b=(this.getY()-c)/(this.getX()+this.getWidth()-25-d);if(((h-c)==0)||((h-c)/(l-d))<b){f=this.getX()+this.getWidth();e=this.getY()}else{a=this.getX()+this.getWidth()-25;f=this.getX()+this.getWidth();e=this.getY()+this.getHeight()/2}}else{b=(this.getY()+this.getHeight()-c)/(this.getX()+this.getWidth()-25-d);if(((h-c)==0)||((h-c)/(l-d))<b){a=this.getX()+this.getWidth();n=this.getY()+this.getHeight()/2;f=this.getX()+this.getWidth()-25;e=this.getY()+this.getHeight()}else{n=this.getY()+this.getHeight();f=this.getX()+this.getWidth()-25;e=this.getY()+this.getHeight()}}}return JSGraphic.lineIntersection(a,n,f,e,l,h,g.getX(),g.getY())};SendSignalAction.prototype.calculateSize=function(){if(this._selectedFigure){SendSignalAction.base.calculateSize.call(this);return}if(this._components.length>0){var a;var d=0;var c=0;var b;for(b in this._components){a=this._components[b];if(a.getPosition()==Component.Float||a.getPosition()==Component.BottomLeft||a.getPosition()==Component.BottomRight){c+=a.getHeight();if(a.getWidth()>d){d=a.getWidth()}}}if(this._container){if(c>this._minHeight){this.setMinHeight(c)}if(d>this._minWidth){this.setMinWidth(d+25)}}else{if(c>0){this.setMinHeight(c)}if(d>0){this.setMinWidth(d+25)}}}};SendSignalAction.prototype.updateComponents=function(){if(this._components.length>0){this.calculateSize();this.insertComponents(this._x,this._y,this._width-25,this._height);var a;for(a in this._relations){this._relations[a].notifyChange()}}};SendSignalAction.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};SendSignalAction.prototype.setName=function(a){this._components[1].setValue(a)};SendSignalAction.prototype.getStereotypes=function(){return this._components[0]._childs};SendSignalAction.prototype.getName=function(){return this._components[1].getValue()};SendSignalAction.prototype.getStereotype=function(){return this._components[0]};var SwimlaneLine=function(a){a=a||{};SwimlaneLine.baseConstructor.call(this,a)};JSFun.extend(SwimlaneLine,RegionLine);SwimlaneLine.prototype.draw=function(a){a.save();a.beginPath();if(this._orientation){a.lineWidth=this._width;a.moveTo(this.getPixelX(),this.getPixelY());a.lineTo(this.getPixelX(),this.getPixelY()+this.getHeight())}else{a.lineWidth=this._height;a.moveTo(this.getPixelX(),this.getPixelY());a.lineTo(this.getPixelX()+this.getWidth(),this.getPixelY())}a.stroke();a.restore()};SwimlaneLine.prototype.drawShape=function(d){var b;var e;d.save();d.strokeStyle="#aaaaaa";if(this._parent.getParent()._orientation){d.strokeRect(this.getPixelX()-2,this.getPixelY(),this.getWidth()+4,this.getHeight())}else{d.strokeRect(this.getPixelX(),this.getPixelY()-4,this.getWidth(),this.getHeight()+6)}d.restore();d.save();d.fillStyle="#ff0000";d.beginPath();if(this._parent.getParent()._orientation){d.arc(this._parent.getX()+this._parent.getWidth()-10,this._parent.getY()+this._parent._heightComp+7,4,0,Math.PI*2,true)}else{d.arc(this._parent.getX()+this._parent._widthComp+7,this._parent.getY()+this._parent.getHeight()-10,4,0,Math.PI*2,true)}d.closePath();d.fill();d.restore();var a=this._parent.getParent()._nodeChilds;for(var c=0;c<a.length;c++){if(a[c]==this._parent){break}}d.save();d.fillStyle="#ff0000";d.beginPath();if(this._parent.getParent()._orientation){d.arc(a[c+1].getX()+a[c+1].getWidth()-10,a[c+1].getY()+a[c+1]._heightComp+7,4,0,Math.PI*2,true)}else{d.arc(a[c+1].getX()+a[c+1]._widthComp+7,a[c+1].getY()+a[c+1].getHeight()-10,4,0,Math.PI*2,true)}d.closePath();d.fill();d.restore()};var Swimlane=function(a){a=a||{};Swimlane.baseConstructor.call(this,a);this._type="Swimlane"};JSFun.extend(Swimlane,Region);Swimlane.prototype.addComponents=function(f){var f=(JSFun.isBoolean(f))?f:true;var d=this._parent._nodeChilds;var b=d.length;var c;if(b==0){if(this._parent._orientation){this.setWidth(this._parent._width)}else{this.setHeight(this._parent._height)}}if(this._parent._orientation){if(b>0&&f){d[b-1].setWidth(d[b-1].getWidth()/2);this._x=d[b-1].getX()+d[b-1].getWidth();this.setWidth(this._parent.getX()+this._parent.getWidth()-this._x)}this.addComponent(new StereotypeFields({id:"stereotypes",centered:true}));this.addComponent(new TextBox({id:"name",centered:true,margin:4}));if(b>0){var e=2.5;if(this._parent instanceof HierarchicalSwimlane){var a=this._parent.getHeight()-this._parent._components[0]._height-this._parent._components[1]._height}else{var a=this._parent.getHeight()}d[b-1].addComponent(new SwimlaneLine({id:"region",margin:0,width:e,height:a,position:Component.TopRight,orientation:1}))}}else{if(b>0&&f){d[b-1].setHeight(d[b-1].getHeight()/2);this._y=d[b-1].getY()+d[b-1].getHeight();this.setHeight(this._parent.getY()+this._parent.getHeight()-this._y)}this.addComponent(new StereotypeFields({id:"stereotypes",centered:true,orientation:1}));this.addComponent(new TextBox({id:"name",centered:true,margin:4,orientation:1}));if(b>0){var a=2.5;if(this._parent instanceof HierarchicalSwimlane){var e=this._parent.getWidth()-this._parent._components[0]._width-this._parent._components[1]._width}else{var e=this._parent.getWidth()}d[b-1].addComponent(new SwimlaneLine({id:"region",margin:0,width:e,height:a,position:Component.BottomLeft,orientation:0}))}}};Swimlane.prototype.notifyChange=function(){if(this._parent._orientation){this._heightComp=this._components[0]._height+this._components[1]._height;this._widthComp=0}else{this._heightComp=0;this._widthComp=this._components[0]._width+this._components[1]._width}this._parent.updateSizeComponentSwimlane();Swimlane.base.notifyChange.call(this)};Swimlane.prototype.updateContainer=function(e){if(!(e==false||e==true)){e=true}if(this._container){var n;this._widthComp=this._widthComp||0;this._heightComp=this._heightComp||0;var f=this._x+this._widthComp;var d=this._y+this._heightComp;var c=this._x+this._widthComp;var b=this._y+this._heightComp;var g;var q,p,o,m;for(n in this._nodeChilds){g=this._nodeChilds[n];if(g._visible){o=g._x;m=g._y;q=g._x+g._width;p=g._y+g._height;if(q>c){c=q}if(p>b){b=p}if(o<f){f=o}if(m<d){d=m}}}for(n=this._components.length;n--;){if(this._components[n] instanceof RegionLine){break}}if(n!=-1){if(this.getParent()._orientation){c+=this._components[n]._width+2}else{b+=this._components[n]._height+2}}var h=-1;var r=-1;if(this.getParent()._orientation){if((f<this._x)||(c>(this._x+this._width))){var l;for(n=0;n<this.getParent()._nodeChilds.length;n++){var s=this.getParent()._nodeChilds[n];if((s.getX()+s.getWidth())>f){if(h==-1){h=n}}if((s.getX())<c){r=n}}if((h!=-1)&&(f<this._x)){l=this._x-f+this.getParent().getWidth();this.getParent()._x=this.getParent()._x-(this._x-f);this.getParent().setWidth(l)}if(c>(this._x+this._width)){l=c-this._x-this._width+this.getParent().getWidth();this.getParent().setWidth(l)}}}else{if((d<this._y)||(b>(this._y+this._height))){for(n=0;n<this.getParent()._nodeChilds.length;n++){var s=this.getParent()._nodeChilds[n];if((s.getY()+s.getHeight())>d){if(h==-1){h=n}}if((s.getY())<b){r=n}}var a;if((h!=-1)&&(d<this._y)){a=this._y-d+this.getParent().getHeight();this.getParent()._y=this.getParent()._y-(this._y-d);this.getParent().setHeight(a)}if(b>(this._y+this._height)){a=b-this._y-this._height+this.getParent().getHeight();this.getParent().setHeight(a)}}}if(f<(this._x+this._widthComp)||d<(this._y+this._heightComp)){this.setWidth(this._x+this._widthComp-f+this._width);this.setHeight(this._y+this._heightComp-d+this._height);this._x=f-this._widthComp;this._y=d-this._heightComp;this.setMinWidth(c-this._x);this.setMinHeight(b-this._y)}else{this.setMinWidth(c-this._x);this.setMinHeight(b-this._y)}this._prex=this._x;this._prey=this._y;this.updateComponents();if(this._parent&&e){this._parent.updateContainer()}}};Swimlane.prototype.draw=function(a){if(!this._visible){return}Swimlane.base.draw.call(this,a);a.save();a.lineWidth=2.5;a.strokeStyle=ComponentStyle.component_color;a.beginPath();if(this._parent._orientation){a.moveTo(this._x,this._y+this._heightComp);a.lineTo(this._x+this._width,this._y+this._heightComp)}else{a.moveTo(this._x+this._widthComp,this._y);a.lineTo(this._x+this._widthComp,this._y+this._height)}a.closePath();a.stroke();a.restore()};Swimlane.prototype.getElementXML=function(a){var b=Swimlane.base.getElementXML.call(this,a);b.setAttribute("widthComp",this._widthComp);b.setAttribute("heightComp",this._heightComp);return b};Swimlane.prototype.setElementXML=function(a){Swimlane.base.setElementXML.call(this,a);this._widthComp=parseInt(a.getAttribute("widthComp"));this._heightComp=parseInt(a.getAttribute("heightComp"))};Swimlane.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Swimlane.prototype.setName=function(a){if(this._components[1]){this._components[1].setValue(a)}};Swimlane.prototype.getStereotypes=function(){return this._components[0]._childs};Swimlane.prototype.getName=function(){return this._components[1].getValue()};Swimlane.prototype.getStereotype=function(){return this._components[0]};var SwimlaneItem=function(a){a=a||{};SwimlaneItem.baseConstructor.call(this,a)};JSFun.extend(SwimlaneItem,RegionItem);SwimlaneItem.prototype.createRegion=function(){var b=this.getParent()._components.length;if(this.getParent()._orientation){if(this._parent instanceof HierarchicalSwimlane){var a=this.getParent()._components[0]._height+this.getParent()._components[1]._height}else{var a=0}this.getParent().addRegion(new Swimlane({parent:this.getParent(),y:this.getParent().getY()+a,x:this.getParent().getX()}))}else{if(this._parent instanceof HierarchicalSwimlane){var c=this.getParent()._components[0]._width+this.getParent()._components[1]._width}else{var c=0}this.getParent().addRegion(new Swimlane({parent:this.getParent(),y:this.getParent()._components[b-1]._getY(),x:this.getParent().getX()+c}))}};var TimeEvent=function(a){a=a||{};TimeEvent.baseConstructor.call(this,a)};JSFun.extend(TimeEvent,Rectangular);TimeEvent.prototype.getLinkCentered=function(l,h){if(this._selectedFigure){return TimeEvent.base.getLinkCentered.call(this,l,h)}if(l instanceof Point){h=l.getY();l=l.getX()}var g=this.getCentralPoint();var d=g.getX();var c=g.getY();var a,n,f,e;var b;a=this.getX();n=this.getY();f=g.getX();e=this.getY();if(l<d){if(h<c){b=(this.getY()-c)/(this.getX()-d);if(((h-c)==0)||Math.abs((h-c)/(l-d))<Math.abs(b)){f=this.getX()+this.getWidth()/2-2;e=this.getY()+this.getHeight()/2}else{f=this.getX()+this.getWidth();e=this.getY()}}else{b=(this.getY()+this.getHeight()-c)/(this.getX()-d);if(((h-c)==0)||Math.abs((h-c)/(l-d))<Math.abs(b)){a=this.getX()+this.getWidth()/2-2;n=this.getY()+this.getHeight()/2;f=this.getX();e=this.getY()+this.getHeight()}else{n=this.getY()+this.getHeight();f=this.getX()+this.getWidth();e=this.getY()+this.getHeight()}}}else{if(h<c){b=(this.getY()-c)/(this.getX()+this.getWidth()-d);if(((h-c)==0)||((h-c)/(l-d))<b){f=this.getX()+this.getWidth();e=this.getY()}else{a=this.getX()+this.getWidth();f=this.getX()+this.getWidth()/2+2;e=this.getY()+this.getHeight()/2}}else{b=(this.getY()+this.getHeight()-c)/(this.getX()+this.getWidth()-d);if(((h-c)==0)||((h-c)/(l-d))<b){a=this.getX()+this.getWidth()/2+2;n=this.getY()+this.getHeight()/2;f=this.getX()+this.getWidth();e=this.getY()+this.getHeight()}else{n=this.getY()+this.getHeight();f=this.getX()+this.getWidth();e=this.getY()+this.getHeight()}}}return JSGraphic.lineIntersection(a,n,f,e,l,h,g.getX(),g.getY())};TimeEvent.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};TimeEvent.prototype.setName=function(a){this._components[1].setValue(a)};TimeEvent.prototype.getStereotypes=function(){return this._components[0]._childs};TimeEvent.prototype.getName=function(){return this._components[1].getValue()};TimeEvent.prototype.getStereotype=function(){return this._components[0]};var UnhierarchicalSwimlane=function(a){a=a||{};UnhierarchicalSwimlane.baseConstructor.call(this,a)};JSFun.extend(UnhierarchicalSwimlane,SuperNode);UnhierarchicalSwimlane.prototype.deleteRegion=function(d){var c;var b;if(this._orientation){var e=d.getWidth()}else{var e=d.getHeight()}for(c=0;c<this._nodeChilds.length;c++){if(this._nodeChilds[c]==d){break}}d.deleted();var a=c;if(a==(this._nodeChilds.length)){if(this._nodeChilds[a-1]._components[2]){this._nodeChilds[a-1]._components[2].notifyDelete()}}if(this._orientation){this._minWidth=this.getWidth()-e;this.setWidth(this.getWidth()-e)}else{this._minHeight=this.getHeight()-e;this.setHeight(this.getHeight()-e)}this.notifyChange(true);this.notifyDraw()};UnhierarchicalSwimlane.prototype.notifyChange=function(c,a,b){c=c||false;a=a||false;b=b||false;this.resetSizeComponentSwimlane();this.updateSizeComponentSwimlane();UnhierarchicalSwimlane.base.notifyChange.call(this,c,a,b)};UnhierarchicalSwimlane.prototype.resetSizeComponentSwimlane=function(){var a=this._nodeChilds;for(var b=0;b<a.length;b++){a[b]._heightComp=(this._orientation)?(a[b]._components[0]._height+a[b]._components[1]._height):0;a[b]._widthComp=(this._orientation)?0:(a[b]._components[0]._width+a[b]._components[1]._width)}};UnhierarchicalSwimlane.prototype.updateSizeComponentSwimlane=function(){var b=this._nodeChilds;if(this._orientation){var a=0;for(var c=0;c<b.length;c++){if(b[c]._heightComp>a){a=b[c]._heightComp}}for(var c=0;c<b.length;c++){b[c]._heightComp=a}}else{var a=0;for(var c=0;c<b.length;c++){if(b[c]._widthComp>a){a=b[c]._widthComp}}for(var c=0;c<b.length;c++){b[c]._widthComp=a}}};UnhierarchicalSwimlane.prototype.updateRegions=function(b,h){b=b||false;h=h||false;var e=this._nodeChilds.length;if(this._orientation){var a=0;var g=this.getX();for(var c=0;c<e;c++){var n=this._nodeChilds[c];n.setMinHeight(this._minHeight);n.setHeight(this.getHeight());if(n._components[2] instanceof RegionLine){n._components[2].setHeight(this.getHeight())}}for(c=0;c<e;c++){this._nodeChilds[c]._x=g;this._nodeChilds[c]._y=this.getY();if(c==e-1){if(b||(g+this._nodeChilds[c]._width)<(this.getWidth()+this.getX())){this._nodeChilds[c].setWidth(this.getWidth()+this.getX()-g)}else{this.setWidth(g+this._nodeChilds[c]._width-this.getX())}}g+=this._nodeChilds[c].getWidth()}for(c=0;c<e;c++){var m=this._nodeChilds[c]._x-this._nodeChilds[c]._prex;if(m>0||(m<0&&!h)){for(var d=0;d<this._nodeChilds[c]._nodeChilds.length;d++){this._nodeChilds[c]._nodeChilds[d].updatePosition(m,0,true)}}this._nodeChilds[c].resetMovement()}}else{var l=0;var f=this.getY();for(var c=0;c<e;c++){var n=this._nodeChilds[c];n.setMinWidth(this._minWidth);n.setWidth(this.getWidth());if(n._components[2] instanceof RegionLine){n._components[2].setWidth(this.getWidth())}}for(c=0;c<e;c++){this._nodeChilds[c]._x=this.getX();this._nodeChilds[c]._y=f;if(c==e-1){if(b||(f+this._nodeChilds[c]._height)<(this.getHeight()+this.getY())){this._nodeChilds[c].setHeight(this.getHeight()+this.getY()-f)}else{this.setHeight(f+this._nodeChilds[c]._height-this.getY())}}f+=this._nodeChilds[c].getHeight()}for(c=0;c<e;c++){var m=this._nodeChilds[c]._y-this._nodeChilds[c]._prey;if(m>0||(m<0&&!h)){for(var d=0;d<this._nodeChilds[c]._nodeChilds.length;d++){this._nodeChilds[c]._nodeChilds[d].updatePosition(0,m,true)}}this._nodeChilds[c].resetMovement()}}this.updateComponents();for(c=0;c<this._nodeChilds.length;c++){this._nodeChilds[c].updateComponents()}};UnhierarchicalSwimlane.prototype.select=function(l,h){var c;var g=-1;this.deselectComponent();for(c=0;c<this._nodeChilds.length;c++){if(this._nodeChilds[c]._selected){g=c}this._nodeChilds[c].deselect()}if(this._diagram._activeMenu){this.removeContextualMenu()}if(this._diagram._pressMouse==true){if(this._selected){if(this._moveable&&Math.abs(l-(this._x+this._width+2.5))<=5&&Math.abs(h-(this._y+this._height+2.5))<=5){this._resizing=true;return true}var a=this._nodeChilds;for(c=0;c<a.length-1;c++){if(c==g){if(this._orientation){var n=a[c].getX()+a[c].getWidth()-7;var f=a[c].getY()+a[c]._heightComp+7;var m=a[c+1].getX()+a[c+1].getWidth()-7;var d=a[c+1].getY()+a[c+1]._heightComp+7}else{var b=a[c]._components[0]._width+a[c]._components[1]._width;var n=a[c].getX()+a[c]._widthComp+7;var f=a[c].getY()+a[c].getHeight()-7;var m=a[c+1].getX()+a[c+1]._widthComp+7;var d=a[c+1].getY()+a[c+1].getHeight()-7}var e=this;var p=new Dialog({text:"Do you want to delete the region?",cancelable:true});if(Math.abs(l-(n))<=8&&Math.abs(h-(f))<=8){this._diagram._pressMouse=false;p.show(function(){e.deleteRegion(a[c])});return true}if(Math.abs(l-(m))<=8&&Math.abs(h-(d))<=8){this._diagram._pressMouse=false;p.show(function(){e.deleteRegion(a[c+1])});return true}}}for(c=0;c<this._nodeChilds.length;c++){var o=this._nodeChilds[c];if(o.isOverComponent(l,h)){if(o.isOverRegionLine(l,h)){o.selectComponent(l,h)}else{this._relx=l-this._x;this._rely=h-this._y;this._selectedBefore=true}return true}}if(this.isOverComponent(l,h)){this._relx=l-this._x;this._rely=h-this._y;this._selectedBefore=true;return true}}if(this.isOver(l,h)){this._relx=l-this._x;this._rely=h-this._y;this._selectedBefore=this._selected;this._selected=true;return true}else{return false}}else{if(this._diagram._pressMouseRight==true){if(this.isOver(l,h)){document.oncontextmenu=function(){return false};l=l+this._diagram._div.offsetLeft;h=h+this._diagram._div.offsetTop;this.showContextualMenu(l,h);return true}else{return false}}}};UnhierarchicalSwimlane.prototype.updateContainer=function(e){if(!(e==false||e==true)){e=true}if(this._container){var l;var f=this._x;var d=this._y;var c=this._x;var b=this._y;var h;var o,a,m,g;var n=this._nodeChilds.length;for(l=0;l<n;l++){h=this._nodeChilds[l];if(this._orientation){m=h._x;elemLeftY=h._y;if(l==(n-1)){o=h._x+h._minWidth}else{o=h._x+h._width}elemRigthY=h._y+h._minHeight}else{m=h._x;elemLeftY=h._y;o=h._x+h._minWidth;if(l==(n-1)){elemRigthY=h._y+h._minHeight}else{elemRigthY=h._y+h._height}o=h._x+h._minWidth}if(o>c){c=o}if(elemRigthY>b){b=elemRigthY}if(m<f){f=m}if(elemLeftY<d){d=elemLeftY}}if(f<this._x||d<this._y){this.setWidth(this._x-f+this._width);this.setHeight(this._y-d+this._height);this._x=f;this._y=d;this.setMinWidth(c-this._x);this.setMinHeight(b-this._y)}else{this.setMinWidth(c-this._x);this.setMinHeight(b-this._y)}this._prex=this._x;this._prey=this._y;this.updateComponents();if(this._parent&&e){this._parent.updateContainer()}}};var UMLActivityDiagram=function(b){b=b||{};var a=new ActivityDiagram(b);a.setType("UMLActivityDiagram");a.setName("Activity diagram");setStereotypeObjects(b.stereotypes||[],a);a.setValidElements(["UMLAcceptEventAction","UMLTimeEvent","UMLAction","UMLObject","UMLActivity","UMLFlow","UMLActivityFinal","UMLInitialNode","UMLFlowFinal","UMLDecision_MergeNode","UMLDataStore","UMLFork_JoinNode","UMLSendSignalAction","UMLConnectorActivity","UMLHorizontalSwimlane","UMLVerticalSwimlane","UMLVerticalSwimlane","UMLHorizontalHierarchicalSwimlane","UMLVerticalHierarchicalSwimlane","UMLExceptionHandler","Region","Swimlane","UMLPin","UMLParameterNode","UMLExpansionNode","UMLNote","UMLLine"]);return a};var UMLAcceptEventAction=function(b){var b=b||{};var a=new AcceptEventAction(b);a.setType("UMLAcceptEventAction");setStereotypeProperties(a);a.setMoveable();a.setWidth(100);a.setHeight(55);a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new TextArea({id:"name",centered:true,margin:3}));a.addFigure(new AcceptEventActionFigure({color:"#ffffbb"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLTimeEvent=function(b){var b=b||{};var a=new TimeEvent(b);a.setType("UMLTimeEvent");setStereotypeProperties(a);a.setMoveable();a.setWidth(40);a.setHeight(50);a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));a.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));a.addFigure(new TimeEventFigure({color:"#ffffbb"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLAction=function(b){var b=b||{};var a=new NodeAction(b);a.setType("UMLAction");setStereotypeProperties(a);a.setWidth(100);a.setHeight(50);a.setMoveable();a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new TextArea({id:"name",centered:true,margin:3}));a.addFigure(new RoundedRectangleFigure({color:"#ffffbb"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLActivity=function(b){var b=b||{};var a=new NodeAction(b);a.setType("UMLActivity");setStereotypeProperties(a);a.setWidth(100);a.setHeight(50);a.setMoveable();a.setContainer();a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new TextArea({id:"name",centered:true,margin:3}));a.addFigure(new RoundedRectangleFigure({color:"#ffffbb"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLDataStore=function(b){var b=b||{};var a=new DataStore(b);a.setType("UMLDataStore");setStereotypeProperties(a);a.setWidth(100);a.setHeight(50);a.setMoveable();a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new Text({centered:true,text:"\xABdatastore\xBB",margin:1}));a.addComponent(new DataStoreItem({id:"name",centered:true,margin:3}));a.addFigure(new RectangleFigure({color:"#ffffbb"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLPin=function(b){var b=b||{};var a=new Pin(b);a.setType("UMLPin");setStereotypeProperties(a);a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));a.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));a.addFigure(new RectangleFigure({color:"#ffffbb"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLParameterNode=function(b){var b=b||{};var a=new ParameterNode(b);a.setType("UMLParameterNode");a.setMoveable();setStereotypeProperties(a);a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new TextArea({id:"name",centered:true,margin:3}));a.addFigure(new RectangleFigure({color:"#ffffbb"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLExpansionNode=function(b){var b=b||{};var a=new ExpansionNode(b);a.setType("UMLExpansionNode");setStereotypeProperties(a);a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));a.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));a.addFigure(new ExpansionNodeFigure({color:"#ffffbb"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLObject=function(b){var b=b||{};var a=new ObjectActivity(b);a.setType("UMLObject");setStereotypeProperties(a);a.setWidth(100);a.setHeight(50);a.setMoveable();a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new ObjectItem({id:"name",centered:true,margin:3}));a.addFigure(new RectangleFigure({color:"#ffffbb"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLFlow=function(b){var a=new Flow(b);a.setType("UMLFlow");a.setLine(new SolidLine());a.setEnd(new OpenTip());return a};var UMLActivityFinal=function(b){var a=new Elliptical(b);a.setType("UMLActivityFinal");a.setWidth(16);a.setHeight(16);a.addFigure(new HalfFilledEllipseFigure({color:"#ffffff",changeFigureColor:false}));return a};var UMLInitialNode=function(b){var a=new Elliptical(b);a.setType("UMLInitialNode");a.setWidth(16);a.setHeight(16);a.addFigure(new EllipseFigure({color:"#000000",changeFigureColor:false}));return a};var UMLFlowFinal=function(b){var b=b||{};var a=new FlowFinal(b);a.setType("UMLFlowFinal");setStereotypeProperties(a);a.setWidth(16);a.setHeight(16);a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));a.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));a.addFigure(new CrossEllipseFigure({color:"#ffffff",changeFigureColor:false}));a.setMenu([[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLDecision_MergeNode=function(b){var b=b||{};var a=new Decision_MergeNode(b);a.setType("UMLDecision_MergeNode");setStereotypeProperties(a);a.setMinWidth(35);a.setMinHeight(35);a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));a.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));a.addFigure(new RhombusFigure({color:"#bdd8e5"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLFork_JoinNode=function(b){var a=new NodeForkJoin(b);a.setType("UMLFork_JoinNode");a.setWidth(100);a.setMinWidth(50);a.setHeight(5);a.setMinHeight(5);a.setMoveable();a.addFigure(new RectangleFigure({color:"#000000",changeFigureColor:false}));return a};var UMLSendSignalAction=function(b){var b=b||{};var a=new SendSignalAction(b);a.setType("UMLSendSignalAction");setStereotypeProperties(a);a.setWidth(100);a.setHeight(50);a.setMoveable();a.setContainer();a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new TextBox({id:"name",centered:true,margin:3}));a.addFigure(new SendSignalActionFigure({color:"#ffffbb"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLConnectorActivity=function(b){var b=b||{};var a=new ConnectorActivity(b);a.setType("UMLConnectorActivity");setStereotypeProperties(a);a.setWidth(20);a.setHeight(20);a.setMoveable();a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));a.addComponent(new ConnectorItem({id:"name",centered:true,margin:3,width:20}));a.addFigure(new EllipseFigure({color:"#ffffbb"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLHorizontalSwimlane=function(b){var a=new UnhierarchicalSwimlane(b);a.setType("UMLHorizontalSwimlane");a.setWidth(150);a.setHeight(60);a.setMoveable();a.setContainer();a.addComponent(new SwimlaneItem({id:"addRegion",text:"...",margin:1,position:Component.BottomRight}));a.addFigure(new SwimlaneFigure());if(b.setElementXml){}else{a.addRegion(new Swimlane({parent:a,y:a.getY(),x:a.getX()}));a.addRegion(new Swimlane({parent:a,y:a.getY(),x:a.getX()}))}return a};var UMLVerticalSwimlane=function(b){b=b||{};b.orientation=1;var a=new UnhierarchicalSwimlane(b);a.setType("UMLVerticalSwimlane");a.setWidth(60);a.setHeight(150);a.setMoveable();a.setContainer();a.addComponent(new SwimlaneItem({id:"addRegion",text:"...",margin:1,position:Component.BottomRight}));a.addFigure(new VerticalSwimlaneFigure());if(b.setElementXml){}else{a.addRegion(new Swimlane({parent:a,y:a.getY(),x:a.getX()}));a.addRegion(new Swimlane({parent:a,y:a.getY(),x:a.getX()}))}return a};var UMLHorizontalHierarchicalSwimlane=function(b){var b=b||{};var a=new HierarchicalSwimlane(b);a.setType("UMLHorizontalHierarchicalSwimlane");setStereotypeProperties(a);a.setWidth(150);a.setHeight(60);a.setMoveable();a.setContainer();a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true,orientation:1}));a.addComponent(new TextBox({id:"name",centered:true,margin:3,orientation:1}));a.addComponent(new Separator({id:"separator",centered:true,orientation:1,width:2.5}));a.addComponent(new SwimlaneItem({id:"addRegion",text:"...",margin:1,position:Component.BottomRight}));a.addFigure(new SwimlaneFigure());if(b.setElementXml){}else{a.addRegion(new Swimlane({parent:a,y:a.getY(),x:a.getX()}));a.addRegion(new Swimlane({parent:a,y:a.getY(),x:a.getX()}))}a.setMenu([[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLVerticalHierarchicalSwimlane=function(b){b=b||{};b.orientation=1;var a=new HierarchicalSwimlane(b);a.setType("UMLVerticalHierarchicalSwimlane");setStereotypeProperties(a);a.setWidth(60);a.setHeight(150);a.setMoveable();a.setContainer();a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new TextBox({id:"name",centered:true,margin:3}));a.addComponent(new Separator({id:"separator",centered:true,height:2.5}));a.addComponent(new SwimlaneItem({id:"addRegion",text:"...",margin:1,position:Component.BottomRight}));a.addFigure(new VerticalSwimlaneFigure());if(b.setElementXml){}else{a.addRegion(new Swimlane({parent:a,y:a.getY(),x:a.getX()}));a.addRegion(new Swimlane({parent:a,y:a.getY(),x:a.getX()}))}a.setMenu([[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLExceptionHandler=function(b){var a=new ExceptionHandler(b);a.setType("UMLExceptionHandler");a.addComponentStereotype();a.setComponentName();a.setLine(new SolidLine());a.setEnd(new OpenTip());return a};var Aggregation=function(a){a=a||{};Aggregation.baseConstructor.call(this,a)};JSFun.extend(Aggregation,Relation);Aggregation.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Aggregation.prototype.setName=function(a){this._components[1].setValue(a)};Aggregation.prototype.setRoleA=function(a){this._components[2].setValue(a)};Aggregation.prototype.setRoleB=function(a){this._components[3].setValue(a)};Aggregation.prototype.setMultiplicityA=function(a){this._components[4].setValue(a)};Aggregation.prototype.setMultiplicityB=function(a){this._components[5].setValue(a)};Aggregation.prototype.getStereotypes=function(){return this._components[0]._childs};Aggregation.prototype.getName=function(){return this._components[1].getValue()};Aggregation.prototype.getRoleA=function(){return this._components[2].getValue()};Aggregation.prototype.getRoleB=function(){return this._components[3].getValue()};Aggregation.prototype.getMultiplicityA=function(){return this._components[4].getValue()};Aggregation.prototype.getMultiplicityB=function(){return this._components[5].getValue()};var Association=function(a){a=a||{};Association.baseConstructor.call(this,a)};JSFun.extend(Association,Relation);Association.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Association.prototype.setName=function(a){this._components[1].setValue(a)};Association.prototype.setRoleA=function(a){this._components[2].setValue(a)};Association.prototype.setRoleB=function(a){this._components[3].setValue(a)};Association.prototype.setMultiplicityA=function(a){this._components[4].setValue(a)};Association.prototype.setMultiplicityB=function(a){this._components[5].setValue(a)};Association.prototype.getStereotypes=function(){return this._components[0]._childs};Association.prototype.getName=function(){return this._components[1].getValue()};Association.prototype.getRoleA=function(){return this._components[2].getValue()};Association.prototype.getRoleB=function(){return this._components[3].getValue()};Association.prototype.getMultiplicityA=function(){return this._components[4].getValue()};Association.prototype.getMultiplicityB=function(){return this._components[5].getValue()};var Class=function(a){a=a||{};Class.baseConstructor.call(this,a)};JSFun.extend(Class,Rectangular);Class.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Class.prototype.setName=function(a){this._components[1].setValue(a)};Class.prototype.addAttribute=function(a){var a=a||"";this._components[2].addField(a)};Class.prototype.addOperation=function(a){var a=a||"";this._components[3].addField(a)};Class.prototype.getStereotypes=function(){return this._components[0]._childs};Class.prototype.getName=function(){return this._components[1].getValue()};Class.prototype.getAttributes=function(){return this._components[2]._childs};Class.prototype.getOperations=function(){return this._components[3]._childs};Class.prototype.getStereotype=function(){return this._components[0]};var ClassDiagram=function(a){ClassDiagram.baseConstructor.call(this,a)};JSFun.extend(ClassDiagram,Diagram);ClassDiagram.prototype.setXML=function(b,f){var f=f||[];var e=[];if(this._alone){var a=b.getElementsByTagName(this.getType())[0];if(!a){return false}}else{var a=b}this._name.setValue(a.getAttribute("name"));if(a.getAttribute("backgroundNodes")){this._backgroundNodes=a.getAttribute("backgroundNodes")}this._stereotypes=f;var d=a.childNodes;var c;for(c=0;c<d.length;c++){this._instantiateElements(d[c],e)}for(c=0;c<d.length;c++){this._addElementXML(d[c],e,null)}for(c=0;c<this._relations.length;c++){this._relations[c].notifyChange()}this._sortNodesByArea();return true};var ComponentElement=function(a){a=a||{};ComponentElement.baseConstructor.call(this,a)};JSFun.extend(ComponentElement,Rectangular);ComponentElement.prototype.addStereotype=function(a){var a=a||"";this._components[1].addField("\xAB"+a+"\xBB")};ComponentElement.prototype.setName=function(a){this._components[3].setValue(a)};ComponentElement.prototype.addAttribute=function(a){var a=a||"";this._components[4].addField(a)};ComponentElement.prototype.addOperation=function(a){var a=a||"";this._components[5].addField(a)};ComponentElement.prototype.getStereotypes=function(){return this._components[1]._childs};ComponentElement.prototype.getName=function(){return this._components[3].getValue()};ComponentElement.prototype.getAttributes=function(){return this._components[4]._childs};ComponentElement.prototype.getOperations=function(){return this._components[5]._childs};ComponentElement.prototype.getStereotype=function(){return this._components[1]};var Composition=function(a){a=a||{};Composition.baseConstructor.call(this,a)};JSFun.extend(Composition,Relation);Composition.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Composition.prototype.setName=function(a){this._components[1].setValue(a)};Composition.prototype.setRoleA=function(a){this._components[2].setValue(a)};Composition.prototype.setRoleB=function(a){this._components[3].setValue(a)};Composition.prototype.setMultiplicityA=function(a){this._components[4].setValue(a)};Composition.prototype.setMultiplicityB=function(a){this._components[5].setValue(a)};Composition.prototype.getStereotypes=function(){return this._components[0]._childs};Composition.prototype.getName=function(){return this._components[1].getValue()};Composition.prototype.getRoleA=function(){return this._components[2].getValue()};Composition.prototype.getRoleB=function(){return this._components[3].getValue()};Composition.prototype.getMultiplicityA=function(){return this._components[4].getValue()};Composition.prototype.getMultiplicityB=function(){return this._components[5].getValue()};var Dependency=function(a){a=a||{};Dependency.baseConstructor.call(this,a)};JSFun.extend(Dependency,Relation);Dependency.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Dependency.prototype.setName=function(a){this._components[1].setValue(a)};Dependency.prototype.getStereotypes=function(){return this._components[0]._childs};Dependency.prototype.getName=function(){return this._components[1].getValue()};var Generalization=function(a){a=a||{};Generalization.baseConstructor.call(this,a)};JSFun.extend(Generalization,Relation);Generalization.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Generalization.prototype.setName=function(a){this._components[1].setValue(a)};Generalization.prototype.getStereotypes=function(){return this._components[0]._childs};Generalization.prototype.getName=function(){return this._components[1].getValue()};var InterfaceExtended=function(a){a=a||{};InterfaceExtended.baseConstructor.call(this,a)};JSFun.extend(InterfaceExtended,Rectangular);InterfaceExtended.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};InterfaceExtended.prototype.setName=function(a){this._components[2].setValue(a)};InterfaceExtended.prototype.addAttribute=function(a){var a=a||"";this._components[3].addField(a)};InterfaceExtended.prototype.addOperation=function(a){var a=a||"";this._components[4].addField(a)};InterfaceExtended.prototype.getStereotypes=function(){return this._components[0]._childs};InterfaceExtended.prototype.getName=function(){return this._components[2].getValue()};InterfaceExtended.prototype.getAttributes=function(){return this._components[3]._childs};InterfaceExtended.prototype.getOperations=function(){return this._components[4]._childs};InterfaceExtended.prototype.getStereotype=function(){return this._components[0]};var Package=function(a){a=a||{};Package.baseConstructor.call(this,a)};JSFun.extend(Package,Rectangular);Package.prototype.addStereotype=function(a){var a=a||"";this._components[1].addField("\xAB"+a+"\xBB")};Package.prototype.setName=function(a){this._components[2].setValue(a)};Package.prototype.getStereotypes=function(){return this._components[1]._childs};Package.prototype.getName=function(){return this._components[2].getValue()};Package.prototype.getStereotype=function(){return this._components[1]};var PackageContainer=function(a){a=a||{};PackageContainer.baseConstructor.call(this,a)};JSFun.extend(PackageContainer,Rectangular);PackageContainer.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};PackageContainer.prototype.setName=function(a){this._components[1].setValue(a)};PackageContainer.prototype.getStereotypes=function(){return this._components[0]._childs};PackageContainer.prototype.getName=function(){return this._components[1].getValue()};PackageContainer.prototype.getStereotype=function(){return this._components[0]};var Realization=function(a){a=a||{};Realization.baseConstructor.call(this,a)};JSFun.extend(Realization,Relation);Realization.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Realization.prototype.setName=function(a){this._components[1].setValue(a)};Realization.prototype.getStereotypes=function(){return this._components[0]._childs};Realization.prototype.getName=function(){return this._components[1].getValue()};var UMLClassDiagram=function(b){b=b||{};var a=new ClassDiagram(b);a.setType("UMLClassDiagram");a.setName("Class diagram");setStereotypeObjects(b.stereotypes||[],a);a.setValidElements(["UMLNote","UMLLine","UMLClass","UMLComponent","UMLInterfaceExtended","UMLPackage","UMLPackageContainer","UMLAggregation","UMLAssociation","UMLComposition","UMLDependency","UMLGeneralization","UMLRealization","UMLUsage","UMLPackageMerge","UMLPackagePublicImport","UMLPackagePrivateImport"]);return a};var UMLPackage=function(b){var b=b||{};var a=new Package(b);a.setType("UMLPackage");setStereotypeProperties(a);a.setMoveable();a.setWidth(100);a.setHeight(50);a.addFigure(new PackageFigure({color:"#c0e1c2"}));a.addComponent(new Space({height:16}));a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new TextArea({id:"name",text:"Package name",centered:true,margin:3}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLPackageContainer=function(b){var b=b||{};var a=new PackageContainer(b);a.setType("UMLPackageContainer");setStereotypeProperties(a);a.setWidth(150);a.setHeight(75);a.setMoveable();a.setContainer();a.addFigure(new RectangleFigure({color:"#c0e1c2"}));a.addComponent(new StereotypeTagList({id:"stereotypes"}));a.addComponent(new Tab({id:"name",margin:5,text:"Package name"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLClass=function(b){var b=b||{};var a=new Class(b);a.setType("UMLClass");setStereotypeProperties(a);a.setMoveable();a.addFigure(new RectangleFigure({color:"#ffffbb"}));a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new TextArea({id:"name",text:"ClassName",centered:true,margin:3}));a.addComponent(new AttributeFields({id:"attributes",margin:3}));a.addComponent(new OperationFields({id:"operations",margin:3}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLComponent=function(b){var b=b||{};var a=new ComponentElement(b);a.setType("UMLComponent");setStereotypeProperties(a);a.setMoveable();a.setWidth(150);a.addFigure(new RectangleFigure({color:"#ffffbb"}));a.addComponent(new ComponentSymbol({position:Component.TopRight,margin:3}));a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new Text({text:"\xABcomponent\xBB",centered:true}));a.addComponent(new TextArea({id:"name",text:"Component Name",centered:true,margin:3}));a.addComponent(new AttributeFields({id:"attributes",visibleSubComponents:false,margin:3}));a.addComponent(new OperationFields({id:"operations",visibleSubComponents:false,margin:3}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLInterfaceExtended=function(b){var b=b||{};var a=new InterfaceExtended(b);a.setType("UMLInterfaceExtended");setStereotypeProperties(a);a.setMoveable();a.setWidth(150);a.addFigure(new RectangleFigure({color:"#c0e1c2"}));a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new CircleSymbol({position:Component.TopRight,margin:3}));a.addComponent(new TextArea({id:"name",text:"Interface Name",centered:true,margin:3}));a.addComponent(new AttributeFields({id:"attributes",visibleSubComponents:false,margin:3}));a.addComponent(new OperationFields({id:"methods",visibleSubComponents:false,margin:3}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLAggregation=function(b){var a=new Aggregation(b);a.setType("UMLAggregation");a.addComponentStereotype();a.setComponentName();a.setComponentRoleA();a.setComponentRoleB();a.setComponentMultiplicityA();a.setComponentMultiplicityB();a.setLine(new SolidLine());a.setStart(new AggregationEnd());return a};var UMLAssociation=function(b){var a=new Association(b);a.setType("UMLAssociation");a.addComponentStereotype();a.setComponentName();a.setComponentRoleA();a.setComponentRoleB();a.setComponentMultiplicityA();a.setComponentMultiplicityB();a.setLine(new SolidLine());return a};var UMLComposition=function(b){var a=new Composition(b);a.setType("UMLComposition");a.addComponentStereotype();a.setComponentName();a.setComponentRoleA();a.setComponentRoleB();a.setComponentMultiplicityA();a.setComponentMultiplicityB();a.setLine(new SolidLine());a.setStart(new CompositionEnd());return a};var UMLDependency=function(b){var a=new Dependency(b);a.setType("UMLDependency");a.addComponentStereotype();a.setComponentName();a.setLine(new DashedLine());a.setEnd(new OpenTip());return a};var UMLGeneralization=function(b){var a=new Generalization(b);a.setType("UMLGeneralization");a.addComponentStereotype();a.setComponentName();a.setLine(new SolidLine());a.setEnd(new CloseTip());return a};var UMLRealization=function(b){var a=new Realization(b);a.setType("UMLRealization");a.addComponentStereotype();a.setComponentName();a.setLine(new DashedLine());a.setEnd(new CloseTip());return a};var UMLUsage=function(b){var a=new Relation(b);a.setType("UMLUsage");a.setStereotype("\xABuse\xBB");a.setLine(new DashedLine());a.setEnd(new OpenTip());return a};var UMLPackageMerge=function(b){var a=new Relation(b);a.setType("UMLPackageMerge");a.setStereotype("\xABmerge\xBB");a.setLine(new DashedLine());a.setEnd(new OpenTip());return a};var UMLPackagePublicImport=function(b){var a=new Relation(b);a.setType("UMLPackagePublicImport");a.setStereotype("\xABimport\xBB");a.setLine(new DashedLine());a.setEnd(new OpenTip());return a};var UMLPackagePrivateImport=function(b){var a=new Relation(b);a.setType("UMLPackagePrivateImport");a.setStereotype("\xABaccess\xBB");a.setLine(new DashedLine());a.setEnd(new OpenTip());return a};var ComponentDiagram=function(a){ComponentDiagram.baseConstructor.call(this,a)};JSFun.extend(ComponentDiagram,Diagram);ComponentDiagram.prototype.setXML=function(b,f){var f=f||[];var e=[];if(this._alone){var a=b.getElementsByTagName(this.getType())[0];if(!a){return false}}else{var a=b}this._name.setValue(a.getAttribute("name"));if(a.getAttribute("backgroundNodes")){this._backgroundNodes=a.getAttribute("backgroundNodes")}this._stereotypes=f;var d=a.childNodes;var c;for(c=0;c<d.length;c++){this._instantiateElements(d[c],e)}for(c=0;c<d.length;c++){this._addElementXML(d[c],e,null)}for(c=0;c<this._relations.length;c++){this._relations[c].notifyChange()}this._sortNodesByArea();return true};var ConnectorRelation=function(a){a=a||{};ConnectorRelation.baseConstructor.call(this,a)};JSFun.extend(ConnectorRelation,Relation);ConnectorRelation.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};ConnectorRelation.prototype.setName=function(a){this._components[1].setValue(a)};ConnectorRelation.prototype.getStereotypes=function(){return this._components[0]._childs};ConnectorRelation.prototype.getName=function(){return this._components[1].getValue()};var InterfaceExtended=function(a){a=a||{};InterfaceExtended.baseConstructor.call(this,a)};JSFun.extend(InterfaceExtended,Rectangular);InterfaceExtended.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};InterfaceExtended.prototype.setName=function(a){this._components[2].setValue(a)};InterfaceExtended.prototype.addAttribute=function(a){var a=a||"";this._components[3].addField(a)};InterfaceExtended.prototype.addOperation=function(a){var a=a||"";this._components[4].addField(a)};InterfaceExtended.prototype.getStereotypes=function(){return this._components[0]._childs};InterfaceExtended.prototype.getName=function(){return this._components[2].getValue()};InterfaceExtended.prototype.getAttributes=function(){return this._components[3]._childs};InterfaceExtended.prototype.getOperations=function(){return this._components[4]._childs};InterfaceExtended.prototype.getStereotype=function(){return this._components[0]};var InterfaceRealization=function(a){a=a||{};InterfaceRealization.baseConstructor.call(this,a)};JSFun.extend(InterfaceRealization,Relation);InterfaceRealization.prototype.setName=function(a){this._components[0].setValue(a)};InterfaceRealization.prototype.getName=function(){return this._components[0].getValue()};var InterfaceUsage=function(a){a=a||{};InterfaceUsage.baseConstructor.call(this,a)};JSFun.extend(InterfaceUsage,Relation);InterfaceUsage.prototype.setName=function(a){this._components[0].setValue(a)};InterfaceUsage.prototype.getName=function(){return this._components[0].getValue()};var NodeInterface=function(a){a=a||{};NodeInterface.baseConstructor.call(this,a)};JSFun.extend(NodeInterface,Elliptical);NodeInterface.prototype.draw=function(b){var d=false;var c=false;if(this._relations.length<=0){d=true}var a;for(a in this._relations){if(this._relations[a].getType()=="UMLInterfaceRealization"){c=true;break}}if(d||c){NodeInterface.base.draw.call(this,b)}else{this.drawComponents(b);if(this._selected){this.drawComponentsShape(b)}}};NodeInterface.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};NodeInterface.prototype.setName=function(a){this._components[1].setValue(a)};NodeInterface.prototype.getStereotypes=function(){return this._components[0]._childs};NodeInterface.prototype.getName=function(){return this._components[1].getValue()};NodeInterface.prototype.getStereotype=function(){return this._components[0]};var NodePorts=function(a){a=a||{};NodePorts.baseConstructor.call(this,a);this._ports=[]};JSFun.extend(NodePorts,Node);NodePorts.prototype.addPort=function(a){if(a instanceof Node&&a.getType()=="UMLPort"){this._ports.push(a);this._diagram._addNode(a);a.setParent(this);a.correctPosition()}};NodePorts.prototype.setSelectedFigure=function(b){var a=NodePorts.base.setSelectedFigure.call(this,b);if(a){if(this._figures[b] instanceof FromImageFigure){for(i in this._ports){this._ports[i].setVisibility(false)}}else{for(i in this._ports){this._ports[i].setVisibility(true)}}}};NodePorts.prototype.setVisibility=function(a){NodePorts.base.setVisibility.call(this,a);var b=true;if(this._selectedFigure&&a){b=false}if(this._container&&b){for(i in this._ports){this._ports[i].setVisibility(a)}}};NodePorts.prototype.updatePosition=function(c,a){if(c==undefined&&a==undefined){var e=this.getMovement();var f=e.getX();var d=e.getY()}else{var f=c;var d=a}var b;for(b in this._ports){this._ports[b].updatePosition(f,d)}NodePorts.base.updatePosition.call(this,c,a)};NodePorts.prototype.notifyChange=function(){NodePorts.base.notifyChange.call(this);var a;for(a in this._ports){this._ports[a].correctPosition();this._ports[a].notifyChange()}};NodePorts.prototype.updateContainer=function(){NodePorts.base.updateContainer.call(this);for(i in this._ports){this._ports[i].correctPosition();this._ports[i].notifyChange()}};NodePorts.prototype.deleted=function(){NodePorts.base.deleted.call(this);var a;for(a in this._ports){this._ports[a].deleted()}};NodePorts.prototype.getElementXML=function(b){var c=NodePorts.base.getElementXML.call(this,b);var a;for(a in this._ports){c.appendChild(this._ports[a].getElementXML(b))}return c};NodePorts.prototype.addChild=function(a){if(a instanceof Port){this._ports.push(a);a.setParent(this);a.correctPosition();return}else{NodePorts.base.addChild.call(this,a)}};NodePorts.prototype.notifyDeleted=function(b){if(b instanceof Port){var a;for(a in this._ports){if(this._ports[a]==b){this._ports.splice(a,1)}}}else{NodePorts.base.notifyDeleted.call(this,b)}};NodePorts.prototype.addStereotype=function(a){var a=a||"";this._components[2].addField("\xAB"+a+"\xBB")};NodePorts.prototype.setName=function(a){this._components[3].setValue(a)};NodePorts.prototype.addInterface=function(a){var a=a||"";this._components[4].addField(a)};NodePorts.prototype.addRealization=function(a){var a=a||"";this._components[5].addField(a)};NodePorts.prototype.addArtifact=function(a){var a=a||"";this._components[6].addField(a)};NodePorts.prototype.getStereotypes=function(){return this._components[2]._childs};NodePorts.prototype.getName=function(){return this._components[3].getValue()};NodePorts.prototype.getInterfaces=function(){return this._components[4]._childs};NodePorts.prototype.getRealizations=function(){return this._components[5]._childs};NodePorts.prototype.getArtifacts=function(){return this._components[6]._childs};NodePorts.prototype.getStereotype=function(){return this._components[2]};var Package=function(a){a=a||{};Package.baseConstructor.call(this,a)};JSFun.extend(Package,Rectangular);Package.prototype.addStereotype=function(a){var a=a||"";this._components[1].addField("\xAB"+a+"\xBB")};Package.prototype.setName=function(a){this._components[2].setValue(a)};Package.prototype.getStereotypes=function(){return this._components[1]._childs};Package.prototype.getName=function(){return this._components[2].getValue()};Package.prototype.getStereotype=function(){return this._components[1]};var PackageContainer=function(a){a=a||{};PackageContainer.baseConstructor.call(this,a)};JSFun.extend(PackageContainer,Rectangular);PackageContainer.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};PackageContainer.prototype.setName=function(a){this._components[1].setValue(a)};PackageContainer.prototype.getStereotypes=function(){return this._components[0]._childs};PackageContainer.prototype.getName=function(){return this._components[1].getValue()};PackageContainer.prototype.getStereotype=function(){return this._components[0]};var UMLComponentDiagram=function(b){b=b||{};var a=new ComponentDiagram(b);a.setType("UMLComponentDiagram");a.setName("Component diagram");setStereotypeObjects(b.stereotypes||[],a);a.setValidElements(["UMLNote","UMLLine","UMLComComponent","UMLComposition","UMLInterface","UMLInterfaceExtended","UMLInterfaceUsage","UMLInterfaceRealization","UMLPort","UMLGeneralization","UMLRealization","UMLInterfaceExtended","UMLConnector","UMLPackage","UMLPackageContainer"]);return a};var UMLPackage=function(b){var b=b||{};var a=new Package(b);a.setType("UMLPackage");setStereotypeProperties(a);a.setMoveable();a.setWidth(100);a.setHeight(50);a.addFigure(new PackageFigure({color:"#c0e1c2"}));a.addComponent(new Space({height:16}));a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new TextArea({id:"name",text:"Package name",centered:true,margin:3}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLPackageContainer=function(b){var b=b||{};var a=new PackageContainer(b);a.setType("UMLPackageContainer");setStereotypeProperties(a);a.setWidth(150);a.setHeight(75);a.setMoveable();a.setContainer();a.addFigure(new RectangleFigure({color:"#bdd8e5"}));a.addComponent(new StereotypeTagList({id:"stereotypes"}));a.addComponent(new Tab({id:"name",margin:5,text:"Package name"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLComComponent=function(b){var b=b||{};var a=new NodePorts(b);a.setType("UMLComComponent");setStereotypeProperties(a);a.setContainer();a.setMoveable();a.setWidth(150);a.addFigure(new RectangleFigure({color:"#ffffbb"}));a.addComponent(new ComponentSymbol({position:Component.TopRight,margin:3}));a.addComponent(new Text({text:"\xABcomponent\xBB",centered:true}));a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new TextArea({id:"name",text:"Component Name",centered:true,margin:3}));a.addComponent(new AttributeFields({id:"interfaces",text:"new_interface",visibleSubComponents:false,margin:3}));a.addComponent(new AttributeFields({id:"realizations",text:"new_realization",visibleSubComponents:false,margin:3}));a.addComponent(new AttributeFields({id:"artifacts",text:"new_artifact",visibleSubComponents:false,margin:3}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLInterface=function(b){var b=b||{};var a=new NodeInterface(b);a.setType("UMLInterface");setStereotypeProperties(a);a.setWidth(16);a.setHeight(16);a.addFigure(new EllipseFigure({color:"#67ac88"}));a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));a.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLInterfaceExtended=function(b){var b=b||{};var a=new InterfaceExtended(b);a.setType("UMLInterfaceExtended");setStereotypeProperties(a);a.setMoveable();a.setWidth(150);a.addFigure(new RectangleFigure({color:"#c0e1c2"}));a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new CircleSymbol({position:Component.TopRight,margin:3}));a.addComponent(new TextArea({id:"name",text:"Interface Name",centered:true,margin:3}));a.addComponent(new AttributeFields({id:"attributes",visibleSubComponents:false,margin:3}));a.addComponent(new OperationFields({id:"methods",visibleSubComponents:false,margin:3}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLInterfaceUsage=function(b){var a=new InterfaceUsage(b);a.setType("UMLInterfaceUsage");a.setComponentName();a.setLine(new SolidLine());a.setEnd(new InterfaceUsage());return a};var UMLInterfaceRealization=function(b){var a=new InterfaceRealization(b);a.setType("UMLInterfaceRealization");a.setComponentName();a.setLine(new SolidLine());return a};var UMLConnector=function(b){var a=new ConnectorRelation(b);a.setType("UMLConnector");a.addComponentStereotype();a.setComponentName();a.setLine(new SolidLine());return a};var UMLPort=function(b){var b=b||{};var a=new Port(b);a.setType("UMLPort");setStereotypeProperties(a);a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var Line=function(a){a=a||{};Line.baseConstructor.call(this,a)};JSFun.extend(Line,Relation);Line.prototype.draw=function(b){var c=this._points.length;if(this._line){this._line.draw(b,this._points,"#4f4f4f")}if(this._selected>=0){var a;for(a=0;a<this._points.length;a++){b.fillRect(parseInt(this._points[a].getX())-3,parseInt(this._points[a].pixelY())-3,6,6)}}if(this._selected>-1){this._drawComponentsShape(b)}this._drawComponents(b)};var Note=function(a){a=a||{};Note.baseConstructor.call(this,a)};JSFun.extend(Note,Rectangular);Note.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Note.prototype.setName=function(a){this._components[1].setValue(a)};Note.prototype.getStereotypes=function(){return this._components[0]._childs};Note.prototype.getName=function(){return this._components[1].getValue()};var UMLNote=function(b){var a=new Note(b);a.setType("UMLNote");a.setMoveable();a.setWidth(100);a.setHeight(50);a.addFigure(new NoteFigure({color:"#ffffbb"}));a.addComponent(new StereotypeFields({id:"stereotypes",centered:true}));a.addComponent(new TextArea({id:"description",text:"Note",centered:true,margin:5}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"]]);return a};var UMLLine=function(b){var a=new Line(b);a.setType("UMLLine");a.setLine(new DashedLine());return a};var Extension=function(a){a=a||{};Extension.baseConstructor.call(this,a)};JSFun.extend(Extension,Relation);Extension.prototype.setElements=function(b,a){if(!((b instanceof Stereotype&&a instanceof Metaclass)||(a instanceof Stereotype&&b instanceof Metaclass))){return}if(b instanceof Element&&a instanceof Element){if(b instanceof Relation&&a instanceof Relation){return false}if(this._elemA){this._elemA.delRelation(this)}if(this._elemB){this._elemB.delRelation(this)}this._elemA=(b instanceof Stereotype)?b:a;this._elemB=(a instanceof Metaclass)?a:b;this._elemA.addRelation(this);this._elemB.addRelation(this);this.updateParent();this._calculateLineEnds();return true}else{return false}};Extension.prototype.setElementA=function(a){if(a.getType()=="UMLStereotype"){Extension.base.setElementA.call(this,a)}};Extension.prototype.setElementB=function(a){if(a.getType()=="UMLMetaclass"){Extension.base.setElementB.call(this,a)}};var Metaclass=function(a){a=a||{};Metaclass.baseConstructor.call(this,a);this._stereotypes=[]};JSFun.extend(Metaclass,Rectangular);Metaclass.prototype.setName=function(a){this._components[1].setValue(a)};Metaclass.prototype.addRelation=function(a){Metaclass.base.addRelation.call(this,a);this._stereotypes.push(a._elemA);a._elemA._metaclass.push(this)};Metaclass.prototype.delRelation=function(a){Metaclass.base.delRelation.call(this,a);a._elemA.delMetaclass(this);this.delStereotype(a._elemA)};Metaclass.prototype.deleted=function(){var a=this._relations;for(var b=0;b<a.length;b++){a[b]._elemA.delMetaclass(this)}Metaclass.base.deleted.call(this)};Metaclass.prototype.notifyDeleted=function(a){var b;for(b in this._relations){if(this._relations[b]==a){this.delStereotype(a._elemA);a._elemA.delMetaclass(this);this._relations.splice(b,1)}}};Metaclass.prototype.delStereotype=function(a){var b;for(b in this._stereotypes){if(this._stereotypes[b]==a){this._stereotypes.splice(b,1);break}}};Metaclass.prototype.getName=function(){for(var a=0;a<this._diagram._validMetaclassApp.length;a++){if(this._diagram._validMetaclassApp[a][0]==this._components[1].getValue()){return this._diagram._validMetaclassApp[a][1]}}};var MetaclassItem=function(a){a=a||{};MetaclassItem.baseConstructor.call(this,a)};JSFun.extend(MetaclassItem,TextBox);MetaclassItem.prototype.setText=function(e){if(JSFun.isString(e)){if(this._text!=e){var f=(this._parent)?this._parent._diagram._diagrams:[];var b=[];for(var d in f){b=f[d]._nodes;for(var c=0;c<b.length;c++){if(b[c]._stereotypeProperties&&this._parent){for(var a=0;a<this._parent._stereotypes.length;a++){b[c]._stereotypeProperties.removeStereotype(this._parent._stereotypes[a])}}}}}StereotypeTag.base.setText.call(this,e)}};MetaclassItem.prototype.showDialog=function(){if(this.active){return}var f=this;this.active=true;var a=document.createElement("div");var b=document.createElement("form");var d=document.createElement("input");var h=document.createElement("input");a.className="ud_popup";var c;d=document.createElement("select");c=document.createElement("option");c.setAttribute("value","Metaclass name");c.appendChild(document.createTextNode("none"));d.appendChild(c);var g=this._parent._diagram._validMetaclassApp;for(var e=0;e<g.length;e++){c=document.createElement("option");c.setAttribute("value",g[e][0]);c.appendChild(document.createTextNode(g[e][0]));if(this._parent.getName()==g[e][1]){c.setAttribute("selected","selected")}d.appendChild(c)}h.setAttribute("type","submit");h.setAttribute("value","ok");this.changeText=function(m){if(f.active){f.setText(f.encode(d.value));document.body.removeChild(a);f.active=false;f.notifyChange()}};this.closeDialog=function(m){if(f.active){document.body.removeChild(a);f.active=false;f.notifyChange()}};b.onsubmit=function(){return false};h.addEventListener("click",this.changeText,false);b.appendChild(d);b.appendChild(h);if(this.deletable){var l=document.createElement("input");l.setAttribute("type","submit");l.setAttribute("value","delete");this.deleteDialog=function(m){if(f.active){document.body.removeChild(a);f.active=false;f.notifyDelete();f.notifyChange()}};l.addEventListener("click",this.deleteDialog,false);b.appendChild(l)}a.appendChild(b);document.body.appendChild(a);d.focus();a.style.top=(window.innerHeight-b.offsetHeight)/2+"px";a.style.left=(window.innerWidth-b.offsetWidth)/2+"px"};var ProfileDiagram=function(a){a=a||{};ProfileDiagram.baseConstructor.call(this,a);this._visible=true;this.setValidMetaclass(a.validMetaclass||[]);this.setDiagrams(a.diagrams||[])};JSFun.extend(ProfileDiagram,Diagram);ProfileDiagram.prototype.setValidMetaclass=function(b){if(!JSFun.isArray(b)){return}this._validMetaclassLibrary=["UMLActor","UMLUseCase","UMLUseCaseExtended","UMLSystem","UMLSubSystem","UMLLine","UMLClass","UMLComponent","UMLInterfaceExtended","UMLPackage","UMLPackageContainer","UMLComComponent","UMLInterface","UMLLifeline","UMLOption","UMLAlternative","UMLLoop","UMLBreak","UMLAcceptEventAction","UMLTimeEvent","UMLSendSignalAction","UMLAction","UMLObject","UMLActivity","UMLDataStore","UMLConnectorActivity","UMLHorizontalHierarchicalSwimlane","UMLVerticalHierarchicalSwimlane","UMLSimpleState","UMLCompositeState","UMLVerticalRegion","UMLPin","UMLParameterNode","UMLExpansionNode","UMLHorizontalRegion","UMLPort","UMLTerminate","UMLEntryPoint","UMLExitPoint","UMLJunction","UMLFlowFinal"];this._validMetaclassApp=[];for(var a=0;a<b.length;a++){if(JSFun.isArray(b[a])&&b[a].length==2){if(this.foundInArray(this._validMetaclassLibrary,b[a][1])){this._validMetaclassApp.push(b[a])}}}this._validMetaclassApp=this._sortNamesMetaclass(this._validMetaclassApp)};ProfileDiagram.prototype._sortNamesMetaclass=function(a){a.sort(function(d,c){if(d[0]<c[0]){return -1}else{if(d[0]>c[0]){return 1}else{return 0}}});return a};ProfileDiagram.prototype.setDiagrams=function(a){this._diagrams=a};ProfileDiagram.prototype.foundInArray=function(c,b){for(var a=0;a<c.length;a++){if(b==c[a]){return true}}return false};ProfileDiagram.prototype.draw=function(){if(this._visible){ProfileDiagram.base.draw.call(this)}};ProfileDiagram.prototype.interaction=function(a){var a=(!this._visible)?false:a;ProfileDiagram.base.interaction.call(this,a)};ProfileDiagram.prototype.updateProfile=function(e){var b;var c=[];for(b=0;b<this._nodes.length;b++){if(this._nodes[b].getType()=="UMLMetaclass"){c.push(this._nodes[b])}}var a;var d=false;for(b=0;b<e.length;b++){a=e[b]._nodes;for(j=0;j<a.length;j++){if(a[j]._stereotypeProperties){a[j]._stereotypeProperties.updateElementStereotypes()}}}};ProfileDiagram.prototype.removeProfile=function(e){if(!e){return}var b;var c=[];for(b=0;b<this._nodes.length;b++){if(this._nodes[b].getType()=="UMLStereotype"){c.push(this._nodes[b])}}var a;var d=false;for(b=0;b<e.length;b++){a=e[b]._nodes;for(j=0;j<a.length;j++){if(a[j]._stereotypeProperties){for(k=0;k<c.length;k++){a[j]._stereotypeProperties.removeStereotype(c[k])}}}}};ProfileDiagram.prototype.setXML=function(b,d,c){d=d||[];c=c||[];ProfileDiagram.base.setXML.call(this,b);if(this._alone){var a=b.getElementsByTagName(this.getType())[0];if(!a){return false}}else{var a=b}if(a.getAttribute("visible")=="false"){this._visible=false}this.setDiagrams(d);this.setValidMetaclass(c)};ProfileDiagram.prototype.getXML=function(b){var a=ProfileDiagram.base.getXML.call(this,b);a.setAttribute("visible",this._visible);return a};ProfileDiagram.prototype.getElements=function(){var c=[];var b=[];for(var a=0;a<this._nodes.length;a++){if(this._nodes[a].getType()=="UMLMetaclass"){c.push(this._nodes[a])}else{if(this._nodes[a].getType()=="UMLStereotype"){b.push(this._nodes[a])}}}return[c,b]};var SrcItem=function(a){a=a||{};SrcItem.baseConstructor.call(this,a);this._parse=/^path(?:\:\/([a-zA-Z\:\_\.\/\\0-9 ]*))?$/;this.setMinWidth(50)};JSFun.extend(SrcItem,TextBox);SrcItem.prototype.encode=function(a){var b="";if(a[0]){b+="path:/"+a[0]}if(this._parse.exec(b)){return b}else{return"no icon "}};SrcItem.prototype.decode=function(b){var a=this._parse.exec(b);if(a){a.shift();return a}else{return[]}};SrcItem.prototype.showDialog=function(){if(this.active){return}var c=this;this.active=true;var a=document.createElement("div");var b=document.createElement("form");var e=document.createElement("input");var d=document.createElement("input");d.setAttribute("type","submit");d.setAttribute("value","ok");a.className="ud_popup";var g=this.decode(this.getValue());e.setAttribute("type","text");e.setAttribute("value",g[0]||"");this.changeText=function(n){if(c.active){var m=[];m.push(e.value);c.setText(c.encode(m));document.body.removeChild(a);c.active=false;c.notifyChange()}};this.closeDialog=function(m){if(c.active){document.body.removeChild(a);c.active=false;c.notifyChange()}};b.onsubmit=function(){return false};d.addEventListener("click",this.changeText,false);var f;var l;l=document.createElement("div");f=document.createElement("label");f.appendChild(document.createTextNode("Icon path (absolute path)"));l.appendChild(f);l.appendChild(e);b.appendChild(l);b.appendChild(d);if(this.deletable){var h=document.createElement("input");h.setAttribute("type","submit");h.setAttribute("value","delete");this.deleteDialog=function(m){if(c.active){document.body.removeChild(a);c.active=false;c.notifyDelete();c.notifyChange()}};h.addEventListener("click",this.deleteDialog,false);b.appendChild(h)}a.appendChild(b);document.body.appendChild(a);e.focus();a.style.top=(window.innerHeight-b.offsetHeight)/2+"px";a.style.left=(window.innerWidth-b.offsetWidth)/2+"px"};SrcItem.prototype.setText=function(f){if(JSFun.isString(f)){var g=(this._text!=f)?true:false;this._text=f;var e="";if(g){var h=(this._parent)?this._parent._diagram._diagrams:[];var b=[];for(var d in h){b=h[d]._nodes;for(var c=0;c<b.length;c++){if(b[c]._stereotypeProperties&&this._parent){if(this._parent._validMetaclass(b[c].getType())){e=b[c]._stereotypeProperties._shownStereotype;b[c]._stereotypeProperties.removeFigure(this._parent);if(e=="\xAB"+this._parent.getName()+"\xBB"){b[c]._stereotypeProperties.drawStereotype(this._parent)}}}}}}var a=(this._text.length>20)?20:this._text.length;if(f==""){if(this._orientation){this.setHeight(50)}else{this.setWidth(50)}}else{if(this._orientation){this.setHeight(a*ComponentStyle.font_width)}else{this.setWidth(a*ComponentStyle.font_width)}}if(this._orientation){this.setWidth(ComponentStyle.line_height)}else{this.setHeight(ComponentStyle.line_height)}}if(this._parent){this._parent.notifyDraw()}};SrcItem.prototype.draw=function(a){if(!this._visible){return}a.save();if(this.active){a.fillStyle="#ffc485";a.fillRect(this.getPixelX(),this.getPixelY(),this.getWidth(),this.getHeight())}a.restore();a.save();a.font=ComponentStyle.font_size+" monospace";a.textBaseline="middle";a.fillStyle=ComponentStyle.text_color;var b=this._text;if(b.length>20){b=b.substring(0,17);b+="..."}if(this._orientation){a.translate(this._getMX()+ComponentStyle.line_height/2,this._getMY());a.rotate((-90*Math.PI)/180);a.fillText(b,this._margin*2-this.getHeight(),0)}else{a.fillText(b,this._getMX(),this._getMY()+ComponentStyle.line_height/2)}a.restore()};var Stereotype=function(a){a=a||{};Stereotype.baseConstructor.call(this,a);this._metaclass=[]};JSFun.extend(Stereotype,Rectangular);Stereotype.prototype.addRelation=function(a){Stereotype.base.addRelation.call(this,a)};Stereotype.prototype.delRelation=function(a){Stereotype.base.delRelation.call(this,a);a._elemB.delStereotype(this);this.delMetaclass(a._elemB)};Stereotype.prototype.deleted=function(){var a=this._relations;for(var b=0;b<a.length;b++){a[b]._elemB.delStereotype(this)}Stereotype.base.deleted.call(this)};Stereotype.prototype.setName=function(a){this._components[1].setValue(a)};Stereotype.prototype.addTagValue=function(a){var a=a||"";this._components[3].addField(a)};Stereotype.prototype.setPath=function(a){this._components[4].setValue("path:/"+a)};Stereotype.prototype.getName=function(){return this._components[1].getValue()};Stereotype.prototype.getTagValues=function(){var b=this._components[3]._childs;var c=[];for(var a=0;a<b.length;a++){c.push(b[a].getValue())}return c};Stereotype.prototype.getPath=function(){return this._components[4].getValue().substring(5)};Stereotype.prototype._validMetaclass=function(b){for(var a=this._metaclass.length;a--;){if(this._metaclass[a].getName()==b){return true}}return false};Stereotype.prototype.delMetaclass=function(c){var b,a;var d=this._diagram._diagrams;for(b in d){for(var a=0;a<d[b]._nodes.length;a++){if(d[b]._nodes[a].getType()==c.getName()&&d[b]._nodes[a]._stereotypeProperties){d[b]._nodes[a]._stereotypeProperties.removeStereotype(this)}}}for(b in this._metaclass){if(this._metaclass[b]==c){this._metaclass.splice(b,1);break}}};var StereotypeNameItem=function(a){a=a||{};StereotypeNameItem.baseConstructor.call(this,a)};JSFun.extend(StereotypeNameItem,TextBox);StereotypeNameItem.prototype.setText=function(d){if(JSFun.isString(d)){if(this._text!=d){var e=(this._parent)?this._parent._diagram._diagrams:[];var a=[];for(var c in e){a=e[c]._nodes;for(var b=0;b<a.length;b++){if(a[b]._stereotypeProperties&&this._parent){if(this._parent._validMetaclass(a[b].getType())){a[b]._stereotypeProperties.changeNameStereotype(this._parent,"\xAB"+d+"\xBB")}}}}}StereotypeNameItem.base.setText.call(this,d)}};var TagValueItem=function(b){b=b||{};TagValueItem.baseConstructor.call(this,b);var a="^([a-zA-Z_0-9]*)?(?::([a-zA-Z_0-9]*))?$";this._parse=new RegExp(a);this.setMinWidth(40)};JSFun.extend(TagValueItem,TextBox);TagValueItem.prototype.encode=function(a){var b="";if(a[0]){b+=a[0]}if(a[1]){b+=":"+a[1]}if(this._parse.exec(b)){return b}else{return"wrong_attribute"}};TagValueItem.prototype.decode=function(b){var a=this._parse.exec(b);if(a){a.shift();return a}else{return[]}};TagValueItem.prototype.getNameTagValue=function(){return this.decode(this._text)[0]};TagValueItem.prototype.getDefaultValue=function(){return this.decode(this._text)[1]};TagValueItem.prototype.showDialog=function(){if(this.active){return}var f=this;this.active=true;var a=document.createElement("div");var b=document.createElement("form");var e=[];var c;a.className="ud_popup";for(c=0;c<2;c++){e.push(document.createElement("input"))}var g=document.createElement("input");g.setAttribute("type","submit");g.setAttribute("value","ok");var l=this.decode(this.getValue());for(c=0;c<e.length;c++){e[c].setAttribute("type","text");e[c].setAttribute("value",l[c]||"")}this.changeText=function(q){if(f.active){var o=[];var p;for(p=0;p<e.length;p++){o.push(e[p].value)}f.setText(f.encode(o));document.body.removeChild(a);f.active=false;f.notifyChange()}};this.closeDialog=function(o){if(f.active){document.body.removeChild(a);f.active=false;f.notifyChange()}};b.onsubmit=function(){return false};g.addEventListener("click",this.changeText,false);var d=["tag value","default value"];var h;var n;for(c=0;c<e.length;c++){n=document.createElement("div");h=document.createElement("label");h.appendChild(document.createTextNode(d[c]));n.appendChild(h);n.appendChild(e[c]);b.appendChild(n)}b.appendChild(g);if(this.deletable){var m=document.createElement("input");m.setAttribute("type","submit");m.setAttribute("value","delete");this.deleteDialog=function(o){if(f.active){document.body.removeChild(a);f.active=false;f.notifyDelete();f.notifyChange()}};m.addEventListener("click",this.deleteDialog,false);b.appendChild(m)}a.appendChild(b);document.body.appendChild(a);a.style.top=(window.innerHeight-b.offsetHeight)/2+"px";a.style.left=(window.innerWidth-b.offsetWidth)/2+"px"};TagValueItem.prototype.select=function(a,b){if(Math.abs(a-(this.getPixelX()+this.getSuperWidth()-20))<=5&&Math.abs(b-(this.getPixelY()+8.66))<=5){this.notifyToUp();this.notifyChange();return true}else{if(Math.abs(a-(this.getPixelX()+this.getSuperWidth()-30))<=5&&Math.abs(b-(this.getPixelY()+7.33))<=5){this.notifyToDown();this.notifyChange();return true}}return TagValueItem.base.select.call(this,a,b)};TagValueItem.prototype.drawShape=function(b){var a=this.getPixelX()+this.getSuperWidth()-35;var c=this.getPixelY()+3;b.save();b.fillStyle="#0000aa";b.beginPath();b.moveTo(a,c);b.lineTo(a+10,c);b.lineTo(a+5,c+7);b.closePath();b.fill();a=a+10;b.beginPath();b.moveTo(a+5,c);b.lineTo(a,c+7);b.lineTo(a+10,c+7);b.closePath();b.fill();b.restore()};var TagValueFields=function(a){a=a||{};TagValueFields.baseConstructor.call(this,a);this._default=a.text||"new_attribute"};JSFun.extend(TagValueFields,CollapsibleFields);TagValueFields.prototype.newItem=function(){return new TagValueItem({text:this._default})};var UMLProfile=function(b){var a=new ProfileDiagram(b);a.setType("UMLProfile");a.setName("Profile");a.setValidElements(["UMLNote","UMLLine","UMLMetaclass","UMLExtension","UMLStereotype"]);return a};var UMLMetaclass=function(b){var a=new Metaclass(b);a.setType("UMLMetaclass");a.setMoveable();a.setWidth(80);a.setHeight(30);a.addFigure(new RectangleFigure({color:"#c0e1c2"}));a.addComponent(new StereotypeItem({id:"stereotype",text:"\xABmetaclass\xBB",selected:true,centered:true}));a.addComponent(new MetaclassItem({id:"name",text:"MetaClass name",centered:true,margin:3}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"]]);return a};var UMLStereotype=function(b){var a=new Stereotype(b);a.setType("UMLStereotype");a.setWidth(100);a.setHeight(40);a.setMoveable();a.addFigure(new RectangleFigure({color:"#c0e1c2"}));a.addComponent(new StereotypeItem({id:"stereotype",text:"\xABstereotype\xBB",selected:true,centered:true}));a.addComponent(new StereotypeNameItem({id:"name",text:"stereotype name",centered:true}));a.addComponent(new Separator({id:"separator",centered:true}));a.addComponent(new TagValueFields({id:"attributes",margin:3}));a.addComponent(new SrcItem({id:"src",text:"path:/",margin:3}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"]]);return a};var UMLExtension=function(b){var a=new Extension(b);a.setType("UMLExtension");a.setLine(new SolidLine());a.setEnd(new CloseTip({color:"#000000"}));return a};var Alternative=function(a){a=a||{};Alternative.baseConstructor.call(this,a)};JSFun.extend(Alternative,SuperNode);Alternative.prototype.drop=function(l,h){var d,c;if(this._moved){if(!this._alone){this._diagram.checkForParent(this)}var m=this._diagram._relations;var b=[];var e=[];var g=[];for(d=0;d<m.length;d++){if(this.isOverBeforePosition(m[d].getCentralPoint())&&m[d] instanceof Message){e.push(m[d].getCentralPoint());b.push(m[d])}}if(b.length){b=b[0]._sortRelByDistanceToLimitY(b)}for(d=0;d<b.length;d++){if(!b[d]._moved){b[d]._y=b[d]._y+(h-this._rely-this._prey);if(b[d]._y<b[d]._limitY){b[d]._y=b[d]._limitY}b[d]._moved=true;b[d]._calculateLineEnds(2)}}for(c=0;c<b.length;c++){var f=b[c]._sortAscendant(b[c].descendantMessages());for(d=0;d<f.length;d++){f[d]._moved=false;if(f[d]._objA){f[d]._objA.resetMovement()}if(f[d]._objB){f[d]._objB.resetMovement()}f[d].notifyChange()}}for(d=0;d<b.length;d++){b[d].updateRelatedLifeline()}if(b.length){b[0].updateDeleteMessages()}}Interaction.base.drop.call(this,l,h);var a=this._diagram._nodes;for(d=0;d<a.length;d++){if(a[d] instanceof Lifeline){a[d].updateLength()}}this._moved=false;this._resizing=false};Alternative.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Alternative.prototype.setName=function(a){this._components[1].setValue(a)};Alternative.prototype.getStereotypes=function(){return this._components[0]._childs};Alternative.prototype.getName=function(){return this._components[1].getValue()};Alternative.prototype.getStereotype=function(){return this._components[0]};var TimeInterval=function(a){a=a||{};TimeInterval.baseConstructor.call(this,a);this.setType("TimeInterval");this.setMoveable();this.setWidth(10);this.setMinHeight(30);this.setHeight(a.height||1);this.addFigure(new RectangleFigure({color:"#ffffff",changeFigureColor:false}))};JSFun.extend(TimeInterval,Rectangular);TimeInterval.prototype.drag=function(b,c){if(this._resizing){var a=c-this.getY();this.setHeight(a)}};TimeInterval.prototype.drop=function(a,b){if(this._moved){if(!this._alone){this._diagram.checkForParent(this)}this.updatePosition();if(this._parent){this._parent.updateContainer()}}else{if(this._resizing){this._message.notifyChange();this.notifyChange()}else{if(this._selectedBefore){this.selectComponent(a,b)}}}this._message.updateDeleteMessages();this._moved=false;this._resizing=false};TimeInterval.prototype.setMessage=function(a){if(a instanceof Message){this._message=a}else{this._message=null}};TimeInterval.prototype.getLineX=function(a){return this.getX()+this.getWidth()/2+(a*this.getWidth()/2)};TimeInterval.prototype.updateLength=function(){var e;var a=0;var b;var f;for(e in this._relations){if(this._relations[e]._elemA==this._relations[e]._elemB){f=this._relations[e].getY()+100}else{if(this._relations[e]._elemB==this){var c=(this._relations[e]._objB==0)?30:0;var f=this._relations[e].getY()+c}else{var d=(this._relations[e]._objA==0)?30:0;var f=this._relations[e].getY()+d}}if((this._relations[e] instanceof Message)&&f>a){a=f;b=this._relations[e]}}if(b){a=a-this._y;this.setMinHeight(a)}else{this.setMinHeight(30)}};TimeInterval.prototype.addRelation=function(a,b){var b=(JSFun.isNumber(b))?b:0;if(a._elemA==this&&a._objA&&(b==1||b==0)){a._objA.deleted();a._objA=0}if(a._elemB==this&&a._objB&&(b==2||b==0)){a._objB.deleted();a._objB=0}a.updateLimitY();if(a._y<a._limitY){a._y=a._limitY}if(!b){Lifeline.base.addRelation.call(this,a)}};TimeInterval.prototype.delRelation=function(a,c){var c=(JSFun.isNumber(c))?c:0;if(a._elemA==this&&a._objA==0&&(c==1||c==0)){a.setObjA(new TimeInterval());a._objA.setDiagram(a._diagram);a._diagram._addNode(a._objA)}if(a._elemB==this&&a._objB==0&&(c==2||c==0)){a.setObjB(new TimeInterval());a._objB.setDiagram(a._diagram);a._diagram._addNode(a._objB)}a._limitY=this._message._limitY;var b=this._diagram._nodes;for(var d=0;d<b.length;d++){if(b[d].getType()=="UMLLifeline"){b[d].updateLength()}}if(!c){TimeInterval.base.delRelation.call(this,a)}this.updateLength()};var SequenceDiagram=function(a){SequenceDiagram.baseConstructor.call(this,a)};JSFun.extend(SequenceDiagram,Diagram);SequenceDiagram.prototype._addNode=function(a){if(a instanceof Lifeline){a.setDiagram(this);a.updateLength()}SequenceDiagram.base._addNode.call(this,a)};SequenceDiagram.prototype._addRelation=function(a){if(a instanceof Message){a.setDiagram(this);if(a._elemA instanceof TimeInterval&&a._objA){a._objA.deleted();a._objA=0}if(a._elemB instanceof TimeInterval&&a._objB){a._objB.deleted();a._objB=0}this._relations.push(a);a.updateDeleteMessages();a.notifyChange()}else{SequenceDiagram.base._addRelation.call(this,a)}};SequenceDiagram.prototype.checkForParent=function(a){if((a instanceof Node)&&!(a instanceof Lifeline)&&!(a instanceof TimeInterval)){SequenceDiagram.base.checkForParent.call(this,a)}};SequenceDiagram.prototype.getXML=function(a){return SequenceDiagram.base.getXML.call(this,a)};SequenceDiagram.prototype._sortNodesByArea=function(){this._nodes.sort(function(e,c){var f=e.getArea();var d=c.getArea();if((e.getType()=="UMLLifeline"&&c.getType()!="TimeInterval")||(e.getType()!="TimeInterval"&&c.getType()=="UMLLifeline")){if(e.getType()=="UMLLifeline"){return -1}else{return 1}}else{if(f<d){return -1}else{if(f==d){return 0}else{return 1}}}})};SequenceDiagram.prototype._addElementOnly=function(a){if(a instanceof Node){a.setDiagram(this);this._nodes.push(a)}else{if(a instanceof Relation){a._diagram=this;this._relations.push(a)}}};SequenceDiagram.prototype._instantiateObjectFromString=function(elemName,parent){if(JSFun.isString(elemName)){parent=parent||null;var i;for(i in this._validElements){if(elemName==this._validElements[i]){if(elemName=="UMLAlternative"||elemName=="UMLCreate"||elemName=="UMLDestroy"||elemName=="UMLSendMessage"||elemName=="UMLCallMessage"||elemName=="UMLDeleteMessage"||elemName=="UMLReplyMessage"){var setElementXml=true;return eval("new "+this._validElements[i]+"({ setElementXml: "+setElementXml+"})")}else{if(parent){return(new window[this._validElements[i]]({addComponent:false,parent:parent}))}else{return eval("new "+this._validElements[i]+"()")}}}}}else{return null}};SequenceDiagram.prototype.setXML=function(b,f){var f=f||[];var e=[];if(this._alone){var a=b.getElementsByTagName(this.getType())[0];if(!a){return false}}else{var a=b}this._name.setValue(a.getAttribute("name"));if(a.getAttribute("backgroundNodes")){this._backgroundNodes=a.getAttribute("backgroundNodes")}this._stereotypes=f;var d=a.childNodes;var c;for(c=0;c<d.length;c++){this._instantiateElements(d[c],e)}for(c=0;c<d.length;c++){this._addElementXML(d[c],e,null)}for(c=0;c<this._relations.length;c++){this._relations[c].notifyChange()}this._sortNodesByArea();return true};var Message=function(a){a=a||{};this._y=a.y||0;this._limitY=0;this._objA=null;this._objB=null;Message.baseConstructor.call(this,a)};JSFun.extend(Message,Relation);Message.prototype.getElementXML=function(a){var b=Message.base.getElementXML.call(this,a);b.setAttribute("y",this._y);if(this._objA){b.setAttribute("a",this._objA.getId())}else{b.setAttribute("a",this._objA)}if(this._objB){b.setAttribute("b",this._objB.getId())}else{b.setAttribute("b",this._objB)}return b};Message.prototype.setElementXML=function(f,e){Message.base.setElementXML.call(this,f,e);this._y=parseInt(f.getAttribute("y"));var d=f.getAttribute("a");var b=f.getAttribute("b");var c=parseInt(d);if(JSFun.isNumber(c)){d=c}else{if(d=="null"){d=null}}var a=parseInt(b);if(JSFun.isNumber(a)){b=a}else{if(b=="null"){b=null}}if(d){this.setObjA(e[d])}else{this._objA=d}if(b){this.setObjB(e[b])}else{this._objB=b}};Message.prototype.setElements=function(b,a){this._points[0]=new Point();this._points[1]=new Point();if(b instanceof Element&&a instanceof Element){if(b instanceof Relation&&a instanceof Relation){return false}if(this._elemA&&this._elemA!=this._elemB){this._elemA.delRelation(this)}if(this._elemB){this._elemB.delRelation(this)}this._elemA=b;this._elemB=a;this._elemA.addRelation(this);if(b!=a){this._elemB.addRelation(this)}else{this._elemB.addRelation(this,2)}this.updateParent();this._calculateLineEnds();return true}else{return false}};Message.prototype.setElementA=function(a){if(a&&(a.getType()=="UMLLifeline"||a.getType()=="TimeInterval")){if(a instanceof Relation&&this._elemB instanceof Relation){return false}if(this._elemA){if(this._elemA!=this._elemB){this._elemA.delRelation(this)}else{this._elemA.delRelation(this,1)}}this._elemA=a;if(this._elemA!=this._elemB){this._elemA.addRelation(this)}else{this._elemA.addRelation(this,1)}this.updateParent();return true}else{return false}};Message.prototype.setElementB=function(a){if(a&&(a.getType()=="UMLLifeline"||a.getType()=="TimeInterval")){if(a instanceof Relation&&this._elemA instanceof Relation){return false}if(this._elemB){if(this._elemA!=this._elemB){this._elemB.delRelation(this)}else{this._elemB.delRelation(this,2)}}this._elemB=a;if(this._elemA!=this._elemB){this._elemB.addRelation(this)}else{this._elemB.addRelation(this,2)}this.updateParent();return true}else{return false}};Message.prototype.setLimitY=function(a){this._limitY=a};Message.prototype.getY=function(){return this._y};Message.prototype.select=function(a,c){this._deselectComponent();for(b=0;b<this._points.length;b++){if(Math.abs(a-this._points[b].getX())<=4&&Math.abs(c-this._points[b].getY())<=4){if(this._selected>-1){this._selectedBefore=true}this._selected=b;this._selectedPoint=true;return true}}if(this._selected>-1){if(this._isOverComponent(a,c)){this._selectedBefore=true;return true}}for(var b=0;b<this._points.length-1;b++){if(this._selectLine(this._points[b],this._points[b+1],a,c)){if(this._selected>-1){this._selectedBefore=true}this._selected=b;this._selectedLine=true;if(this._elemA==this._elemB){this._movementLine=c-this._points[0]._y}return true}}return false};Message.prototype.drag=function(a,c){if(this._selectedLine){var b;if(this._elemA==this._elemB){c-=this._movementLine}if(c>this._limitY){this._y=c}else{this._y=this._limitY}this._moved=true}else{if(this._selectedPoint){this._points[this._selected].setX(a);this._moved=true}}};Message.prototype.drop=function(a,b){if(this._moved){this._checkForNewNodes(a,b)}else{if(this._selectedBefore){this._selectComponent(a,b)}}this._selectedLine=false;this._selectedPoint=false;this._delUselessPoints();this.notifyChange();this.updateDeleteMessages();this.updateRelatedLifeline();this._moved=false};Message.prototype.updateRelatedLifeline=function(){var b=this.descendantMessages();for(var a=0;a<b.length;a++){if(b[a] instanceof CreateMessage){b[a]._elemB.updatePosition()}}};Message.prototype._checkForNewNodes=function(a,c){if(this._selectedPoint&&(this._selected==0||this._selected==this._points.length-1)){var b=this._diagram.reassignRelationTo(this,a,c);if(b!=this&&b!=this._objA&&b!=this._objB){if(this._selected==0){this.setElementA(b)}else{this.setElementB(b)}}}};Message.prototype.updateDeleteMessages=function(){var b=0;var c=[];var a=this._diagram._nodes;for(b=a.length;b--;){if((a[b] instanceof Lifeline)){c.push(a[b])}}c.sort(function(e,d){var g=e.getDelete();var f=d.getDelete();if(g<f){return -1}else{if(g==f){return 0}else{return 1}}});for(b=0;b<c.length;b++){c[b].updateDelete()}};Message.prototype._calculateLineEnds=function(m){var m=(m==false||m==0||m)?m:1;var d;if(!this._selectedPoint&&this._elemA&&this._elemB){if((this._y>=this._elemA.getY())&&(this._y<=(this._elemA.getY()+this._heightSmallRectangle))){this._y=this._elemA.getY()+this._heightSmallRectangle}var g=this;var n=function(q){if(q instanceof Lifeline){return q.getLineX()}else{if(q instanceof TimeInterval){if(q==g._elemA){if(q._x>g._elemB._x){return q.getLineX(-1)}else{return q.getLineX(1)}}else{if(q._x>g._elemA._x){return q.getLineX(-1)}else{return q.getLineX(1)}}}}};if(m==1){this.updateLimitY();if(this._y<this._limitY){this._y=this._limitY}}if(this._elemA==this._elemB){var o=(this._objA)?(this._objA.getHeight()+20):50;this._points[0].setPoint(n(this._elemA),this._y);this._points[1]=new Point(n(this._elemB)+50,this._y);this._points[2]=new Point(n(this._elemB)+50,this._y+o);this._points[3]=new Point(n(this._elemB),this._y+o)}else{this._points[0].setPoint(n(this._elemA),this._y);this._points[1].setPoint(n(this._elemB),this._y);while(this._points[2]){this._points.pop()}}if(m){this.updateObjects();var a;var p=[];if(m==1){this._moved=true}if(this._objA||(this._elemA instanceof TimeInterval&&this._objB)){var e=[];var l=(this._objA)?this._objA:this._elemA;if(this._objA){e=l._relations}else{for(var c=0;c<this._elemA._relations.length;c++){if(this._elemA._relations[c]._elemA==this._elemA._relations[c]._elemB){e.push(this._elemA._relations[c])}}}for(d=0;d<e.length;d++){if(!e[d]._moved){if(this._objA){a=(this._objA._y-this._objA._prey)}else{a=(this._objB)?(this._objB._y-this._objB._prey):0}e[d]._y=e[d]._y+a;e[d]._moved=true;e[d]._calculateLineEnds((!m)?m:2);e[d]._updateComponents()}}}if(this._objB||(this._elemB instanceof TimeInterval&&this._objA)){var b=[];var h=(this._objB)?this._objB:this._elemB;if(this._objB){b=h._relations}else{for(var c=0;c<this._elemB._relations.length;c++){if(this._elemB._relations[c]._elemA==this._elemB._relations[c]._elemB){b.push(this._elemB._relations[c])}}}for(d=0;d<b.length;d++){if(!b[d]._moved){if(this._objB){a=(this._objB)?(this._objB._y-this._objB._prey):(this._objA._y-this._objA._prey)}else{a=(this._objA)?(this._objA._y-this._objA._prey):0}b[d]._y=b[d]._y+a;b[d]._moved=true;b[d]._calculateLineEnds((!m)?m:2);b[d]._updateComponents()}}}if(m!=2){if(this._objA){this._objA.resetMovement()}if(this._objB){this._objB.resetMovement()}var f=this._sortAscendant(this.descendantMessages());for(d=0;d<f.length;d++){f[d]._moved=false;if(f[d]._objA){f[d]._objA.resetMovement()}if(f[d]._objB){f[d]._objB.resetMovement()}f[d].updateLimitY();if(f[d]._y<f[d]._limitY){f[d]._y=f[d]._limitY;f[d]._calculateLineEnds()}}}}}};Message.prototype.descendantMessages=function(b){var b=b||[];var a;if(!this.foundInArray(b)){b.push(this)}if(this._objA){for(a=0;a<this._objA._relations.length;a++){b=this._objA._relations[a].descendantMessages(b)}}else{if(this._elemA&&this._objB){for(a=0;a<this._elemA._relations.length;a++){if(this._elemA._relations[a]._elemA==this._elemA._relations[a]._elemB){b=this._elemA._relations[a].descendantMessages(b)}}}}if(this._objB){for(a=0;a<this._objB._relations.length;a++){b=this._objB._relations[a].descendantMessages(b)}}else{if(this._elemB&&this._objA){for(a=0;a<this._elemB._relations.length;a++){if(this._elemB._relations[a]._elemA==this._elemB._relations[a]._elemB){b=this._elemB._relations[a].descendantMessages(b)}}}}return b};Message.prototype._sortRelByCreateMessages=function(a,b){if(!(b==1||b==-1)){return a}a.sort(function(d,c){if(d instanceof CreateMessage&&c instanceof CreateMessage){if(d._y>c._y){return -1}else{return 1}}else{if(d instanceof CreateMessage&&!(c instanceof CreateMessage)){return b}else{if(!(d instanceof CreateMessage)&&c instanceof CreateMessage){return -b}else{return 0}}}});return a};Message.prototype._sortRelByDistanceToLimitY=function(a){a.sort(function(d,c){var f=d._y-d._limitY;var e=c._y-c._limitY;if(f>e){return -1}else{if(f<e){return 1}else{return 0}}});return a};Message.prototype._sortAscendant=function(a){a.sort(function(d,c){if(d._y>c._y){return 1}else{if(d._y<c._y){return -1}else{return 0}}});return a};Message.prototype.updateLimitY=function(){var b=0;var a=0;if(this._elemA){b=(this._elemA instanceof Lifeline)?(this._elemA.getY()+this._elemA._heightSmallRectangle+5):(this._elemA.getY()+5)}if(this._elemB){a=(this._elemB instanceof Lifeline)?(this._elemB.getY()+this._elemB._heightSmallRectangle+5):(this._elemB.getY()+5)}if(b>a||this instanceof CreateMessage){this.setLimitY(b)}else{this.setLimitY(a)}};Message.prototype.foundInArray=function(b){for(var a=b.length;a--;){if(b[a]==this){return true}}return false};Message.prototype.notifyChange=function(){var b;var a=(this._elemA._diagram)?this._elemA._diagram._nodes:[];Message.base.notifyChange.call(this);for(b=0;b<a.length;b++){if(((a[b].getType()=="UMLLifeline")&&!(a[b]._delete))||((a[b].getType()=="UMLLifeline")&&(a[b]._delete)&&((a[b]==this._elemA)||(a[b]==this._elemB)))||(a[b].getType()=="TimeInterval")){a[b].updateLength()}}};Message.prototype.deleted=function(){Message.base.deleted.call(this);if(this instanceof DeleteMessage){this._elemB.setDelete(0)}if(this._objA){this._objA.deleted()}if(this._objB){this._objB.deleted()}this.notifyChange()};Message.prototype.setObjA=function(a){this._objA=a;this._objA.setMessage(this);this.updateObjects()};Message.prototype.setObjB=function(a){this._objB=a;this._objB.setMessage(this);this.updateObjects()};Message.prototype.setDiagram=function(a){Message.base.setDiagram.call(this,a);if(this._objA){a._addNode(this._objA)}if(this._objB){a._addNode(this._objB)}};Message.prototype.updateObjects=function(){if(this._objA){this._objA.setPosition(this._points[0].getX()-this._objA.getWidth()/2,this._points[0].getY())}if(this._objB){if(this._elemA==this._elemB){this._objB.setPosition(this._points[3].getX()-this._objB.getWidth()/2,this._points[3].getY())}else{this._objB.setPosition(this._points[1].getX()-this._objB.getWidth()/2,this._points[1].getY())}}};Message.prototype.resetMovementObjects=function(){if(this._objA){this._objA.resetMovement()}if(this._objB){this._objB.resetMovement()}};Message.prototype._updateComponents=function(){if(!(this._elemA&&this._elemB)){return}var c=this._points[0].getX();var b=this._points[0].getY();var e=this._points[1].getX();var d=this._points[1].getY();if(this._elemA==this._elemB&&this._points.length==4){e=this._points[2].getX();d=this._points[2].getY()}var a=(c+e)/2;var f=(b+d)/2;if(this._name){if(this._elemA==this._elemB){this._name.setCoordinates(e,f-this._name.getHeight()/2)}else{this._name.setCoordinates(a-this._name.getWidth()/2,f-this._name.getHeight())}}if(this._stereotype){if(this._name){if(this._elemA==this._elemB){this._stereotype.setCoordinates(e,f-this._stereotype.getHeight()-this._name.getHeight()/2)}else{this._stereotype.setCoordinates(a-this._stereotype.getWidth()/2,f-this._stereotype.getHeight()-this._name.getHeight())}}else{if(this._elemA==this._elemB){this._stereotype.setCoordinates(e,f-(this._stereotype.getHeight())/2)}else{this._stereotype.setCoordinates(a-this._stereotype.getWidth()/2,f-this._stereotype.getHeight())}}if(this._stereotype instanceof SuperComponent){this._stereotype.updateComponents()}}};Message.prototype.drawShape=function(b){if(!(this._selectedPoint&&this._selected==0||this._selected==this._points.length-1)){this._calculateLineEnds(0)}b.save();b.lineWidth=2;b.strokeStyle=RelationStyle.shape_color;b.beginPath();b.moveTo(this._points[0].pixelX(),this._points[0].pixelY());var a;for(var a=1;a<this._points.length;a++){b.lineTo(this._points[a].pixelX(),this._points[a].pixelY())}b.stroke();b.restore()};var CallMessage=function(a){a=a||{};CallMessage.baseConstructor.call(this,a)};JSFun.extend(CallMessage,Message);CallMessage.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};CallMessage.prototype.setName=function(a){this._components[1].setValue(a)};CallMessage.prototype.getStereotypes=function(){return this._components[0]._childs};CallMessage.prototype.getName=function(){return this._components[1].getValue()};var CreateMessage=function(a){a=a||{};CreateMessage.baseConstructor.call(this,a)};JSFun.extend(CreateMessage,Message);CreateMessage.prototype.setElementXML=function(b,a){CreateMessage.base.setElementXML.call(this,b,a);this._elemB.setCreate(this._y);this._elemA.updatePosition();this._elemB.updatePosition()};CreateMessage.prototype.setElements=function(d,b){CreateMessage.base.setElements.call(this,d,b);var a;if(this._elemB){this._elemB.updatePosition()}var c=this.descendantsCreateMessages();for(a=0;a<c.length;a++){c[a].updatePosition()}};CreateMessage.prototype.deleted=function(){CreateMessage.base.deleted.call(this);this._elemB.setPosition(this._elemB.getX(),70);this._elemB.updatePosition();this._elemB.setCreate(0);if(this._elemA){this._elemA.updateLength()}if(this._elemB){this._elemB.updateLength()}var a=this._elemB._relations;for(var b=0;b<a.length;b++){if(a[b]._elemA._y>a[b]._elemB._y||a[b] instanceof CreateMessage){a[b].setLimitY(a[b]._elemA.getY()+a[b]._elemA._heightSmallRectangle+5)}else{a[b].setLimitY(a[b]._elemB.getY()+a[b]._elemB._heightSmallRectangle+5)}}};CreateMessage.prototype.drop=function(a,d){CreateMessage.base.drop.call(this,a,d);this._elemB.updatePosition();var c=this.descendantsCreateMessages();for(var b=0;b<c.length;b++){c[b].updatePosition()}};CreateMessage.prototype._calculateLineEnds=function(h){var h=(h==0||h)?h:1;var e;var c;if(!(!this._selectedPoint&&this._elemA&&this._elemB)||this._elemA==this._elemB){return}var m=this._sortRelByCreateMessages(this._elemB._relations,1);var g=[];var d,b,a;if((this._y>=this._elemA.getY())&&(this._y<=(this._elemA.getY()+this._heightSmallRectangle))){this._y=this._elemA.getY()+this._heightSmallRectangle}if(h==1){this.updateLimitY();if(this._y<this._limitY){this._y=this._limitY}}this._points[0].setPoint(this._elemA.getLineX((this._elemA._x>this._elemB._x)?-1:1),this._y);if(this._elemB.getX()>this._elemA.getX()){this._points[1].setPoint(this._elemB.getX(),this._y)}else{this._points[1].setPoint(this._elemB.getX()+this._elemB.getWidth(),this._y)}this._elemB._y=this._y-this._elemB._heightSmallRectangle/2;if(h){if(h==1){this._moved=true}for(d=0;d<m.length;d++){if(!m[d]._moved){m[d]._y=m[d]._y+this._y-this._elemB.getCreate();m[d].setLimitY(this._y+this._elemB._heightSmallRectangle/2+5);if(m[d]._limitY>m[d]._y){m[d]._y=m[d]._limitY}m[d]._moved=true;m[d]._calculateLineEnds((!h)?h:2);m[d]._updateComponents();if(m[d] instanceof DeleteMessage){m[d]._elemB.setDelete(m[d]._y)}}}this._elemB.setCreate(this._y);if(this._elemB.getCreate()!=0){for(d=0;d<m.length;d++){if(m[d]._y<this._elemB.getCreate()&&!(m[d]._elemA instanceof TimeInterval)&&!(m[d]._elemB instanceof TimeInterval)){var l=m[d]._y;m[d]._points[0].setY(l+this._elemB.getCreate()-this._elemA.getY());m[d]._points[1].setY(l+this._elemB.getCreate()-this._elemA.getY());m[d]._y=l+this._elemB.getCreate()-this._elemA.getY();m[d].setLimitY(this._y+this._elemB._heightSmallRectangle/2+5);if(m[d]._limitY>m[d]._y){m[d]._y=m[d]._limitY}m[d]._updateComponents();m[d].updateObjects();m[d].notifyChange()}}}if(h==1){var f=this._sortAscendant(this.descendantMessages());for(d=0;d<f.length;d++){f[d]._moved=false;if(f[d]._objA){f[d]._objA.resetMovement()}if(f[d]._objB){f[d]._objB.resetMovement()}f[d].updateLimitY();if(f[d]._y<f[d]._limitY){f[d]._y=f[d]._limitY;f[d]._calculateLineEnds()}}}this.updateObjects()}};CreateMessage.prototype.descendantMessages=function(b){var b=b||[];if(!this.foundInArray(b)){b.push(this)}if(this._elemB){for(var a=0;a<this._elemB._relations.length;a++){if(this._elemB._relations[a]!=this){b=this._elemB._relations[a].descendantMessages(b)}}}return b};CreateMessage.prototype.drag=function(a,c){if(this._selectedLine){var b;if(c>this._limitY){this._y=c}else{this._y=this._limitY}this._moved=true}else{if(this._selectedPoint){}}};CreateMessage.prototype.descendantsCreateMessages=function(){if(!this._elemB){return[]}var a=this._elemB._relations;var d;var c;var f=[];var h=[];var e=false;for(d=0;d<a.length;d++){if((a[d] instanceof CreateMessage)&&(a[d]._elemA==this._elemB)&&(a[d]._elemA!=a[d]._elemB)){e=false;for(c=0;c<f.length&&!e;c++){if(f[c]==a[d]._elemB){e=true}}if(!e){f.push(a[d]._elemB);h=a[d].descendantsCreateMessages();for(c=0;c<h.length;c++){f.push(h[c])}}}else{if(a[d]._elemA==this){var g=(a[d]._objA)?a[d]._objA._relations:[]}else{var g=(a[d]._objB)?a[d]._objB._relations:[]}for(c=0;c<g.length;c++){if((g[c] instanceof CreateMessage)){f.push(g[c]._elemB);h=g[c].descendantsCreateMessages();for(var b=0;b<h.length;b++){f.push(h[b])}}}}}return f};var DeleteMessage=function(a){a=a||{};DeleteMessage.baseConstructor.call(this,a)};JSFun.extend(DeleteMessage,Message);DeleteMessage.prototype._checkForNewNodes=function(a,c){if(this._selectedPoint&&(this._selected==0||this._selected==this._points.length-1)){var b=this._diagram.reassignRelationTo(this,a,c);if(b){if(this._selected==0){if(b!=this._elemB&&b!=this._objA&&((b.getType()=="UMLLifeline"&&!b.getDelete())||b.getType()=="TimeInterval")){this.setElementA(b)}}else{if(b!=this._elemA&&b.getType()=="UMLLifeline"&&!b.getDelete()){this.setElementB(b)}}this.notifyChange()}}};DeleteMessage.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};DeleteMessage.prototype.setName=function(a){this._components[1].setValue(a)};DeleteMessage.prototype.getStereotypes=function(){return this._components[0]._childs};DeleteMessage.prototype.getName=function(){return this._components[1].getValue()};var Interaction=function(a){a=a||{};Interaction.baseConstructor.call(this,a)};JSFun.extend(Interaction,Rectangular);Interaction.prototype.drop=function(l,h){var d,c;if(this._moved){if(!this._alone){this._diagram.checkForParent(this)}var m=this._diagram._relations;var b=[];var e=[];var g=[];for(d=0;d<m.length;d++){if(this.isOverBeforePosition(m[d].getCentralPoint())&&m[d] instanceof Message){e.push(m[d].getCentralPoint());b.push(m[d])}}if(b.length){b=b[0]._sortRelByDistanceToLimitY(b)}for(d=0;d<b.length;d++){if(!b[d]._moved){b[d]._y=b[d]._y+(h-this._rely-this._prey);if(b[d]._y<b[d]._limitY){b[d]._y=b[d]._limitY}b[d]._moved=true;b[d]._calculateLineEnds(2)}}for(c=0;c<b.length;c++){var f=b[c]._sortAscendant(b[c].descendantMessages());for(d=0;d<f.length;d++){f[d]._moved=false;if(f[d]._objA){f[d]._objA.resetMovement()}if(f[d]._objB){f[d]._objB.resetMovement()}f[d].notifyChange()}}for(d=0;d<b.length;d++){b[d].updateRelatedLifeline()}if(b.length){b[0].updateDeleteMessages()}}Interaction.base.drop.call(this,l,h);var a=this._diagram._nodes;for(d=0;d<a.length;d++){if(a[d] instanceof Lifeline){a[d].updateLength()}}this._moved=false;this._resizing=false};Interaction.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Interaction.prototype.setName=function(a){this._components[1].setValue(a)};Interaction.prototype.setGuard=function(a){if(this._components[2]){this._components[2].setValue("["+a+"]")}};Interaction.prototype.getStereotypes=function(){return this._components[0]._childs};Interaction.prototype.getName=function(){return this._components[1].getValue()};Interaction.prototype.getGuard=function(){var b=this._components[2].getValue();var a=(this._components[2])?b.substring(1,b.length-1):null;return a};Interaction.prototype.getStereotype=function(){return this._components[0]};var Lifeline=function(a){a=a||{};Lifeline.baseConstructor.call(this,a);this._delete=0;this._create=0;this._limitY=-1;this.setHeightSmallRectangle(a.heightSmallRectangle||25)};JSFun.extend(Lifeline,Rectangular);Lifeline.prototype.setHeightSmallRectangle=function(a){this._heightSmallRectangle=a};Lifeline.prototype.isOver=function(a,b){if(a instanceof Point){b=a.getY();a=a.getX()}if((a>=this._x&&a<=this._x+this._width&&b>=this._y&&b<=this._y+this._heightSmallRectangle)||(a>=(this.getLineX()-5)&&a<=(this.getLineX()+5)&&b>=(this._y+this._heightSmallRectangle)&&b<=(this._y+this._height))){return true}return false};Lifeline.prototype.notifyChange=function(){var e;var f=[];var b,a;var d=this._heightSmallRectangle;this.setHeightSmallRectangle(this._components[0].getHeight()+this._components[1].getHeight());var c=this._heightSmallRectangle-d;for(b=0;b<this._relations.length;b++){if(!(this._relations[b] instanceof CreateMessage)||((this._relations[b] instanceof CreateMessage)&&(this._relations[b]._elemA==this))){if(c){if(!(this._relations[b] instanceof CreateMessage)){if(this._relations[b]._elemA==this){if((this._relations[b]._elemB._y+this._relations[b]._elemB._heightSmallRectangle+5)<(this._y+this._heightSmallRectangle+5)){this._relations[b].setLimitY(this._y+this._heightSmallRectangle+5)}else{this._relations[b].setLimitY(this._relations[b]._elemB._y+this._relations[b]._elemB._heightSmallRectangle+5)}}else{if((this._relations[b]._elemA._y+this._relations[b]._elemA._heightSmallRectangle+5)<(this._y+this._heightSmallRectangle+5)){this._relations[b].setLimitY(this._y+this._heightSmallRectangle+5)}else{this._relations[b].setLimitY(this._relations[b]._elemA._y+this._relations[b]._elemA._heightSmallRectangle+5)}}}else{this._relations[b].setLimitY(this._y+this._heightSmallRectangle+5)}}if(this._relations[b]._y<(this._y+this._heightSmallRectangle+5)){this._relations[b]._y+=c;this._relations[b].notifyChange();if(this._relations[b] instanceof CreateMessage){this._relations[b]._elemB.updatePosition();e=this._relations[b].descendantsCreateMessages();for(a=0;a<e.length;a++){e[a].updatePosition()}}else{this._relations[b].updateRelatedLifeline()}}}if(c&&this._relations[b] instanceof CreateMessage&&(this._relations[b]._elemB==this)){this._relations[b].notifyChange()}if(c){this.resetMovement()}}if(c&&this._relations.length){this._relations[0].updateDeleteMessages()}if(this._container){this.updateContainer()}else{this.updateComponents();if(this._parent){this._parent.updateContainer()}}this.setWidth((this._minWidth>60)?this._minWidth:60);this.updateComponents()};Lifeline.prototype.getLineX=function(){return this.getX()+this.getWidth()/2};Lifeline.prototype.drag=function(a,c){if(!this.resizing&&this._selected){var b=a-this._relx;this.setPosition(b,this.getY());this._moved=true}else{Lifeline.base.drag.call(this,a,c)}};Lifeline.prototype.updateDelete=function(){if(!this._delete){return}var b,a;var n;var f;var h=20;var g,d;var o=this._relations;var m=0;var l;for(g=0;g<o.length;g++){if(o[g] instanceof Message){if(!(o[g] instanceof DeleteMessage)||(o[g] instanceof DeleteMessage&&o[g]._elemB!=this)){f=o[g].getY();if(o[g]._elemA==o[g]._elemB){f+=(o[g]._objA)?(o[g]._objA.getHeight()+20):50;n=(o[g]._objB)?o[g]._objB.getHeight():0}else{b=(o[g]._objA)?o[g]._objA.getHeight():0;a=(o[g]._objB)?o[g]._objB.getHeight():0;if(b>a){n=b}else{n=a}}if((f+n+h)>m){m=f+n+h}if(o[g]._objA){var e=o[g]._objA._relations;for(d=0;d<e.length;d++){f=e[d].getY();b=(e[d]._objA)?e[d]._objA.getHeight():0;a=(e[d]._objB)?e[d]._objB.getHeight():0;if(b>a){n=b}else{n=a}if((f+n+h)>m){m=f+n+h}}}if(o[g]._objB){var c=o[g]._objB._relations;for(d=0;d<c.length;d++){f=c[d].getY();b=(c[d]._objA)?c[d]._objA.getHeight():0;a=(c[d]._objB)?c[d]._objB.getHeight():0;if(b>a){n=b}else{n=a}if((f+n+h)>m){m=f+n+h}}}}else{l=o[g]}}}if(l._y<m){this._delete=m}else{this._delete=l._y}l._y=this._delete;l.notifyChange()};Lifeline.prototype.updateLength=function(){var e;var g=0;if(this._delete){for(e in this._relations){if((this._relations[e] instanceof Message)&&this._relations[e].getY()>g){g=this._relations[e].getY()}}}else{var l=this._diagram._relations;var a=this._diagram._nodes;var c,b;var d;var h=0;var f;for(e=0;e<l.length;e++){if(l[e] instanceof Message){d=l[e].getY();if(l[e]._elemA==l[e]._elemB){d+=(l[e]._objA)?(l[e]._objA.getHeight()+20):50;h=(l[e]._objB)?l[e]._objB.getHeight():0}else{c=(l[e]._objA)?l[e]._objA.getHeight():0;b=(l[e]._objB)?l[e]._objB.getHeight():0;if(c>b){h=c}else{h=b}}if((d+h)>g){g=d+h;f=l[e]}}}for(e=0;e<a.length;e++){if((a[e] instanceof Alternative)||(a[e] instanceof Interaction)){if((a[e].getY()+a[e]._height)>g){g=a[e].getY()+a[e]._height;f=null}}}}g=g-this.getY();if(g<=0){g=200}if(g<this._heightSmallRectangle+60&&!this._delete){g=this._heightSmallRectangle+60}if(f&&f instanceof CreateMessage){if(f._elemB==this){if(!f._elemA.getDelete()){if((f._elemA.getY()+f._elemA.getHeight())<(this.getY()+g+60)){f._elemA.setHeight(this.getY()+g+60-f._elemA.getY())}}}else{f._elemB.updateLength();if((f._elemB.getY()+f._elemB.getHeight())>(this.getY()+g+60)){g=f._elemB.getY()+f._elemB.getHeight()-this.getY()-60}}}if(this._delete){this.setHeight(g)}else{this.setHeight(g+60)}};Lifeline.prototype.setDelete=function(a){this._delete=a};Lifeline.prototype.getDelete=function(){return this._delete};Lifeline.prototype.setCreate=function(a){this._create=a};Lifeline.prototype.getCreate=function(){return this._create};Lifeline.prototype.addRelation=function(a,b){var b=(JSFun.isNumber(b))?b:0;if(a instanceof DeleteMessage&&a._elemB==this){this.setDelete(a._y)}if(a instanceof CreateMessage&&a._elemB==this){this.setCreate(a._y)}a.updateLimitY();if(a._y<a._limitY){a._y=a._limitY}if(!b){Lifeline.base.addRelation.call(this,a)}};Lifeline.prototype.updatePosition=function(d,b){var c,a;if(d==undefined||b==undefined){var e=this.getMovement();var d=e.getX();var b=e.getY();this.resetMovement();for(c in this._relations){this._relations[c].updatePosition()}}else{this._x+=d;this._y+=b}this.resetMovement();for(c in this._components){this._components[c].updatePosition(d,b)}for(c in this._relations){if(this._relations[c].getParent()!=this._parent){this._relations[c].notifyChange()}}if(this._container){for(c in this._nodeChilds){this._nodeChilds[c].updatePosition(d,b)}for(c in this._relationChilds){this._relationChilds[c].updatePosition(d,b)}}};Lifeline.prototype.delRelation=function(a,c){var c=(JSFun.isNumber(c))?c:0;if(a instanceof DeleteMessage&&a._elemB==this){this.setDelete(0)}if(a instanceof DeleteMessage){this._limitY=-1}if(a.getType()=="UMLCreate"&&a._elemB==this){this.setCreate(0)}var b=this._diagram._nodes;for(var d=0;d<b.length;d++){if(b[d].getType()=="UMLLifeline"){b[d].updateLength()}}if(!c){Lifeline.base.delRelation.call(this,a)}};Lifeline.prototype.draw=function(b){Lifeline.base.draw.call(this,b);if(this._delete){var a=this.getX()+this.getWidth()/2;var c=this.getY()+this.getHeight();b.save();b.strokeStyle="#000000";b.translate(a,c);b.beginPath();b.moveTo(-8.5,8.5);b.lineTo(8.5,-8.5);b.moveTo(8.5,8.5);b.lineTo(-8.5,-8.5);b.stroke();b.restore()}};Lifeline.prototype.drawShape=function(a){a.save();a.lineWidth=2.5;a.strokeStyle=NodeStyle.shape_color;a.strokeRect(JSGraphic.toPixel(this._x),JSGraphic.toPixel(this._y),this._width,this._heightSmallRectangle);a.beginPath();a.moveTo(this.getLineX(),JSGraphic.toPixel(this._y)+this._heightSmallRectangle);a.lineTo(this.getLineX(),JSGraphic.toPixel(this._y)+this._height);a.closePath();a.stroke();a.restore()};Lifeline.prototype.drawFigures=function(b){var a;for(a=0;a<this._figures.length;a+=1){this._figures[a].draw(b,this._x,this._y,this._width,this._height,this._heightSmallRectangle)}};Lifeline.prototype.setName=function(a){this._components[1].setValue(a)};Lifeline.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Lifeline.prototype.getStereotypes=function(){return this._components[0]._childs};Lifeline.prototype.getName=function(){return this._components[1].getValue()};Lifeline.prototype.getStereotype=function(){return this._components[0]};var RegionAlternative=function(a){a=a||{};RegionAlternative.baseConstructor.call(this,a)};JSFun.extend(RegionAlternative,Region);RegionAlternative.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};RegionAlternative.prototype.setGuard=function(a){if(this._components[1]){this._components[1].setValue("["+a+"]")}};RegionAlternative.prototype.getStereotypes=function(){return this._components[0]._childs};RegionAlternative.prototype.getGuard=function(){var b=this._components[1].getValue();var a=(this._components[1])?b.substring(1,b.length-1):null;return a};RegionAlternative.prototype.getStereotype=function(){return this._components[0]};var RegionAlternativeItem=function(a){a=a||{};RegionAlternativeItem.baseConstructor.call(this,a)};JSFun.extend(RegionAlternativeItem,RegionItem);RegionAlternativeItem.prototype.createRegion=function(){var a=this.getParent()._components.length;if(this.getParent()._orientation){this.getParent().addRegion(new RegionAlternative({parent:this.getParent()}))}else{this.getParent().addRegion(new RegionAlternative({parent:this.getParent()}))}};var ReplyMessage=function(a){a=a||{};ReplyMessage.baseConstructor.call(this,a)};JSFun.extend(ReplyMessage,Message);ReplyMessage.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};ReplyMessage.prototype.setName=function(a){this._components[1].setValue(a)};ReplyMessage.prototype.getStereotypes=function(){return this._components[0]._childs};ReplyMessage.prototype.getName=function(){return this._components[1].getValue()};var SendMessage=function(a){a=a||{};SendMessage.baseConstructor.call(this,a)};JSFun.extend(SendMessage,Message);SendMessage.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};SendMessage.prototype.setName=function(a){this._components[1].setValue(a)};SendMessage.prototype.getStereotypes=function(){return this._components[0]._childs};SendMessage.prototype.getName=function(){return this._components[1].getValue()};var UMLSequenceDiagram=function(b){b=b||{};var a=new SequenceDiagram(b);a.setType("UMLSequenceDiagram");a.setName("Sequence diagram");setStereotypeObjects(b.stereotypes||[],a);a.setValidElements(["UMLNote","UMLLine","UMLCreate","UMLDestroy","UMLLifeline","UMLCallMessage","UMLSendMessage","UMLDeleteMessage","UMLReplyMessage","UMLOption","UMLAlternative","UMLLoop","UMLBreak","Region","TimeInterval"]);return a};var UMLLifeline=function(b){var b=b||{};var a=new Lifeline(b);a.setType("UMLLifeline");setStereotypeProperties(a);a.setHeight(250);a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new TextBox({id:"name",centered:true,margin:3}));a.addFigure(new LifelineFigure({color:"#c6dbdc"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLCreate=function(b){var a=new CreateMessage(b);a.setType("UMLCreate");a.setStereotype("\xABcreate\xBB");a.setLine(new DashedLine());a.setEnd(new OpenTip());return a};var UMLDestroy=function(b){var a=new DeleteMessage(b);a.setType("UMLDestroy");a.setStereotype("\xABdestroy\xBB");a.setLine(new DashedLine());a.setEnd(new OpenTip());return a};var UMLSendMessage=function(b){var a=new SendMessage(b);a.setType("UMLSendMessage");a.addComponentStereotype();a.setComponentName();if(b.setElementXml){}else{a.setObjA(new TimeInterval());a.setObjB(new TimeInterval())}a.setLine(new SolidLine());a.setEnd(new OpenTip());return a};var UMLCallMessage=function(b){var a=new CallMessage(b);a.setType("UMLCallMessage");a.addComponentStereotype();a.setComponentName();if(b.setElementXml){}else{a.setObjA(new TimeInterval());a.setObjB(new TimeInterval())}a.setLine(new SolidLine());a.setEnd(new CloseTip({color:"#000000"}));return a};var UMLReplyMessage=function(b){var a=new ReplyMessage(b);a.setType("UMLReplyMessage");a.addComponentStereotype();a.setComponentName();if(b.setElementXml){}else{a.setObjB(new TimeInterval())}a.setLine(new DashedLine());a.setEnd(new OpenTip());return a};var UMLDeleteMessage=function(b){var a=new DeleteMessage(b);a.setType("UMLDeleteMessage");a.addComponentStereotype();a.setComponentName();if(b.setElementXml){}else{a.setObjA(new TimeInterval())}a.setLine(new SolidLine());a.setEnd(new OpenTip());return a};var UMLOption=function(b){var b=b||{};var a=new Interaction(b);a.setType("UMLOption");setStereotypeProperties(a);a.setMoveable();a.setContainer();a.setWidth(200);a.setHeight(100);a.addComponent(new StereotypeTagList({id:"stereotypes"}));a.addComponent(new Tab({id:"name",text:"OPT",margin:4,selected:true}));a.addComponent(new GuardItem({id:"guard",text:"[]",margin:1}));a.addFigure(new RectangleFigure());a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLAlternative=function(b){var b=b||{};b=b||{};var a=new Alternative(b);a.setType("UMLAlternative");setStereotypeProperties(a);a.setMoveable();a.setWidth(200);a.setHeight(100);a.addComponent(new StereotypeTagList({id:"stereotypes"}));a.addComponent(new Tab({id:"name",text:"ALT",margin:4,selected:true}));a.addComponent(new RegionAlternativeItem({id:"addRegion",text:"...",margin:1,position:Component.BottomRight}));a.addFigure(new RectangleFigure());if(b.setElementXml){}else{a.addRegion(new RegionAlternative({parent:a,position:Component.BottomLeft}));a.addRegion(new RegionAlternative({parent:a,position:Component.BottomLeft}))}a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLLoop=function(b){var b=b||{};var a=new Interaction(b);a.setType("UMLLoop");setStereotypeProperties(a);a.setMoveable();a.setContainer();a.setWidth(200);a.setHeight(100);a.addComponent(new StereotypeTagList({id:"stereotypes"}));a.addComponent(new LoopItem({id:"name",text:"LOOP",margin:4}));a.addComponent(new GuardItem({id:"guard",text:"[]",margin:1}));a.addFigure(new RectangleFigure());a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLBreak=function(b){var b=b||{};var a=new Interaction(b);a.setType("UMLBreak");setStereotypeProperties(a);a.setMoveable();a.setContainer();a.setWidth(200);a.setHeight(100);a.addComponent(new StereotypeTagList({id:"stereotypes"}));a.addComponent(new Tab({id:"name",text:"BREAK",margin:4,selected:true}));a.addFigure(new RectangleFigure());a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var CompositeState=function(a){a=a||{};CompositeState.baseConstructor.call(this,a);this.setHeightSmallRectangle(a.heightSmallRectangle||15);this.setWidthSmallRectangle(a.widthSmallRectangle||75);this.setXmovement(a.Xmovement||15)};JSFun.extend(CompositeState,SuperNode);CompositeState.prototype.setHeightSmallRectangle=function(a){this._heightSmallRectangle=a};CompositeState.prototype.setWidthSmallRectangle=function(a){this._widthSmallRectangle=a};CompositeState.prototype.setXmovement=function(a){this._Xmovement=a};CompositeState.prototype.updateContainer=function(e){if(!(e==false||e==true)){e=true}if(this._container){var l;var f=this._x;var d=this._y+this._heightSmallRectangle;var c=this._x;var b=this._y+this._heightSmallRectangle;var h;var o,a,m,g;var n=this._nodeChilds.length;for(l=0;l<n;l++){h=this._nodeChilds[l];if(h._visible){if(this._orientation){m=h._x;elemLeftY=h._y;if(l==(n-1)){o=h._x+h._minWidth}else{o=h._x+h._width}elemRigthY=h._y+h._minHeight}else{m=h._x;elemLeftY=h._y;o=h._x+h._minWidth;if(l==(n-1)){elemRigthY=h._y+h._minHeight}else{elemRigthY=h._y+h._height}o=h._x+h._minWidth}if(o>c){c=o}if(elemRigthY>b){b=elemRigthY}if(m<f){f=m}if(elemLeftY<d){d=elemLeftY}}}if(f<this._x||d<(this._y+this._heightSmallRectangle)){this.setWidth(this._x-f+this._width);this.setHeight(this._y+this._heightSmallRectangle-d+this._height);this._x=f;this._y=d-this._heightSmallRectangle;this.setMinWidth(c-f);this.setMinHeight(b-this._y)}else{this.setMinWidth(c-this._x);this.setMinHeight(b-this._y)}this._prex=this._x;this._prey=this._y;this.updateComponents();if(this._parent&&e){this._parent.updateContainer()}}};CompositeState.prototype.notifyChange=function(c,a,b){c=c||false;a=a||false;b=b||false;var e=this._heightSmallRectangle;this.setHeightSmallRectangle(this._components[0].getHeight()+this._components[1].getHeight());var d=this._heightSmallRectangle-e;if(d){this._y=this._y-d;this.setHeight(this._height+d)}if(this._components[0].getWidth()>this._components[1].getWidth()){this.setWidthSmallRectangle(this._components[0].getWidth())}else{this.setWidthSmallRectangle(this._components[1].getWidth())}CompositeState.base.notifyChange.call(this,c,a,b)};CompositeState.prototype.getElementXML=function(d){var e=d.createElement(this.getType());var a=this._beforeHeight||this.getHeight();var c=this._beforeWidth||this.getWidth();e.setAttribute("id",this.getId());e.setAttribute("x",this.getX());e.setAttribute("y",this.getY()+this._components[0]._height-1);e.setAttribute("width",c);e.setAttribute("height",a-this._components[0]._height+1);e.setAttribute("backgroundColor",this.getBackgroundColor());e.setAttribute("orientation",this._orientation);e.setAttribute("includeComponentByRegion",this._includeComponentByRegion);var b;for(b in this._components){if(this._components[b].getId()){e.appendChild(this._components[b].getComponentXML(d))}}for(b in this._nodeChilds){e.appendChild(this._nodeChilds[b].getElementXML(d))}for(b in this._relationChilds){e.appendChild(this._relationChilds[b].getElementXML(d))}return e};CompositeState.prototype.setElementXML=function(d){this.setPosition(parseInt(d.getAttribute("x")),parseInt(d.getAttribute("y")));this.resetMovement();this.setWidth(parseInt(d.getAttribute("width")));this.setHeight(parseInt(d.getAttribute("height")));this.setBackgroundColor(d.getAttribute("backgroundColor"));this._orientation=parseInt(d.getAttribute("orientation"));this._includeComponentByRegion=d.getAttribute("includeComponentByRegion");this._includeComponentByRegion=(this._includeComponentByRegion=="true")?true:false;var b;var c=d.childNodes;for(b=0;b<c.length;b++){if(c[b].nodeName=="item"){if(c[b].getAttribute("behaviors")!=null&&(c[b].getAttribute("visible")=="true"||c[b].getAttribute("visible")=="false")){this.setValue(c[b].getAttribute("id"),c[b].getAttribute("value"),c[b].getAttribute("behaviors"),c[b].getAttribute("visible"))}else{this.setValue(c[b].getAttribute("id"),c[b].getAttribute("value"))}}else{if(c[b].nodeName=="superitem"){var a;for(a in this._components){if(this._components[a].getId()==c[b].getAttribute("id")){this._components[a].setComponentXML(c[b])}}}}}this.notifyChange()};CompositeState.prototype.getLinkCentered=function(n,l){if(this._selectedFigure){return CompositeState.base.getLinkCentered.call(this,n,l)}if(n instanceof Point){l=n.getY();n=n.getX()}var h=this.getCentralPoint();var d=h.getX();var c=h.getY();var a,o,g,f;a=this.getX();o=this.getY();g=h.getX();f=this.getY();var b;if(n<d){if(l<c){b=(this.getY()+this._heightSmallRectangle-c)/(this.getX()-d);if(((l-c)==0)||Math.abs((l-c)/(n-d))<Math.abs(b)){g=this.getX();f=this.getY()+this.getHeight()}else{b=(this.getY()+this._heightSmallRectangle-c)/(this.getX()+this._Xmovement-d);if(Math.abs((l-c)/(n-d))<Math.abs(b)){o=this.getY()+this._heightSmallRectangle;g=this.getX()+this.getWidth();f=this.getY()+this._heightSmallRectangle}else{b=(this.getY()-c)/(this.getX()+this._Xmovement-d);if(Math.abs((l-c)/(n-d))<Math.abs(b)){a=this.getX()+this._Xmovement;o=this.getY();g=this.getX()+this._Xmovement;f=this.getY()+this._heightSmallRectangle}else{var e=this.getX()+this._Xmovement+this._widthSmallRectangle;b=(this.getY()-c)/(e-d);if(Math.abs((l-c)/(n-d))<Math.abs(b)){a=this.getX();o=this.getY();g=this.getX()+this.getWidth();f=this.getY()}else{a=this.getX();o=this.getY()+this._heightSmallRectangle;g=this.getX()+this.getWidth();f=this.getY()+this._heightSmallRectangle}}}}}else{b=(this.getY()+this.getHeight()-c)/(this.getX()-d);if(((l-c)==0)||Math.abs((l-c)/(n-d))<Math.abs(b)){g=this.getX();f=this.getY()+this.getHeight()}else{o=this.getY()+this.getHeight();g=this.getX()+this.getWidth();f=this.getY()+this.getHeight()}}}else{if(l<c){var e=this.getX()+this._Xmovement+this._widthSmallRectangle;b=(this.getY()+this._heightSmallRectangle-c)/(this.getX()+this.getWidth()-d);if(((l-c)==0)||((l-c)/(n-d))<b){b=(this.getY()-c)/(this.getX()+this._Xmovement+this._widthSmallRectangle-d);if((e>(this.getX()+this.getWidth()/2))&&Math.abs((l-c)/(n-d))>Math.abs(b)){g=this.getX()+this.getWidth();f=this.getY()}else{b=(this.getY()+this._heightSmallRectangle-c)/(e-d);if((e<(this.getX()+this.getWidth()/2))||Math.abs((l-c)/(n-d))<Math.abs(b)){a=this.getX();o=this.getY()+this._heightSmallRectangle;g=this.getX()+this.getWidth();f=this.getY()+this._heightSmallRectangle}else{a=this.getX()+this._Xmovement+this._widthSmallRectangle;o=this.getY();g=this.getX()+this._Xmovement+this._widthSmallRectangle;f=this.getY()+this._heightSmallRectangle}}}else{a=this.getX()+this.getWidth();g=this.getX()+this.getWidth();f=this.getY()+this.getHeight()}}else{b=(this.getY()+this.getHeight()-c)/(this.getX()+this.getWidth()-d);if(((l-c)==0)||((l-c)/(n-d))<b){a=this.getX()+this.getWidth();g=this.getX()+this.getWidth();f=this.getY()+this.getHeight()}else{o=this.getY()+this.getHeight();g=this.getX()+this.getWidth();f=this.getY()+this.getHeight()}}}return JSGraphic.lineIntersection(a,o,g,f,n,l,h.getX(),h.getY())};CompositeState.prototype.setVisibility=function(a){this._visible=a;var c=true;if(this._selectedFigure&&a){c=false}for(var b=0;b<this._components.length;b++){if((c||(!c&&this._components[b]._id=="name"))&&(!(this._components[b] instanceof SpecificationItem)||this._components[b] instanceof SpecificationItem&&this._components[b].getValue()!="")){this._components[b].setVisibility(a)}}if(this._container&&c){for(b=0;b<this._nodeChilds.length;b++){this._nodeChilds[b].setVisibility(a)}}};CompositeState.prototype.isOver=function(a,b){if(this._selectedFigure){return CompositeState.base.isOver.call(this,a,b)}if(a instanceof Point){b=a.getY();a=a.getX()}if((a>=this._x+this._Xmovement&&a<=this._x+this._Xmovement+this._widthSmallRectangle&&b>=this._y&&b<=this._y+this._heightSmallRectangle)||(a>=this._x&&a<=(this._x+this._width)&&b>=(this._y+this._heightSmallRectangle)&&b<=(this._y+this._height))){return true}return false};CompositeState.prototype.setValue=function(e,c,a,d){var b;for(b in this._components){if(!(this._components[b] instanceof SuperComponent)&&this._components[b].getId()==e){this._components[b].setValue(c,a,d);this.updateComponents();return true}}return false};CompositeState.prototype.drawFigures=function(b){var a;for(a=0;a<this._figures.length;a+=1){if(a==this._selectedFigure){this._figures[a].draw(b,this._x,this._y,this._width,this._height,this._heightSmallRectangle,this._widthSmallRectangle,this._Xmovement)}}};CompositeState.prototype.setName=function(a){this._components[1].setValue(a)};CompositeState.prototype.setSpecification=function(a){this._components[2].setVisibility(true);a=a.replace(/\n/gi,";");this._components[2].setText(a)};CompositeState.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};CompositeState.prototype.getStereotypes=function(){return this._components[0]._childs};CompositeState.prototype.getName=function(){return this._components[1].getValue()};CompositeState.prototype.getSpecification=function(){return this._components[2].getValue()};CompositeState.prototype.getStereotype=function(){return this._components[0]};var EntryPoint=function(a){a=a||{};EntryPoint.baseConstructor.call(this,a)};JSFun.extend(EntryPoint,Elliptical);EntryPoint.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};EntryPoint.prototype.setName=function(a){this._components[1].setValue(a)};EntryPoint.prototype.getStereotypes=function(){return this._components[0]._childs};EntryPoint.prototype.getName=function(){return this._components[1].getValue()};EntryPoint.prototype.getStereotype=function(){return this._components[0]};var ExitPoint=function(a){a=a||{};ExitPoint.baseConstructor.call(this,a)};JSFun.extend(ExitPoint,Elliptical);ExitPoint.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};ExitPoint.prototype.setName=function(a){this._components[1].setValue(a)};ExitPoint.prototype.getStereotypes=function(){return this._components[0]._childs};ExitPoint.prototype.getName=function(){return this._components[1].getValue()};ExitPoint.prototype.getStereotype=function(){return this._components[0]};var Junction=function(a){a=a||{};Junction.baseConstructor.call(this,a)};JSFun.extend(Junction,Elliptical);Junction.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Junction.prototype.setName=function(a){this._components[1].setValue(a)};Junction.prototype.getStereotypes=function(){return this._components[0]._childs};Junction.prototype.getName=function(){return this._components[1].getValue()};Junction.prototype.getStereotype=function(){return this._components[0]};var RegionState=function(a){a=a||{};RegionState.baseConstructor.call(this,a)};JSFun.extend(RegionState,Region);RegionState.prototype.addStereotype=function(a){if(this._components[0]){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")}};RegionState.prototype.setName=function(a){if(this._components[1]){this._components[1].setValue(a)}};RegionState.prototype.getStereotypes=function(){return this._components[0]._childs};RegionState.prototype.getName=function(){return this._components[1].getValue()};RegionState.prototype.getStereotype=function(){return this._components[0]};var RegionStateItem=function(a){a=a||{};RegionStateItem.baseConstructor.call(this,a)};JSFun.extend(RegionStateItem,RegionItem);RegionStateItem.prototype.createRegion=function(){var a=this.getParent()._components.length;if(this.getParent()._orientation){this.getParent().addRegion(new RegionState({parent:this.getParent()}))}else{this.getParent().addRegion(new RegionState({parent:this.getParent()}))}};var SimpleState=function(a){a=a||{};SimpleState.baseConstructor.call(this,a)};JSFun.extend(SimpleState,Rectangular);SimpleState.prototype.setElementXML=function(d){this.setPosition(parseInt(d.getAttribute("x")),parseInt(d.getAttribute("y")));this.resetMovement();this.setWidth(parseInt(d.getAttribute("width")));this.setHeight(parseInt(d.getAttribute("height")));this.setBackgroundColor(d.getAttribute("backgroundColor"));var b;var c=d.childNodes;for(b=0;b<c.length;b++){if(c[b].nodeName=="item"){if(c[b].getAttribute("behaviors")!=null&&(c[b].getAttribute("visible")=="true"||c[b].getAttribute("visible")=="false")){this.setValue(c[b].getAttribute("id"),c[b].getAttribute("value"),c[b].getAttribute("behaviors"),c[b].getAttribute("visible"))}else{this.setValue(c[b].getAttribute("id"),c[b].getAttribute("value"))}}else{if(c[b].nodeName=="superitem"){var a;for(a in this._components){if(this._components[a].getId()==c[b].getAttribute("id")){this._components[a].setComponentXML(c[b])}}}}}};SimpleState.prototype.setValue=function(e,c,a,d){var b;for(b in this._components){if(!(this._components[b] instanceof SuperComponent)&&this._components[b].getId()==e){this._components[b].setValue(c,a,d);this.updateComponents();return true}}return false};SimpleState.prototype.setVisibility=function(a){this._visible=a;var c=true;if(this._selectedFigure&&a){c=false}for(var b=0;b<this._components.length;b++){if((c||(!c&&this._components[b]._id=="name"))&&(!(this._components[b] instanceof SpecificationItem)||this._components[b] instanceof SpecificationItem&&this._components[b].getValue()!="")){this._components[b].setVisibility(a)}}if(this._container&&c){for(b=0;b<this._nodeChilds.length;b++){this._nodeChilds[b].setVisibility(a)}}};SimpleState.prototype.draw=function(a){if(!this._visible){return}SimpleState.base.draw.call(this,a);if(this._components[2]._visible){a.save();a.fillStyle="#000000";a.beginPath();a.moveTo(JSGraphic.toPixel(this.getX()),JSGraphic.toPixel(this.getY())+this._components[0].getHeight()+this._components[1].getHeight());a.lineTo(JSGraphic.toPixel(this.getX()+this.getWidth()),JSGraphic.toPixel(this.getY())+this._components[0].getHeight()+this._components[1].getHeight());a.closePath();a.fill();a.stroke();a.restore()}};SimpleState.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};SimpleState.prototype.setName=function(a){this._components[1].setValue(a)};SimpleState.prototype.setSpecification=function(a){this._components[2].setVisibility(true);a=a.replace(/\n/gi,";");this._components[2].setText(a)};SimpleState.prototype.getStereotypes=function(){return this._components[0]._childs};SimpleState.prototype.getName=function(){return this._components[1].getValue()};SimpleState.prototype.getSpecification=function(){return this._components[2].getValue()};SimpleState.prototype.getStereotype=function(){return this._components[0]};var StateMachineDiagram=function(a){StateMachineDiagram.baseConstructor.call(this,a)};JSFun.extend(StateMachineDiagram,Diagram);StateMachineDiagram.prototype.setXML=function(b,f){var f=f||[];var e=[];if(this._alone){var a=b.getElementsByTagName(this.getType())[0];if(!a){return false}}else{var a=b}this._name.setValue(a.getAttribute("name"));if(a.getAttribute("backgroundNodes")){this._backgroundNodes=a.getAttribute("backgroundNodes")}this._stereotypes=f;var d=a.childNodes;var c;for(c=0;c<d.length;c++){this._instantiateElements(d[c],e)}for(c=0;c<d.length;c++){this._addElementXML(d[c],e,null)}for(c=0;c<this._relations.length;c++){this._relations[c].notifyChange()}this._sortNodesByArea();return true};var Terminate=function(a){a=a||{};Terminate.baseConstructor.call(this,a)};JSFun.extend(Terminate,Elliptical);Terminate.prototype.getLinkCentered=function(h,g){if(h instanceof Point){g=h.getY();h=h.getX()}var f=this.getCentralPoint();var c=f.getX();var b=f.getY();var a,l,e,d;if(h<c){if(g<b){a=this.getX();l=this.getY();e=this.getX()+this.getWidth();d=this.getY()+this.getHeight()}else{a=this.getX()+this.getWidth();l=this.getY();e=this.getX();d=this.getY()+this.getHeight()}}else{if(g<b){a=this.getX()+this.getWidth();l=this.getY();e=this.getX();d=this.getY()+this.getHeight()}else{a=this.getX();l=this.getY();e=this.getX()+this.getWidth();d=this.getY()+this.getHeight()}}return JSGraphic.lineIntersection(a,l,e,d,h,g,f.getX(),f.getY())};Terminate.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Terminate.prototype.setName=function(a){this._components[1].setValue(a)};Terminate.prototype.getStereotypes=function(){return this._components[0]._childs};Terminate.prototype.getName=function(){return this._components[1].getValue()};Terminate.prototype.getStereotype=function(){return this._components[0]};var Transition=function(a){a=a||{};Transition.baseConstructor.call(this,a)};JSFun.extend(Transition,Relation);Transition.prototype.setComponentName=function(a){if(!this._name){this._name=new TransitionItem({id:"name"});this._addComponent(this._name)}else{this._name.setText(a)}};Transition.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Transition.prototype.setName=function(a){this._components[1].setValue(a)};Transition.prototype.getStereotypes=function(){return this._components[0]._childs};Transition.prototype.getName=function(){return this._components[1].getValue()};var UMLStateMachineDiagram=function(b){b=b||{};var a=new StateMachineDiagram(b);a.setType("UMLStateMachineDiagram");a.setName("State Machine diagram");setStereotypeObjects(b.stereotypes||[],a);a.setValidElements(["UMLNote","UMLLine","UMLInitialPseudostate","UMLFinalState","UMLTerminate","UMLEntryPoint","UMLExitPoint","UMLJunction","UMLSimpleState","UMLCompositeState","UMLVerticalRegion","UMLHorizontalRegion","UMLTransition","Region"]);return a};var UMLInitialPseudostate=function(b){var a=new Elliptical(b);a.setType("UMLInitialPseudostate");a.setWidth(16);a.setHeight(16);a.addFigure(new EllipseFigure({color:"#000000",changeFigureColor:false}));return a};var UMLFinalState=function(b){var a=new Elliptical(b);a.setType("UMLFinalState");a.setWidth(16);a.setHeight(16);a.addFigure(new HalfFilledEllipseFigure({color:"#ffffff",changeFigureColor:false}));return a};var UMLTerminate=function(b){var b=b||{};var a=new Terminate(b);a.setType("UMLTerminate");setStereotypeProperties(a);a.setWidth(20);a.setHeight(20);a.addFigure(new CrossFigure({color:"#000000",changeFigureColor:false}));a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));a.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));a.setMenu([[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLEntryPoint=function(b){var b=b||{};var a=new EntryPoint(b);a.setType("UMLEntryPoint");setStereotypeProperties(a);a.setWidth(14);a.setHeight(14);a.addFigure(new EllipseFigure({color:"#ffffff",changeFigureColor:false}));a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));a.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));a.setMenu([[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLExitPoint=function(b){var b=b||{};var a=new ExitPoint(b);a.setType("UMLExitPoint");setStereotypeProperties(a);a.setWidth(14);a.setHeight(14);a.addFigure(new CrossEllipseFigure({color:"#ffffff",changeFigureColor:false}));a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));a.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));a.setMenu([[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLJunction=function(b){var b=b||{};var a=new Junction(b);a.setType("UMLJunction");setStereotypeProperties(a);a.setWidth(14);a.setHeight(14);a.addFigure(new EllipseFigure({color:"#000000",changeFigureColor:false}));a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));a.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));a.setMenu([[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLSimpleState=function(b){var b=b||{};var a=new SimpleState(b);a.setType("UMLSimpleState");setStereotypeProperties(a);a.setWidth(75);a.setHeight(30);a.setMoveable();a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new TextArea({id:"name",centered:true,position:Component.Static,margin:5}));a.addComponent(new SpecificationItem({id:"specification",centered:false,position:Component.BottomLeft,margin:10}));a.addFigure(new RoundedRectangleFigure({color:"#ffffbb"}));a.setMenu([[function(){for(var c=0;c<a._components.length;c++){if(a._components[c] instanceof SpecificationItem){a._components[c]._visible=true;a._components[c].showDialog();a.removeContextualMenu()}}},"Specifications"],[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLCompositeState=function(b){b=b||{};b.includeComponentByRegion=false;var a=new CompositeState(b);a.setType("UMLCompositeState");setStereotypeProperties(a);a.setWidth(150);a.setHeight(100);a.setMoveable();a.setContainer();a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Xmovement}));a.addComponent(new TextBox({id:"name",text:"StateName",margin:3,position:Component.Xmovement}));a.addComponent(new SpecificationItem({id:"specification",centered:false,position:Component.BottomLeft,margin:10}));a.addFigure(new RegionFigure({color:"#ffffbb"}));a.setHeightSmallRectangle(a._components[0].getHeight()+a._components[1].getHeight());a.setWidthSmallRectangle(a._components[1].getWidth());if(b.setElementXml){}else{a.addRegion(new Region({parent:a}))}a.setMenu([[function(){for(var c=0;c<a._components.length;c++){if(a._components[c] instanceof SpecificationItem){a._components[c]._visible=true;a._components[c].showDialog();a.removeContextualMenu()}}},"Specifications"],[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLVerticalRegion=function(b){b=b||{};b.orientation=1;var a=new CompositeState(b);a.setType("UMLVerticalRegion");setStereotypeProperties(a);a.setWidth(320);a.setHeight(150);a.setMinHeight(50);a.setMoveable();a.setContainer();a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Xmovement}));a.addComponent(new TextBox({id:"name",text:"RegionName",margin:3,position:Component.Xmovement}));a.addComponent(new SpecificationItem({id:"specification",centered:false,position:Component.BottomLeft,margin:10}));a.addComponent(new RegionStateItem({id:"addRegion",text:"...",margin:1,position:Component.BottomRight}));a.addFigure(new RegionFigure({color:"#ffffbb"}));a.setHeightSmallRectangle(a._components[0].getHeight()+a._components[1].getHeight());a.setWidthSmallRectangle(a._components[1].getWidth());if(b.setElementXml){}else{a.addRegion(new RegionState({parent:a}));a.addRegion(new RegionState({parent:a}))}a.setMenu([[function(){for(var c=0;c<a._components.length;c++){if(a._components[c] instanceof SpecificationItem){a._components[c]._visible=true;a._components[c].showDialog();a.removeContextualMenu()}}},"Specifications"],[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLHorizontalRegion=function(b){var b=b||{};var a=new CompositeState(b);a.setType("UMLHorizontalRegion");setStereotypeProperties(a);a.setWidth(320);a.setHeight(150);a.setMinHeight(50);a.setMoveable();a.setContainer();a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Xmovement}));a.addComponent(new TextBox({id:"name",text:"RegionName",margin:3,position:Component.Xmovement}));a.addComponent(new SpecificationItem({id:"specification",centered:false,position:Component.BottomLeft,margin:10}));a.addComponent(new RegionStateItem({id:"addRegion",text:"...",margin:1,position:Component.BottomRight}));a.addFigure(new RegionFigure({color:"#ffffbb"}));a.setHeightSmallRectangle(a._components[0].getHeight()+a._components[1].getHeight());a.setWidthSmallRectangle(a._components[1].getWidth());if(b.setElementXml){}else{a.addRegion(new RegionState({parent:a}));a.addRegion(new RegionState({parent:a}))}a.setMenu([[function(){for(var c=0;c<a._components.length;c++){if(a._components[c] instanceof SpecificationItem){a._components[c]._visible=true;a._components[c].showDialog();a.removeContextualMenu()}}},"Specifications"],[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLTransition=function(b){var a=new Transition(b);a.setType("UMLTransition");a.addComponentStereotype();a.setComponentName();a.setLine(new SolidLine());a.setEnd(new OpenTip());return a};var Actor=function(a){a=a||{};Actor.baseConstructor.call(this,a)};JSFun.extend(Actor,Rectangular);Actor.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Actor.prototype.setName=function(a){this._components[1].setValue(a)};Actor.prototype.getStereotypes=function(){return this._components[0]._childs};Actor.prototype.getName=function(){return this._components[1].getValue()};Actor.prototype.getStereotype=function(){return this._components[0]};var Communication=function(a){a=a||{};Communication.baseConstructor.call(this,a)};JSFun.extend(Communication,Relation);Communication.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Communication.prototype.setMultiplicityA=function(a){this._components[1].setValue(a)};Communication.prototype.setMultiplicityB=function(a){this._components[2].setValue(a)};Communication.prototype.getStereotypes=function(){return this._components[0]._childs};Communication.prototype.getMultiplicityA=function(){return this._components[1].getValue()};Communication.prototype.getMultiplicityB=function(){return this._components[2].getValue()};var Generalization=function(a){a=a||{};Generalization.baseConstructor.call(this,a)};JSFun.extend(Generalization,Relation);Generalization.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};Generalization.prototype.setName=function(a){this._components[1].setValue(a)};Generalization.prototype.getStereotypes=function(){return this._components[0]._childs};Generalization.prototype.getName=function(){return this._components[1].getValue()};var SubSystem=function(a){a=a||{};SubSystem.baseConstructor.call(this,a)};JSFun.extend(SubSystem,Rectangular);SubSystem.prototype.addStereotype=function(a){var a=a||"";this._components[1].addField("\xAB"+a+"\xBB")};SubSystem.prototype.setName=function(a){this._components[3].setValue(a)};SubSystem.prototype.getStereotypes=function(){return this._components[1]._childs};SubSystem.prototype.getName=function(){return this._components[3].getValue()};SubSystem.prototype.getStereotype=function(){return this._components[1]};var System=function(a){a=a||{};System.baseConstructor.call(this,a)};JSFun.extend(System,Rectangular);System.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};System.prototype.setName=function(a){this._components[1].setValue(a)};System.prototype.getStereotypes=function(){return this._components[0]._childs};System.prototype.getName=function(){return this._components[1].getValue()};System.prototype.getStereotype=function(){return this._components[0]};var UseCase=function(a){a=a||{};UseCase.baseConstructor.call(this,a)};JSFun.extend(UseCase,Elliptical);UseCase.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};UseCase.prototype.setName=function(a){this._components[1].setValue(a)};UseCase.prototype.getStereotypes=function(){return this._components[0]._childs};UseCase.prototype.getName=function(){return this._components[1].getValue()};UseCase.prototype.getStereotype=function(){return this._components[0]};var UseCaseDiagram=function(a){UseCaseDiagram.baseConstructor.call(this,a)};JSFun.extend(UseCaseDiagram,Diagram);UseCaseDiagram.prototype.setXML=function(b,f){var f=f||[];var e=[];if(this._alone){var a=b.getElementsByTagName(this.getType())[0];if(!a){return false}}else{var a=b}this._name.setValue(a.getAttribute("name"));if(a.getAttribute("backgroundNodes")){this._backgroundNodes=a.getAttribute("backgroundNodes")}this._stereotypes=f;var d=a.childNodes;var c;for(c=0;c<d.length;c++){this._instantiateElements(d[c],e)}for(c=0;c<d.length;c++){this._addElementXML(d[c],e,null)}for(c=0;c<this._relations.length;c++){this._relations[c].notifyChange()}this._sortNodesByArea();return true};var UseCaseExtended=function(a){a=a||{};UseCaseExtended.baseConstructor.call(this,a)};JSFun.extend(UseCaseExtended,Elliptical);UseCaseExtended.prototype.addStereotype=function(a){var a=a||"";this._components[0].addField("\xAB"+a+"\xBB")};UseCaseExtended.prototype.setName=function(a){this._components[1].setValue(a)};UseCaseExtended.prototype.addExtensionPoint=function(a){this._components[4].addField(a)};UseCaseExtended.prototype.getStereotypes=function(){return this._components[0]._childs};UseCaseExtended.prototype.getName=function(){return this._components[1].getValue()};UseCaseExtended.prototype.getExtensionPoints=function(){return this._components[4]._childs};UseCaseExtended.prototype.getStereotype=function(){return this._components[0]};var UMLUseCaseDiagram=function(b){b=b||{};var a=new UseCaseDiagram(b);a.setType("UMLUseCaseDiagram");a.setName("Use case diagram");setStereotypeObjects(b.stereotypes||[],a);a.setValidElements(["UMLNote","UMLLine","UMLActor","UMLUseCase","UMLUseCaseExtended","UMLSystem","UMLSubSystem","UMLCommunication","UMLExtend","UMLInclude","UMLGeneralization"]);return a};var UMLActor=function(b){var b=b||{};var a=new Actor(b);a.setType("UMLActor");setStereotypeProperties(a);a.setMinWidth(50);a.setMinHeight(70);a.setProportional();a.setMoveable();a.addFigure(new StickmanFigure());a.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));a.addComponent(new TextArea({id:"name",position:Component.Bottom}));a.setMenu([[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLUseCase=function(b){var b=b||{};var a=new UseCase(b);a.setType("UMLUseCase");setStereotypeProperties(a);a.setWidth(100);a.setHeight(40);a.setMoveable();a.addFigure(new EllipseFigure());a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new TextArea({id:"name",centered:true,margin:3}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLUseCaseExtended=function(b){var b=b||{};var a=new UseCaseExtended(b);a.setType("UMLUseCaseExtended");setStereotypeProperties(a);a.setWidth(100);a.setHeight(40);a.setMoveable();a.addFigure(new EllipseFigure());a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new TextArea({id:"name",centered:true}));a.addComponent(new Separator());a.addComponent(new Text({text:"extension points",centered:true}));a.addComponent(new TextFields({id:"extension",centered:true}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLSystem=function(b){var b=b||{};var a=new System(b);a.setType("UMLSystem");setStereotypeProperties(a);a.setWidth(150);a.setHeight(100);a.setMoveable();a.setContainer();a.addFigure(new RectangleFigure({color:"#c6dbdc"}));a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new Tab({id:"name",margin:5,text:"System name"}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLSubSystem=function(b){var b=b||{};var a=new SubSystem(b);a.setType("UMLSubSystem");setStereotypeProperties(a);a.setMinWidth(150);a.setHeight(100);a.setMoveable();a.setContainer();a.addFigure(new RectangleFigure({color:"#c6dbdc"}));a.addComponent(new Text({centered:true,text:"\xABsubsystem\xBB",margin:1}));a.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));a.addComponent(new ComponentSymbol({position:Component.TopRight,margin:5}));a.addComponent(new TextBox({id:"name",centered:true,margin:2}));a.setMenu([[function(){a.showColorDialog({that:a});a.removeContextualMenu()},"Style"],[function(){a._stereotypeProperties.showTagValuesDialog();a.removeContextualMenu()},"Tag value"],[function(){a._stereotypeProperties.showApplyStereotypesDialog();a.removeContextualMenu()},"Apply Stereotype"],[function(){a._stereotypeProperties.showStereotypesDialog();a.removeContextualMenu()},"Show Stereotype"]]);return a};var UMLCommunication=function(b){var a=new Communication(b);a.setType("UMLCommunication");a.addComponentStereotype();a.setComponentMultiplicityA();a.setComponentMultiplicityB();a.setLine(new SolidLine());return a};var UMLExtend=function(b){var a=new Relation(b);a.setType("UMLExtend");a.setStereotype("\xABextend\xBB");a.setLine(new DashedLine());a.setEnd(new OpenTip());return a};var UMLInclude=function(b){var a=new Relation(b);a.setType("UMLInclude");a.setStereotype("\xABinclude\xBB");a.setLine(new DashedLine());a.setEnd(new OpenTip());return a};var UMLGeneralization=function(b){var a=new Generalization(b);a.setType("UMLGeneralization");a.addComponentStereotype();a.setComponentName();a.setLine(new SolidLine());a.setEnd(new CloseTip());return a};